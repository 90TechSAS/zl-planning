{"version":3,"sources":["index.js","filters/dayFilter.js","filters/momentFilter.js","filters/range.js","filters/strFilter.js","services/absences.service.js","services/color.service.js","services/configurationProvider.js","services/pause.service.js","services/position.service.js","directives/drag-drop/drag-drop.directive.js","directives/horizontal-scroll/horizontal-scroll.js","directives/planning/planning.js","directives/planning-day-block/planning-day.js","directives/planning-left-column/planning-left-column.js","directives/planning-line/planning-line.js","directives/planning-top-row/planning-top-row.js","directives/planning-vertical-line/planning-vertical-line.js","directives/planning-week-line/planning-week-line.js","template.js"],"names":["angular","module","window","filter","day","undefined","isNaN","parseInt","time","format","str","charAt","toUpperCase","slice","RangeFilter","operation","input","total","i","push","planningConfiguration","val","strings","_","moment","AbsenceService","parseAbsences","absences","interval","Array","isArray","Error","parsed","abs","range","start","end","overlaps","map","absence","isBefore","copy","isAfter","mergeRanges","_x","_again","ranges","r","index","Object","assign","any","range1","range2","reduced","reduce","acc","value","arr","next","toDate","min","max","self","this","extend","service","ColorService","getLuminance","c","g","b","rgbRegex","test","exec","color","substring","rgb","luma","$inject","provider","BASE_SIZE","MAX_PARALLEL","nothing_to_show","DAYS","parallelText","setParallelText","text","setBaseSize","size","setMaxParallel","number","setString","key","setDays","$get","absentTechnicianCallback","callback","PauseService","generateGradient","event","direction","parsePause","pauses","pause","pauseRange","pauseDuration","diff","percentage","totalDuration","before","totalRange","subtract","length","endPercentage","startPercentage","v","style","pauseColor","invertColor","mapped","hex","indexOf","toString","padZero","len","zeros","join","PositionService","overlap","lines","maxParallelEvents","toRemove","doublecheck","pre","depth","each","elt","eltRange","line","eventList","technician","eventClone","cloneDeep","directive","controller","scope","controllerAs","bindToController","zlDrag","zlDrop","link","element","dragImage","document","createElement","el","addEventListener","e","preventDefault","attributes","draggable","height","clientHeight","zIndex","position","left","bottom","innerHTML","children","float","backgroundColor","width","clientWidth","Math","dataTransfer","effectAllowed","body","appendChild","setDragImage","querySelectorAll","remove","setData","JSON","stringify","dragDropCtrl","classList","add","stopPropagation","target","$apply","$data","parse","getData","$event","ScrollHorizontalDirective","$timeout","restrict","scrollLeft","bind","wheelDelta","addClass","offsetWidth","PlanningController","$scope","init","zoom","allowedDays","usableDays","sort","daysList","d","weekday","_dayStart","parseTime","dayStart","_dayEnd","dayEnd","h","sortedEvents","mode","_events","flatten","events","split","groupBy","addMissingDays","dayField","mapValues","eventsByTechnician","addMissingEntities","entities","keys","groupedEvents","startOf","unix","k","result","date","hour","minute","m","second","stop","days","j","isEmpty","includes","found","find","group","obj","sortBy","firstDay","hours","minutes","seconds","month","decallage","isoWeekday","oneDayEvents","dayOfYear","floor","multipleDaysEvents","splitByWeeks","endWeek","endOf","isoWeek","startWeek","isoWeeksInYear","weekInMonth","unshift","times","daysInMonth","n","displayedDaysCount","first_event","startNextDay","endThisDay","continuedAfter","second_event","continuedBefore","concat","st","year","firstEvent","secondEvent","some","isBetween","startingDay","newDate","a","dateA","dateFromString","dateB","getEvents","isToday","week","isInDayRange","currentTimeToPixels","totalMinutes","isCurrent","isSame","clickCallbackWrapper","opts","mom","entity","Date","clickCallback","$moment","$entity","clickWeekEvent","dropEvent","config","doy","dropCallback","dateSplitted","$onInit","$watchCollection","PlanningDirective","templateUrl","entitiesPauses","eventCallback","dayCallback","weekEventCallback","action","PlanningDayController","data","absents","isDefined","array","hasOverlap","within","absentsString","PlanningDayDirective","replace","dayCtrl","PlanningLeftColumnController","forEach","column","PlanningLineController","extractMinutesFromEvent","contains","offsetX","getAttribute","checkAbsence","$hour","$minutes","clickEvent","currentId","preEvent","breaks","SECONDS_BY_DAY","SLIDER_WIDTH","valueOf","toremove","difference","id","title","tooltip","top","round","s","totalWidth","text-align","background","border-top","border-bottom","border-left","createBreaks","calcWidth","compact","p","name","_absences","newValue","oldValue","log","string","PlanningLineDirective","topRowDirective","PlanningTopRowController","calcMargin","half","$watchGroup","$filter","offsetY","AVAILABLE_SPACE","calculateContainerHeight","containerHeight","displayedEvents","positioning","setStyle","calculateLeft","calculateWidth","ceil","run","$templateCache","put"],"mappings":"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","file":"planning.js","sourcesContent":["'use strict';\n\n;(function (angular) {\n  'use strict';\n\n  angular.module('90Tech.planning', ['pikaday', 'zlContextMenu']);\n})(window.angular);","'use strict';\n\n;(function (angular) {\n  'use strict';\n  angular.module('90Tech.planning').filter('day', [function () {\n    return function (day) {\n      if (day === undefined || day === null || isNaN(day) || parseInt(day) > 6) return '';\n      return ['Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi', 'Dimanche'][day];\n    };\n  }]);\n})(window.angular);","'use strict';\n\n;(function (angular) {\n  'use strict';\n\n  angular.module('90Tech.planning').filter('format', function () {\n    return function (time, format) {\n      return time.format(format);\n    };\n  }).filter('capitalize', function () {\n    return function (str) {\n      if (!str) return '';\n      return str.charAt(0).toUpperCase() + str.slice(1);\n    };\n  });\n})(window.angular);","/**\n * WebApp Agenda\n * http://docs.pluginit.fr/agenda\n *\n * Copyright 2014 PluginIT\n * Non permissive commercial License.\n */\n\n'use strict';\n\n;(function (angular) {\n  'use strict';\n\n  angular.module('90Tech.planning').filter('range', RangeFilter);\n\n  /**\n   * Class Range for emulate a \"for\" loop\n   * @class RangeFilter\n   * @constructor\n   */\n  function RangeFilter() {\n    /**\n     * Return decimal values arrays at wished size\n     * @param input\n     * @param total\n     * @returns {*}\n     */\n    var operation = function operation(input, total) {\n      // We parse just in case\n      total = parseInt(total);\n\n      // We're adding at empty array the current value for the loop\n      for (var i = 0; i < total; i++) {\n        input.push(i);\n      }\n\n      // We return the array finally\n      return input;\n    };\n\n    /**\n     * Return callback to execute RangeFilter\n     */\n    return operation;\n  }\n})(window.angular);","'use strict';\n\n;(function (angular) {\n  'use strict';\n  angular.module('90Tech.planning').filter('strPlanning', ['planningConfiguration', function (planningConfiguration) {\n    return function (val) {\n      return planningConfiguration.strings[val];\n    };\n  }]);\n})(window.angular);","'use strict';\n\n;(function (angular, _, moment) {\n  'use strict';\n  angular.module('90Tech.planning').service('AbsenceService', AbsenceService);\n\n  function AbsenceService() {\n    var self = this;\n    _.extend(self, {\n      // Public Attributes\n      // Public Methods\n      parseAbsences: parseAbsences\n    });\n\n    function parseAbsences(absences, interval) {\n      if (!Array.isArray(interval)) {\n        throw new Error('Invalid interval');\n      }\n      var parsed = absences.filter(function (abs) {\n        return moment.range(abs.start, abs.end).overlaps(moment.range(interval[0], interval[1]));\n      }).map(function (absence) {\n        if (moment(absence.start).isBefore(moment(angular.copy(interval[0])))) {\n          absence.start = interval[0];\n        }\n        if (moment(absence.end).isAfter(moment(angular.copy(interval[1])))) {\n          absence.end = interval[1];\n        }\n        return absence;\n      });\n\n      return mergeRanges(parsed);\n    }\n\n    function mergeRanges(_x) {\n      var _again = true;\n\n      _function: while (_again) {\n        var ranges = _x;\n        _again = false;\n\n        var copy = ranges.map(function (r, index) {\n          r.index = index;\n          return Object.assign({}, r, { index: index });\n        });\n        // Check if any ranges overlaps\n        // If none overlap, return array\n        if (!_.any(copy, function (range1) {\n          return _.any(copy, function (range2) {\n            if (range1.index === range2.index) {\n              return false;\n            }\n            return overlaps(range1, range2);\n          });\n        })) {\n          return ranges;\n        }\n        var reduced = ranges.reduce(function (acc, value, index, arr) {\n          var next = arr[index + 1];\n          if (!next || !value) {\n            return acc;\n          }\n          if (overlaps({\n            start: moment(angular.copy(value.start)).toDate(),\n            end: moment(angular.copy(value.end)).toDate()\n          }, {\n            start: moment(angular.copy(next.start)).toDate(),\n            end: moment(angular.copy(next.end)).toDate()\n          })) {\n            acc.push({\n              start: moment.min(moment(angular.copy(value.start)), moment(angular.copy(next.start))),\n              end: moment.max(moment(angular.copy(value.end)), moment(angular.copy(next.end)))\n            });\n          }\n          return acc;\n        }, []);\n\n        _x = reduced;\n        _again = true;\n        copy = reduced = undefined;\n        continue _function;\n      }\n    }\n\n    function overlaps(range1, range2) {\n      return moment.range(range1.start, range1.end).overlaps(moment.range(range2.start, range2.end));\n    }\n  }\n})(window.angular, window._, window.moment);","'use strict';\n\n;(function (angular, _, moment) {\n  'use strict';\n\n  angular.module('90Tech.planning').service('ColorService', ColorService);\n\n  ColorService.$inject = [];\n\n  function ColorService() {\n    var self = this;\n\n    _.extend(self, {\n      getLuminance: getLuminance\n    });\n\n    /**\n     * return the luminance of a color : > 200 is black\n     * @param c Color\n     * @returns {number}\n     */\n    function getLuminance(c) {\n      c = c || '#ffffff';\n      var r, g, b;\n      var rgbRegex = /rgb\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3})\\)/;\n      if (rgbRegex.test(c)) {\n        var exec = rgbRegex.exec(c);\n        r = parseInt(exec[1]);\n        g = parseInt(exec[2]);\n        b = parseInt(exec[3]);\n      } else {\n        var color = c.substring(1); // strip #\n        var rgb = parseInt(color, 16); // convert rrggbb to decimal\n        r = rgb >> 16 & 0xff; // extract red\n        g = rgb >> 8 & 0xff; // extract green\n        b = rgb >> 0 & 0xff; // extract blue\n      }\n\n      var luma = 0.2126 * r + 0.7152 * g + 0.0722 * b; // per ITU-R BT.709\n      // luma > 200 : black\n      return luma;\n    }\n  }\n})(window.angular, window._, window.moment);","'use strict';\n\n;(function (angular) {\n  'use strict';\n  angular.module('90Tech.planning').provider('planningConfiguration', function () {\n    var self = this;\n\n    self.BASE_SIZE = 10;\n    self.MAX_PARALLEL = 3;\n    self.strings = {\n      nothing_to_show: 'Rien  afficher'\n    };\n\n    self.DAYS = [0, 1, 2, 3, 4, 5, 6];\n\n    self.parallelText = 'parallel items';\n\n    this.setParallelText = function (text) {\n      self.parallelText = '' + text;\n    };\n\n    this.setBaseSize = function (size) {\n      self.BASE_SIZE = size;\n    };\n    this.setMaxParallel = function (number) {\n      self.MAX_PARALLEL = number;\n    };\n\n    this.setString = function (key, value) {\n      self.strings[key] = value;\n    };\n\n    this.setDays = function (value) {\n      self.DAYS = value;\n    };\n\n    this.$get = [function () {\n      return {\n        strings: self.strings,\n        BASE_SIZE: self.BASE_SIZE,\n        MAX_PARALLEL: self.MAX_PARALLEL,\n        parallelText: self.parallelText,\n        DAYS: self.DAYS,\n        absentTechnicianCallback: function absentTechnicianCallback(callback) {\n          callback();\n        }\n      };\n    }];\n  });\n})(window.angular);","'use strict';\n\n;(function (angular, _, moment) {\n  'use strict';\n  angular.module('90Tech.planning').service('PauseService', PauseService);\n\n  PauseService.$inject = ['ColorService'];\n\n  function PauseService(ColorService) {\n    var self = this;\n\n    _.extend(self, {\n      // Public Attributes\n      // Public Methods\n      generateGradient: generateGradient\n    });\n\n    function generateGradient(event, direction) {\n      var color = event.style['background-color'];\n      var pauseColor = invertColor(color);\n      var start = event.start;\n      var end = event.end;\n      var totalRange = moment.range(start, end);\n      var totalDuration = totalRange.diff('milliseconds');\n\n      function parsePause(pauses) {\n        return _.map(pauses, function (pause) {\n          var start = event.start.isAfter(pause.start) ? event.start : pause.start;\n          var end = event.end.isBefore(pause.end) ? event.end : pause.end;\n          var pauseRange = moment.range(start, end);\n          var pauseDuration = pauseRange.diff('milliseconds');\n          var percentage = pauseDuration / totalDuration * 100;\n          var before = totalRange.subtract(pauseRange);\n          if (!before.length) {\n            return { range: pauseRange, endPercentage: 100, startPercentage: 0 };\n          }\n          var v = (before[0].diff('milliseconds') || totalDuration) / totalDuration * 100;\n          return { range: pauseRange, endPercentage: percentage + v, startPercentage: v };\n        });\n      }\n\n      var mapped = parsePause(event.pauses);\n\n      var reduced = _.reduce(mapped, function (acc, range) {\n        return acc + ', ' + color + ' ' + range.startPercentage + '%, ' + pauseColor + ' ' + range.startPercentage + '%, ' + pauseColor + ' ' + range.endPercentage + '%, ' + color + ' ' + range.endPercentage + '%';\n      }, 'linear-gradient(' + direction + ', ' + color);\n\n      reduced += ', ' + color + ' 100%)';\n      return reduced;\n    }\n\n    function invertColor(hex) {\n      if (hex.indexOf('#') === 0) {\n        hex = hex.slice(1);\n      }\n      // convert 3-digit hex to 6-digits.\n      if (hex.length === 3) {\n        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n      }\n      if (hex.length !== 6) {\n        throw new Error('Invalid HEX color.');\n      }\n      // invert color components\n      var r = (255 - parseInt(hex.slice(0, 2), 16)).toString(16),\n          g = (255 - parseInt(hex.slice(2, 4), 16)).toString(16),\n          b = (255 - parseInt(hex.slice(4, 6), 16)).toString(16);\n      // pad each with zeros and return\n      return '#' + padZero(r) + padZero(g) + padZero(b);\n    }\n\n    function padZero(str, len) {\n      len = len || 2;\n      var zeros = new Array(len).join('0');\n      return (zeros + str).slice(-len);\n    }\n  }\n})(window.angular, window._, window.moment);","'use strict';\n\n;(function (angular, _, moment) {\n  'use strict';\n\n  angular.module('90Tech.planning').service('PositionService', PositionService);\n\n  PositionService.$inject = [];\n\n  function PositionService() {\n    var self = this;\n\n    _.extend(self, {\n      // Public Methods\n      overlap: overlap\n    });\n\n    /**\n     * Check if event overlap any events in line, merge if parallel items is over maxParallelEvents, and push event in toRemove\n     * @param lines Arrays, containing events example : [[event, event][event,event][event]]\n     * @param event Event\n     * @param maxParallelEvents Int, maximum parallelEvents\n     * @param toRemove Array containing event which have been integrated/merged with another event\n     * @param doublecheck Boolean If true, check if day isn't same between two events (useful for monthly view where hours doesn't overlap on same day)\n     */\n    function overlap(lines, event, maxParallelEvents, toRemove, doublecheck) {\n      var range = event.pre > 0 ? moment.range(moment(event.start).subtract(event.pre, 'minutes'), moment(event.end)) : event.range;\n      for (var i = 0; i < lines.length; i++) {\n        if (event.depth > maxParallelEvents) {\n          var overlap = false;\n          _.each(lines[maxParallelEvents], function (elt) {\n\n            var eltRange = elt.pre > 0 ? moment.range(moment(elt.start).subtract(elt.pre, 'minutes'), moment(elt.end)) : elt.range;\n\n            overlap = range.overlaps(eltRange);\n            if (!overlap && doublecheck) {\n              overlap = event.start.day() === elt.start.day() || event.start.day() === elt.end.day() || event.end.day() === elt.start.day() || event.end.day() === elt.end.day();\n            }\n            if (overlap) {\n              elt.start = moment.min(event.start, elt.start); // set start to minimum of 2 overlapping event\n              elt.end = moment.max(event.end, elt.end); // set end to maximum of 2 overlapping event\n              elt.range = moment.range(elt.start, elt.end); // Update range\n              elt.line = maxParallelEvents;\n              elt.eventList.push(event);\n              if (elt.technician !== event.technician) {\n                // Technician isn't the same, hide it\n                elt.technician = '';\n                event.technician = '';\n              }\n            }\n          });\n          if (overlap) {\n            toRemove.push(event);\n            break;\n          }\n          event.depth = maxParallelEvents;\n          event.line = maxParallelEvents;\n          if (!event.eventList) {\n            var eventClone = _.cloneDeep(event);\n            event.eventList = [eventClone];\n          }\n          lines[maxParallelEvents].push(event);\n          break;\n        }\n        if (!lines[i].length) {\n          lines[i].push(event);\n          event.line = i;\n          break;\n        }\n        if (_.filter(lines[i], function (elt) {\n          // if any event in lines[i] overlap\n          var eltRange = elt.pre > 0 ? moment.range(moment(elt.start).subtract(elt.pre, 'minutes'), moment(elt.end)) : elt.range;\n          overlap = range.overlaps(eltRange);\n          if (!overlap && doublecheck) {\n            overlap = event.start.day() === elt.start.day() || event.start.day() === elt.end.day() || event.end.day() === elt.start.day() || event.end.day() === elt.end.day();\n          }\n          if (overlap) {\n            elt.depth += 1;\n            return true;\n          }\n        }).length) {\n          event.depth += 1;\n          if (!lines[i + 1]) {\n            // if next line is doesn't exist, add one\n            lines[i + 1] = [];\n          }\n        } else {\n          lines[i].push(event);\n          event.line = i;\n          break;\n        }\n      }\n    }\n  }\n})(window.angular, window._, window.moment);","'use strict';\n\n;(function (angular) {\n  'use strict';\n\n  angular.module('90Tech.planning').directive('zlPlanningDragDrop', function () {\n    return {\n      controller: function controller() {},\n      scope: {},\n      controllerAs: 'dragDropCtrl',\n      bindToController: {\n        zlDrag: '=',\n        zlDrop: '&'\n      },\n      link: function link(scope, element) {\n        var dragImage = document.createElement('div');\n        var el = element[0];\n        window.addEventListener('dragover', function (e) {\n          e.preventDefault();\n        }, false);\n        window.addEventListener('drop', function (e) {\n          e.preventDefault();\n        }, false);\n\n        if (el.attributes['zl-drag']) {\n          el.draggable = true;\n\n          el.addEventListener('dragstart', function (e) {\n            dragImage.style.height = el.clientHeight + 'px';\n            dragImage.style.zIndex = '1000';\n            dragImage.style.position = 'relative';\n            dragImage.style.left = '-10000px';\n            dragImage.style.bottom = '-10000px;';\n            dragImage.innerHTML = el.innerHTML;\n            if (el.children.length > 1) {\n              dragImage.children[0].style.float = 'left';\n              dragImage.style.backgroundColor = el.children[1].style.backgroundColor;\n              dragImage.style.width = el.clientWidth + 'px';\n            } else {\n              dragImage.style.width = Math.min(el.clientWidth, 200) + 'px';\n              dragImage.style.backgroundColor = el.children[0].style.backgroundColor;\n            }\n            e.dataTransfer.effectAllowed = 'move';\n\n            document.body.appendChild(dragImage);\n\n            if (e.dataTransfer.setDragImage) {\n              e.dataTransfer.setDragImage(dragImage, 0, 0);\n            }\n            // Remove tooltips on drag\n            _.each(document.querySelectorAll('.planning-event-tooltip'), function (elt) {\n              elt.remove();\n            });\n            e.dataTransfer.setData('Text', JSON.stringify(scope.dragDropCtrl.zlDrag));\n            this.classList.add('drag');\n            return false;\n          }, false);\n\n          el.addEventListener('dragend', function (e) {\n            dragImage.remove();\n            this.classList.remove('drag');\n            return false;\n          }, false);\n        }\n        if (el.attributes['zl-drop']) {\n          el.addEventListener('drop', function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            if (e.stopPropagation) e.stopPropagation();\n            e.target.classList.remove('over');\n            this.classList.remove('over');\n            scope.$apply(function () {\n              scope.dragDropCtrl.zlDrop({ $data: JSON.parse(e.dataTransfer.getData('Text')), $event: e });\n            });\n            return false;\n          }, false);\n\n          el.addEventListener('dragenter', function (e) {\n            e.target.classList.add('over');\n            return false;\n          }, false);\n\n          el.addEventListener('dragleave', function (e) {\n            e.target.classList.remove('over');\n            return false;\n          }, false);\n        }\n      }\n    };\n  });\n})(window.angular);","/**\n * @author Toolito <toolito@90tech.fr>\n * @copyright 2015 Zenlabs SAS. All rights reserved.\n *\n * TODO Export in separate module ?\n */\n'use strict';\n\n;(function (angular) {\n  'use strict';\n\n  angular.module('90Tech.planning').directive('zlHorizontalScroll', ScrollHorizontalDirective);\n\n  ScrollHorizontalDirective.$inject = ['$timeout'];\n\n  function ScrollHorizontalDirective($timeout) {\n    return {\n      restrict: 'A',\n      scope: {\n        scrollLeft: '='\n      },\n      link: function link(scope, element, attributes) {\n        // eslint-disable-line\n        element.bind('mousewheel', function (e) {\n          element[0].scrollLeft -= e.wheelDelta / 3;\n        });\n        element.addClass('slider');\n\n        if (scope.scrollLeft) {}\n\n        $timeout(function () {\n          // Needs a delay since the offsetWidth we obtain first is off by ~300px\n          element[0].scrollLeft = scope.scrollLeft - element[0].offsetWidth / 2;\n        }, 100);\n      }\n    };\n  }\n})(window.angular);","'use strict';\n\n;(function (angular, moment, _) {\n  'use strict';\n\n  angular.module('90Tech.planning').directive('zlPlanning', PlanningDirective);\n\n  PlanningController.$inject = ['$scope', 'planningConfiguration'];\n\n  function PlanningController($scope, planningConfiguration) {\n    var BASE_SIZE = planningConfiguration.BASE_SIZE;\n\n    var self = this;\n\n    self.$onInit = function () {\n      _.extend(self, {\n        //  sortedEvents       : sortedEvents,\n        isToday: isToday,\n        currentTimeToPixels: currentTimeToPixels,\n        isCurrent: isCurrent,\n        clickCallbackWrapper: clickCallbackWrapper,\n        isInDayRange: isInDayRange,\n        keys: keys,\n        getEvents: getEvents,\n        clickWeekEvent: clickWeekEvent,\n        dropEvent: dropEvent\n      });\n\n      init();\n    };\n\n    function init() {\n      self.zoom = parseInt(self.zoom);\n      self.allowedDays = self.usableDays.sort() || planningConfiguration.DAYS;\n      self.daysList = self.allowedDays.map(function (i) {\n        var d = moment(self.position);\n        d.weekday(i);\n        return d;\n      });\n\n      if (!self.zoom || self.zoom < 1) {\n        self.zoom = 1;\n      }\n\n      self._dayStart = self.dayStart ? parseTime(self.dayStart) : parseTime(0);\n      self._dayEnd = self.dayEnd ? parseTime(self.dayEnd) : parseTime(24);\n      self.width = self.zoom * (parseInt(self._dayEnd.h) - parseInt(self._dayStart.h) + 1) * BASE_SIZE + 'px';\n      self.sortedEvents = undefined;\n      switch (self.mode) {\n        case 'week':\n          self._events = _.flatten(_.map(self.events, split));\n          self._events = filter(self._events);\n\n          self.sortedEvents = _.groupBy(self._events, function (e) {\n            return e.start.format('DD/MM/YYYY');\n          });\n          addMissingDays(self.sortedEvents);\n          break;\n        case 'day':\n        case 'week-advanced':\n          self._events = _.flatten(_.map(self.events, split));\n          self._events = filter(self._events);\n          self.sortedEvents = _.groupBy(self._events, function (e) {\n            return e[self.dayField];\n          });\n          /* If we are in advanced week mode, we have a double grouping: first by technician, then by day of week */\n          if (self.mode === 'week-advanced') {\n            self.sortedEvents = _.mapValues(self.sortedEvents, function (eventsByTechnician) {\n              return _.groupBy(eventsByTechnician, function (e) {\n                return e.start.weekday();\n              });\n            });\n          }\n          addMissingEntities(self.sortedEvents);\n          break;\n        case '3day':\n          self._events = _.flatten(_.map(self.events, split));\n          self._events = filter(self._events);\n          self.sortedEvents = _.reduce(self.entities, function (acc, v) {\n            acc[v] = [];\n            return acc;\n          }, {});\n\n          var keys = _.keys(self.sortedEvents);\n          self.groupedEvents = _.map(_.groupBy(self._events, function (e) {\n            return moment(e.start).startOf('day').unix();\n          }), function (v, k) {\n            var result = {\n              key: k,\n              date: moment.unix(k).startOf('day').toDate(),\n              day: moment.unix(k).startOf('day').format('dddd DD MMMM'),\n              value: _.groupBy(v, function (e) {\n                return e.technician;\n              }),\n              absences: angular.copy(self.absences)\n            };\n            _.each(self.entities, function (e) {\n              if (!result.value[e]) {\n                result.value[e] = [];\n              }\n            });\n            return result;\n          });\n\n          var start = moment(self.position).hour(self._dayStart.h).minute(self._dayStart.m).second(0);\n          var stop = moment(self.position).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59);\n          var days = [{ start: angular.copy(start), end: angular.copy(stop) }];\n\n          var j = 0;\n          while (j < 2) {\n            stop.add(1, 'day');\n            var d = stop.day() - 1;\n            if (d < 0) {\n              d = 6;\n            }\n            if (_.isEmpty(self.allowedDays) || _.includes(self.allowedDays, d)) {\n              days.push({ start: angular.copy(stop).hour(self._dayStart.h).minute(self._dayStart.m).second(0), end: angular.copy(stop).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59) });\n              j++;\n            }\n          }\n\n          _.each(days, function (d) {\n            var date = \"\" + moment(d.start).startOf('day').unix();\n\n            var found = _.find(self.groupedEvents, function (group) {\n              return group.key === date;\n            });\n\n            if (!found) {\n              var obj = {\n                key: date,\n                date: moment(angular.copy(d.start)).startOf('day').toDate(),\n                day: moment(angular.copy(d.start)).startOf('day').format('dddd DD MMMM'),\n                value: {},\n                absences: angular.copy(self.absences)\n              };\n              _.each(_.keys(self.sortedEvents), function (k) {\n                obj.value[k] = [];\n              });\n              self.groupedEvents.push(obj);\n            }\n          });\n          self.groupedEvents = _.sortBy(self.groupedEvents, function (e) {\n            return e.key;\n          });\n          break;\n        case 'month':\n          var firstDay = moment(self.position).date(1).hours(0).minutes(0).seconds(0);\n          self.month = moment(self.position).date(1).hours(0).minutes(0).seconds(0).format('MMMM');\n          self.decallage = firstDay.isoWeekday() - 1; //\n\n          if (self.decallage < 0) {\n            self.decallage = 0;\n          }\n          self.oneDayEvents = _(self.events).filter(function (event) {\n            return event.start.dayOfYear() === event.end.dayOfYear() && event.start.month() === moment(self.position).month();\n          }).groupBy(function (event) {\n            return Math.floor((event.start.date() + self.decallage) / 7.01);\n          }) // 7.01 -> Fix issue when start day = 7 (sunday)\n          .value();\n          self.multipleDaysEvents = _(self.events).filter(function (event) {\n            return event.start.dayOfYear() !== event.end.dayOfYear();\n          }).map(splitByWeeks).flatten().groupBy(function (event) {\n            return Math.floor((event.start.date() + self.decallage) / 7.01); // 7.01 -> Fix issue when start day = 7 (sunday)\n          }).value();\n\n          var endWeek = moment(self.position).endOf('month').isoWeek();\n          var startWeek = moment(self.position).startOf('month').isoWeek();\n          // When switching years, last week of month can be 1\n          if (endWeek === 1) {\n            endWeek = moment(self.position).isoWeeksInYear() + 1;\n          }\n          var weekInMonth = endWeek - startWeek + 1;\n          for (var i = 0; i < weekInMonth; i++) {\n            if (self.multipleDaysEvents[i] === undefined) {\n              self.multipleDaysEvents[i] = [];\n            }\n          }\n          self.days = [];\n          // Add day from previous month\n          if (firstDay.isoWeekday() - 1 > 0) {\n            for (i = 0; i < firstDay.isoWeekday() - 1; i++) {\n              self.days.unshift({});\n            }\n          }\n          _.times(firstDay.daysInMonth(), function (n) {\n            var day = moment(firstDay).add(n, 'days');\n            self.days.push({ date: day, events: [] });\n          });\n\n          var displayedDaysCount = self.days.length > 35 ? 42 : 35;\n          while (self.days.length < displayedDaysCount) {\n            self.days.push({});\n          }\n          break;\n      }\n    }\n\n    function split(_x) {\n      var _again = true;\n\n      _function: while (_again) {\n        var event = _x;\n        _again = false;\n\n        // Event starts and ends the same day\n        event = angular.copy(event);\n\n        var start = moment(event.start).hour(self._dayStart.h).minute(self._dayStart.m).second(0);\n        var stop = moment(event.end).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59);\n        if (event.start.dayOfYear() === event.end.dayOfYear()) {\n          // reset the boundaries if they exceed the one fixed.\n          // And trim events that are entirely out of the boundaries\n          if (event.start.isBefore(start)) {\n            if (event.end.isBefore(start)) {\n              return [];\n            }\n            event.start = start;\n          }\n          if (event.end.isAfter(stop)) {\n            if (event.start.isAfter(stop)) {\n              return [];\n            }\n            event.end = stop;\n          }\n          return [event];\n        }\n        // Event is on several days.\n        // Build a first event that ends at the end of the first day\n        var first_event = angular.copy(event);\n        first_event.end = moment(event.start).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59);\n        if (event.start.isBefore(start)) {\n          first_event.start = start;\n        }\n\n        var startNextDay = moment(event.start).add(1, 'day').hour(self._dayStart.h).minute(self._dayStart.m);\n        var endThisDay = moment(event.start).hour(self._dayEnd.h).minute(self._dayEnd.m);\n        if (event.end.isBefore(startNextDay)) {\n          if (first_event.start.isAfter(endThisDay)) {\n            return [];\n          }\n          // Event finishes before start hour next day. No need to create another one\n          return [first_event];\n        }\n        first_event.continuedAfter = true;\n\n        // Build a second event that starts at the beginning of the following days.\n        // This event may end several days later. Recursion will handle it\n        var second_event = angular.copy(event);\n        second_event.start = moment(event.start).add(1, 'day').hour(self._dayStart.h).minute(self._dayStart.m);\n        second_event.continuedBefore = true;\n\n        if (event.start.isAfter(endThisDay)) {\n          // If the first event starts after curfew, don't add it\n          _x = second_event;\n          _again = true;\n          start = stop = first_event = startNextDay = endThisDay = second_event = undefined;\n          continue _function;\n        }\n\n        return [first_event].concat(split(second_event));\n      }\n    }\n\n    function splitByWeeks(event) {\n      if (event.start.isAfter(event.end)) {\n        var st = event.start;\n        event.start = event.end;\n        event.end = st;\n      }\n\n      if (event.start.year() < self.position.year() || event.start.month() < self.position.month()) {\n        // Event starts before our current month\n        if (event.end.year() < self.position.year() || event.end.month() < self.position.month()) {\n          // Event also ends before. Return nothing\n          return [];\n        }\n        // Set the beginning at the start of the month\n        event.start = moment(self.position).startOf('month');\n      }\n      if (event.end.month() > self.position.month() || event.end.year() !== self.position.year()) {\n        // Event ends after current month\n        if (event.start.month() > self.position.month()) {\n          return [];\n        }\n        event.end = moment(self.position).endOf('month');\n      }\n      // console.info(_.cloneDeep(event))\n      if (event.start.isoWeek() === event.end.isoWeek()) {\n        // If our event is on one week, we're all set\n        return [event];\n      }\n\n      // Split\n      var firstEvent = angular.copy(event);\n      var secondEvent = angular.copy(event);\n      // make it end on the same week\n      firstEvent.continuedAfter = true;\n      secondEvent.continuedBefore = true;\n      firstEvent.end = moment(firstEvent.start).endOf('week');\n      secondEvent.start.add(1, 'week').startOf('week');\n      // Recursion will handle potential split needed by second event\n      return [firstEvent].concat(splitByWeeks(secondEvent));\n    }\n\n    function filter(events) {\n      // remove event not in range (month, week, day)\n      return _.filter(events, function (e) {\n        var start, stop;\n        switch (self.mode) {\n          case 'week':\n          case 'week-advanced':\n            start = moment(self.position).weekday(0).hour(self._dayStart.h).minute(self._dayStart.m).second(0);\n            stop = moment(self.position).weekday(6).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59);\n            break;\n          case 'day':\n            start = moment(self.position).hour(self._dayStart.h).minute(self._dayStart.m).second(0);\n            stop = moment(self.position).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59);\n            break;\n          case '3day':\n            start = moment(self.position).hour(self._dayStart.h).minute(self._dayStart.m).second(0);\n            stop = moment(self.position).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59);\n            var days = [{ start: angular.copy(start), end: angular.copy(stop) }];\n\n            var i = 0;\n            while (i < 2) {\n              stop.add(1, 'day');\n              var d = stop.day() - 1;\n              if (d < 0) {\n                d = 6;\n              }\n              if (_.isEmpty(self.allowedDays) || _.includes(self.allowedDays, d)) {\n                days.push({ start: angular.copy(stop).hour(self._dayStart.h).minute(self._dayStart.m).second(0), end: angular.copy(stop).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59) });\n                i++;\n              }\n            }\n            return _.some(days, function (d) {\n              return e.start.isBetween(d.start, d.end) || e.end.isBetween(d.start, d.end);\n            });\n          case 'month':\n            start = moment(self.position).date(1).hour(self._dayStart.h).minute(self._dayStart.m).second(0);\n            stop = moment(self.position).weekday(moment(self.position).daysInMonth()).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59);\n            break;\n        }\n        return e.start.isBetween(start, stop) || e.end.isBetween(start, stop);\n      });\n    }\n\n    function addMissingDays(sortedEvents) {\n      sortedEvents = sortedEvents || {};\n      var startingDay = moment(self.position).weekday(0);\n      _.times(7, function (i) {\n        var newDate = moment(angular.copy(startingDay)).add(i, 'days').format('DD/MM/YYYY');\n        if (!sortedEvents[newDate]) {\n          sortedEvents[newDate] = [];\n        }\n      });\n    }\n\n    function addMissingEntities(sortedEvents) {\n      sortedEvents = sortedEvents || {};\n      _.each(self.entities, function (e) {\n        if (!sortedEvents[e]) {\n          sortedEvents[e] = [];\n        }\n      });\n    }\n\n    function parseTime(h) {\n      if (h >= 24) {\n        return { h: 23, m: 59 };\n      }\n      return { h: h, m: 0 };\n    }\n\n    function keys(sortedEvents) {\n      switch (self.mode) {\n        case 'week':\n          return Object.keys(sortedEvents).sort(function (a, b) {\n            var dateA = dateFromString(a);\n            var dateB = dateFromString(b);\n            return dateA - dateB;\n          });\n        case 'week-advanced':\n        case 'day':\n        case '3day':\n          return Object.keys(sortedEvents).sort();\n      }\n    }\n\n    function getEvents(key) {\n      return self.sortedEvents[key];\n    }\n\n    $scope.$watchCollection(function () {\n      return [self.events, self.entities, self.position, self.mode, self.dayStart, self.dayEnd, self.zoom, self.usableDays];\n    }, init);\n\n    function isToday(n) {\n      return self.position.week() === moment().week() && n === moment().dayOfYear();\n    }\n\n    function isInDayRange() {\n      return moment().hour() > parseInt(self._dayStart.h) && moment().hour() < parseInt(self._dayEnd.h);\n    }\n\n    function currentTimeToPixels() {\n      var totalMinutes = (moment().hour() - parseInt(self._dayStart ? self._dayStart.h : 0)) * 60 + moment().minutes();\n      return Math.floor(self.zoom * (BASE_SIZE * totalMinutes) / 60);\n    }\n\n    function isCurrent() {\n      return self.position.isSame(moment(), self.mode);\n    }\n\n    function clickCallbackWrapper(opts) {\n      var mom;\n      var entity;\n      switch (self.mode) {\n        case 'week':\n          var split = opts.d.split('/');\n          /**\n           * split[2] === year\n           * split[1] === month, we need to subtract 1 because momentJS months starts at 0\n           * split[0] === dayOfMonth\n           */\n          mom = moment(new Date(split[2], split[1] - 1, split[0], opts.h, opts.m));\n          break;\n        case '3day':\n        case 'day':\n          mom = moment(self.position).hour(opts.h).minute(opts.m);\n          entity = opts.entity;\n          break;\n        case 'week-advanced':\n          entity = opts.entity;\n          mom = moment(self.position).hour(opts.h).minute(opts.m).second(0).weekday(opts.d);\n          break;\n      }\n      self.clickCallback({ $moment: mom, $entity: entity });\n    }\n\n    function clickWeekEvent(day, $event) {\n      if (day.date) {\n        self.clickCallback({ $moment: day.date });\n      }\n    }\n\n    function dropEvent(config) {\n      var mom = config.moment;\n      if (!mom) {\n        switch (self.mode) {\n          case 'week':\n            var doy = moment(dateFromString(config.d)).dayOfYear();\n            mom = moment(self.position).hour(config.h).minute(config.m).second(0).dayOfYear(doy);\n            break;\n          case 'week-advanced':\n            mom = moment(self.position).hour(config.h).minute(config.m).second(0).weekday(config.d);\n            break;\n          case 'day':\n            mom = moment(self.position).hour(config.h).minute(config.m);\n            break;\n          case '3day':\n            mom = moment.unix(config.day).hour(config.h).minute(config.m);\n        }\n      }\n      var entity = _.includes(['week-advanced', 'day', '3day'], self.mode) ? config.entity : undefined;\n      self.dropCallback({ $moment: mom, $data: config.$data, $event: config.$event, $entity: entity });\n    }\n\n    function calculateAdvancedWeekContainerHeight() {\n      return parseInt(self.zoom) * Math.max(planningConfiguration.BASE_SIZE - 8, 1) + 'px';\n    }\n\n    function dateFromString(date) {\n      var dateSplitted = date.split('/');\n      return new Date(dateSplitted[2], dateSplitted[1] - 1, dateSplitted[0]);\n    }\n  }\n\n  function PlanningDirective() {\n    return {\n      restrict: 'E',\n      templateUrl: '/directives/planning/planning.html',\n      controller: PlanningController,\n      controllerAs: 'planning',\n      bindToController: {\n        zoom: '=',\n        events: '=',\n        entities: '=',\n        entitiesPauses: '=?',\n        absences: '=?',\n        position: '=',\n        mode: '=',\n        dayStart: '=',\n        dayEnd: '=',\n        dayField: '=',\n        eventCallback: '&',\n        dayCallback: '&',\n        clickCallback: '&',\n        weekEventCallback: '&',\n        dropCallback: '&',\n        usableDays: '=?',\n        action: '&?'\n      },\n      scope: {}\n    };\n  }\n})(window.angular, window.moment, window._);","'use strict';\n\n;(function (angular, _, moment) {\n  'use strict';\n\n  angular.module('90Tech.planning').directive('zlPlanningDay', PlanningDayDirective);\n\n  PlanningDayController.$inject = [\n  // Angular\n  '$scope'\n  // Libs\n  // Managers\n  // Services\n  // Const\n  // Resolved\n  ];\n  function PlanningDayController(\n  // Angular\n  $scope\n  // Libs\n  // Managers\n  // Services\n  // Const\n  // Resolved\n  ) {\n    var self = this;\n\n    self.$onInit = function () {\n      _.extend(self, {\n        dropEvent: dropEvent,\n        absents: []\n      });\n\n      self.isDefined = self.day.events === undefined;\n      init();\n      $scope.$watchCollection([self.day, self.absences], function () {\n        if (self.day && self.day.date && self.absences && Object.keys(self.absences).length) {\n          self.absents = Object.keys(self.absences).reduce(function (acc, key) {\n            var array = self.absences[key];\n            var hasOverlap = _.any(array, function (absence) {\n              var range = moment.range(absence.start, absence.end);\n              return self.day.date.within(range);\n            });\n            if (hasOverlap) {\n              acc.push(key);\n            }\n            return acc;\n          }, []);\n          self.absentsString = '<div>' + self.absents.join('<br>') + '</div>';\n        } else {\n          self.absentsString = '';\n          self.absents = [];\n        }\n      });\n    };\n\n    function init() {}\n\n    function dropEvent(data, event) {\n      self.dropCallback({ $data: data, $event: event });\n    }\n  }\n\n  /**\n   *\n   */\n  function PlanningDayDirective() {\n    return {\n      restrict: 'E',\n      replace: true,\n      templateUrl: '/directives/planning-day-block/planning-day.html',\n      controller: PlanningDayController,\n      controllerAs: 'dayCtrl',\n      bindToController: {\n        day: '=',\n        events: '=',\n        clickCallback: '&',\n        dropCallback: '&',\n        absences: '=?'\n      },\n      scope: true,\n      link: function link(scope, element) {\n        var el = element[0];\n        window.addEventListener('dragover', function (e) {\n          e.preventDefault();\n        }, false);\n        window.addEventListener('drop', function (e) {\n          e.preventDefault();\n        }, false);\n        el.addEventListener('drop', function (e) {\n          e.preventDefault();\n          e.stopPropagation();\n          if (e.stopPropagation) e.stopPropagation();\n          this.classList.remove('over');\n          scope.$apply(function () {\n            scope.dayCtrl.dropEvent(JSON.parse(e.dataTransfer.getData('Text')), e);\n          });\n          return false;\n        }, false);\n\n        el.addEventListener('dragenter', function (e) {\n          this.classList.add('over');\n          return false;\n        }, false);\n\n        el.addEventListener('dragleave', function (e) {\n          this.classList.remove('over');\n          return false;\n        }, false);\n      }\n    };\n  }\n})(window.angular, window._, window.moment);","'use strict';\n\n;(function (angular, moment, _) {\n  'use strict';\n\n  angular.module('90Tech.planning').directive('zlPlanningLeftColumn', PlanningDirective);\n\n  PlanningLeftColumnController.$inject = ['$scope'];\n\n  function PlanningLeftColumnController($scope) {\n    var self = this;\n\n    self.$onInit = function () {\n      $scope.$watchCollection(function () {\n        return [self.events, self.position, self.mode, self.dayStart, self.dayEnd, self.usableDays];\n      }, init);\n    };\n\n    function init() {\n      self.days = [];\n      self.allowedDays = self.usableDays;\n      if (self.mode === 'week') {\n        _.forEach(self.allowedDays, function (d) {\n          var day = moment(self.position);\n          day.weekday(d);\n          self.days.push(day);\n        });\n        self.days = _.sortBy(self.days, function (d) {\n          return moment(d).toDate();\n        });\n      } else if (self.mode === 'day' && self.dayField) {\n        self.column = Object.keys(self.events).sort();\n      }\n    }\n  }\n\n  function PlanningDirective() {\n    return {\n      restrict: 'E',\n      templateUrl: '/directives/planning-left-column/planning-left-column.html',\n      controller: PlanningLeftColumnController,\n      controllerAs: 'planningLeftColumn',\n      bindToController: {\n        events: '=',\n        position: '=',\n        mode: '=',\n        dayField: '=',\n        usableDays: '='\n      },\n      scope: true\n    };\n  }\n})(window.angular, window.moment, window._);","'use strict';\n\n;(function (angular, _, moment) {\n  'use strict';\n\n  angular.module('90Tech.planning').directive('zlPlanningLine', PlanningLineDirective);\n\n  PlanningLineController.$inject = ['$scope', 'planningConfiguration', 'PositionService', 'ColorService', 'PauseService', 'AbsenceService'];\n\n  /**\n   *\n   */\n  function PlanningLineController($scope, planningConfiguration, PositionService, ColorService, PauseService, AbsenceService) {\n\n    var BASE_SIZE = planningConfiguration.BASE_SIZE;\n    var parallelText = planningConfiguration.parallelText;\n    var MAX_PARALLEL = planningConfiguration.MAX_PARALLEL;\n\n    var self = this;\n\n    self.$onInit = function () {\n      _.extend(self, {\n        clickEvent: clickEvent,\n        calcWidth: calcWidth,\n        dropEvent: dropEvent\n      });\n      init();\n      $scope.$watchCollection(function () {\n        return [self.events, self.dayStart, self.dayEnd];\n      }, init);\n\n      $scope.$watchCollection(function () {\n        return [self.absences];\n      }, function (newValue, oldValue) {\n        if (Array.isArray(self.absences) && self.absences.length) {\n          var start = moment(angular.copy(self.position)).startOf('day');\n          var end = moment(angular.copy(self.position)).endOf('day');\n          self._absences = AbsenceService.parseAbsences(self.absences, [start, end]).map(function (abs) {\n            abs.style = {\n              left: (moment(abs.start).hours() - self.dayStart.h) * BASE_SIZE * self.zoom + moment(abs.start).minutes() * BASE_SIZE * self.zoom / 60 + 'px',\n              width: self.zoom * self.SLIDER_WIDTH * moment.range(abs.start, abs.end).valueOf() / self.SECONDS_BY_DAY / 1000 + 'px'\n            };\n            abs.range = moment.range(abs.start, abs.end);\n            return abs;\n          });\n        } else {\n          self._absences = [];\n        }\n      });\n    };\n\n    self.log = function (a) {};\n\n    self.replace = function (string) {\n      if (!string) return;\n      return string.replace(/([a-zA-Z\\ ])\\w+/, '');\n    };\n\n    self.preEvent = {};\n\n    function extractMinutesFromEvent($event) {\n      var minutes;\n      if (_.contains($event.target.classList, 'half-hour')) {\n        // If the user has clicked right on the half-hour line, offsetX is 0\n        minutes = 30;\n      } else {\n        minutes = Math.floor($event.offsetX / (BASE_SIZE * self.zoom) * 60);\n      }\n      return minutes;\n    }\n\n    function dropEvent(data, event) {\n      var hour = parseInt(event.target.getAttribute('hour'));\n      var minutes = extractMinutesFromEvent(event);\n      var date = moment(angular.copy(self.position)).hours(hour + parseInt(self.dayStart.h)).minutes(minutes);\n      if (!checkAbsence(date)) {\n        self.dropCallback({ $data: data, $event: event, $hour: hour + parseInt(self.dayStart.h), $minutes: minutes });\n      } else {\n        planningConfiguration.absentTechnicianCallback(function () {\n          self.dropCallback({ $data: data, $event: event, $hour: hour + parseInt(self.dayStart.h), $minutes: minutes });\n        });\n      }\n    }\n\n    function clickEvent(hour, $event) {\n      var minutes = extractMinutesFromEvent($event);\n      var date = moment(angular.copy(self.position)).hours(hour + parseInt(self.dayStart.h)).minutes(minutes);\n      if (!checkAbsence(date)) {\n        self.clickCallback({ $hour: hour + parseInt(self.dayStart.h), $minutes: minutes });\n      } else {\n        planningConfiguration.absentTechnicianCallback(function () {\n          self.clickCallback({ $hour: hour + parseInt(self.dayStart.h), $minutes: minutes });\n        });\n      }\n    }\n\n    function init() {\n      var currentId = 0;\n      //     self.SLIDER_WIDTH   = 24 * BASE_SIZE\n      self.preEvent = {};\n      self.breaks = [];\n\n      self._events = angular.copy(self.events);\n\n      self.range = self.dayEnd.h - self.dayStart.h;\n      self.SECONDS_BY_DAY = 3600 * self.range;\n      self.SLIDER_WIDTH = BASE_SIZE * self.range;\n\n      // Pre-sort events by start Date\n      self._events = _.sortBy(self._events, function (e) {\n        return e.start.valueOf();\n      });\n\n      var lines = [[]];\n      var toremove = [];\n      _.each(self._events, function (event) {\n        var style = {};\n        event.depth = 1;\n        event.range = moment.range(event.start, event.end);\n        if (event.range < 900000) {\n          var end = moment(event.start).add(15, 'minutes');\n          event.range = moment.range(event.start, end);\n        }\n        style.left = (event.start.hours() - self.dayStart.h) * BASE_SIZE * self.zoom + event.start.minutes() * BASE_SIZE * self.zoom / 60 + 'px';\n        //   style.left                = event.start.hours() * 150 + event.start.minutes() * 150 / 60 + 'px'\n        style.width = self.zoom * self.SLIDER_WIDTH * event.range / self.SECONDS_BY_DAY / 1000 + 'px';\n        style['background-color'] = event['background-color'] || '#778899';\n        if (ColorService.getLuminance(style['background-color']) > 200) {\n          style.color = 'black';\n        } else {\n          style.color = 'white';\n        }\n        event.style = style;\n        PositionService.overlap(lines, event, MAX_PARALLEL, toremove);\n      });\n      self._events = _.difference(self._events, toremove);\n      _.each(self._events, function (event) {\n        event.id = angular.copy(currentId);\n        if (event.line === MAX_PARALLEL) {\n          event.style.left = (event.start.hours() - self.dayStart.h) * BASE_SIZE * self.zoom + event.start.minutes() * BASE_SIZE * self.zoom / 60 + 'px';\n          event.style.width = self.zoom * self.SLIDER_WIDTH * event.range.valueOf() / self.SECONDS_BY_DAY / 1000 + 'px';\n          event.style['background-color'] = '#000';\n          event.style['font-weight'] = 'bold';\n          event.style.color = '#fff';\n          event.title = event.eventList.length + ' ' + parallelText;\n          if (event.tooltip) event.tooltip = event.title;\n        }\n        event.style.width = self.zoom * self.SLIDER_WIDTH * event.range.valueOf() / self.SECONDS_BY_DAY / 1000 + 'px';\n        if (event.line === undefined) event.line = MAX_PARALLEL;\n        event.style.top = Math.round(parseInt(event.line) * 70 / lines.length) + '%';\n        event.style.height = Math.round(70 / lines.length) + '%';\n        event.percentage = '100%';\n        if (event.pre > 0) {\n          event.style['border-left'] = 'none';\n          var s = moment(event.start).subtract(event.pre, 'minutes');\n          if (!moment(s).isSame(event.start, 'day')) {\n            s = moment(event.start).startOf('day');\n          }\n          var e = moment(event.start);\n          var r = moment.range(s, e);\n          var totalRange = moment.range(s, event.range.end);\n          var percentage = r.valueOf() / totalRange.valueOf() * 100;\n          event.percentage = 100 - percentage + '%';\n          var obj = {\n            percentage: percentage + '%',\n            style: {\n              left: (moment(s).hours() - self.dayStart.h) * BASE_SIZE * self.zoom + moment(s).minutes() * BASE_SIZE * self.zoom / 60 + 2 + 'px',\n              width: self.zoom * self.SLIDER_WIDTH * r.valueOf() / self.SECONDS_BY_DAY / 1000 + 'px',\n              top: event.style.top,\n              height: event.style.height,\n              totalWidth: self.zoom * self.SLIDER_WIDTH * totalRange.valueOf() / self.SECONDS_BY_DAY / 1000 + 'px',\n              'text-align': 'center',\n              color: '#fff',\n              'background': 'repeating-linear-gradient(45deg, ' + event['background-color'] + ', ' + event['background-color'] + ' 10px, white 10px, white 20px)',\n              'border-top': '1px lightgrey solid',\n              'border-bottom': '1px lightgrey solid',\n              'border-left': '1px lightgrey solid'\n            },\n            tooltip: 'Trajet estim de ' + event.pre + ' min'\n          };\n          if (percentage > 0) {\n            self.preEvent[event.id] = obj;\n          } else {\n            event.pre = 0;\n          }\n        }\n        if (event.pauses) {\n          event.style['background-image'] = PauseService.generateGradient(event, 'to right');\n          event.style['background-color'] = undefined;\n        }\n        currentId++;\n      });\n      if (self.pauses) {\n        createBreaks();\n      }\n    }\n\n    function calcWidth(zoom) {\n      return parseInt(zoom) * BASE_SIZE + 'px';\n    }\n\n    function createBreaks() {\n      self.breaks = _.compact(_.map(self.pauses.breaks, function (p) {\n        var pause = {\n          name: p.name,\n          start: moment().hours(p.start.split(':')[0]).minute(p.start.split(':')[1]).second(0),\n          end: moment().hours(p.end.split(':')[0]).minute(p.end.split(':')[1]).second(0),\n          style: {}\n        };\n\n        if (pause.start.isAfter(self.dayEnd) || pause.end.isBefore(self.dayStart)) {\n          return;\n        }\n        if (pause.start.isBefore(self.dayStart)) {\n          pause.start = moment(angular.copy(self.dayStart));\n        }\n\n        if (pause.end.isAfter(self.dayEnd)) {\n          pause.end = moment(angular.copy(self.dayEnd));\n        }\n        pause.style.left = (pause.start.hours() - self.dayStart.h) * BASE_SIZE * self.zoom + pause.start.minutes() * BASE_SIZE * self.zoom / 60 + 'px';\n        pause.style.width = self.zoom * self.SLIDER_WIDTH * moment.range(pause.start, pause.end).valueOf() / self.SECONDS_BY_DAY / 1000 + 'px';\n\n        return pause;\n      }));\n    }\n\n    function checkAbsence(date) {\n      var d = moment(angular.copy(date));\n      return _.any(self._absences, function (abs) {\n        return abs.range.contains(d);\n      });\n    }\n  }\n\n  function PlanningLineDirective() {\n    return {\n      restrict: 'E',\n      templateUrl: '/directives/planning-line/planning-line.html',\n      controller: PlanningLineController,\n      controllerAs: 'line',\n      bindToController: {\n        zoom: '=',\n        dayStart: '=',\n        dayEnd: '=',\n        events: '=',\n        clickCallback: '&',\n        dropCallback: '&',\n        pauses: '=?',\n        absences: '=?',\n        position: '=?'\n      },\n      scope: true\n    };\n  }\n})(window.angular, window._, window.moment);","'use strict';\n\n;(function (angular, moment, _) {\n  'use strict';\n\n  angular.module('90Tech.planning').directive('zlPlanningTopRow', topRowDirective);\n\n  topRowDirective.$inject = ['planningConfiguration'];\n\n  function topRowDirective(planningConfiguration) {\n    var BASE_SIZE = planningConfiguration.BASE_SIZE;\n\n    return {\n      restrict: 'E',\n      templateUrl: '/directives/planning-top-row/planning-top-row.html',\n      controller: ['$scope', PlanningTopRowController],\n      controllerAs: 'planningTopRow',\n      bindToController: {\n        zoom: '=',\n        dayStart: '=',\n        dayEnd: '=',\n        events: '=',\n        entities: '=',\n        position: '=',\n        mode: '=',\n        callback: '&'\n      },\n      scope: {}\n    };\n\n    function PlanningTopRowController($scope) {\n      var self = this;\n\n      self.$onInit = function () {\n        $scope.$watchGroup([function () {\n          return self.dayStart;\n        }, function () {\n          return self.dayEnd;\n        }], init);\n\n        _.extend(self, {\n          calcWidth: calcWidth,\n          calcMargin: calcMargin\n        });\n\n        init();\n      };\n\n      function init() {\n        var range = self.dayEnd.h - self.dayStart.h + 1;\n        self.hours = [];\n        _.times(range, function (i) {\n          var d = moment(self.position);\n          d.hour(i + parseInt(self.dayStart.h));\n          d.minute(0);\n          self.hours.push(d);\n        });\n      }\n\n      function calcWidth(zoom) {\n        return parseInt(zoom) * BASE_SIZE + 'px';\n      }\n\n      function calcMargin(zoom, index) {\n        var half = parseInt(zoom) * (BASE_SIZE / 2);\n        if (!index) half = half - 3 * parseInt(zoom);\n        return '0 ' + half + 'px 0 -' + half + 'px';\n      }\n    }\n  }\n})(window.angular, window.moment, window._);","'use strict';\n\n;(function (angular, _, moment) {\n  'use strict';\n\n  angular.module('90Tech.planning').directive('zlPlanningVerticalLine', PlanningLineDirective);\n\n  PlanningLineController.$inject = ['$filter', '$scope', 'planningConfiguration', 'PositionService', 'ColorService', 'PauseService', 'AbsenceService'];\n\n  /**\n   *\n   */\n  function PlanningLineController($filter, $scope, planningConfiguration, PositionService, ColorService, PauseService, AbsenceService) {\n\n    /** BASE_SIZE is the span of an hour. It gets multiplied by zoom (default 10) to get the size in pixel\n     * in vertical mode, we need to reduce it since we have much less space\n     */\n    var BASE_SIZE = Math.max(planningConfiguration.BASE_SIZE - 8, 1);\n    var parallelText = planningConfiguration.parallelText;\n    var MAX_PARALLEL = planningConfiguration.MAX_PARALLEL;\n    var AVAILABLE_SPACE = 90; // Total horizontal space taken by the events\n\n    var self = this;\n\n    self.$onInit = function () {\n      $scope.$watchCollection(function () {\n        return [self.events, self.dayStart, self.dayEnd];\n      }, init);\n\n      $scope.$watchCollection(function () {\n        return self.absences;\n      }, function (oldValue, newValue) {\n        if (Array.isArray(self.absences) && self.absences.length) {\n          var start = moment(angular.copy(self.day)).startOf('day');\n          var end = moment(angular.copy(self.day)).endOf('day');\n          self._absences = AbsenceService.parseAbsences(angular.copy(self.absences), [start, end]).map(function (abs) {\n            abs.style = {\n              top: (moment(abs.start).hours() - self.dayStart.h) * BASE_SIZE * self.zoom + moment(abs.start).minutes() * BASE_SIZE * self.zoom / 60 + 'px',\n              height: self.zoom * self.SLIDER_WIDTH * moment.range(abs.start, abs.end).valueOf() / self.SECONDS_BY_DAY / 1000 + 'px'\n            };\n\n            abs.range = moment.range(abs.start, abs.end);\n            return abs;\n          });\n        } else {\n          self._absences = [];\n        }\n      });\n\n      _.extend(self, {\n        clickEvent: clickEvent,\n        calcWidth: calcWidth,\n        dropEvent: dropEvent\n      });\n\n      init();\n    };\n\n    self.log = function (a) {};\n\n    self.replace = function (string) {\n      if (!string) return;\n      return string.replace(/([a-zA-Z\\ ])\\w+/, '');\n    };\n\n    self.preEvent = {};\n\n    function extractMinutesFromEvent($event) {\n      var minutes;\n      if (_.contains($event.target.classList, 'half-hour')) {\n        // If the user has clicked right on the half-hour line, offsetX is 0\n        minutes = 30;\n      } else {\n        minutes = Math.floor($event.offsetY / (BASE_SIZE * self.zoom) * 6) * 10;\n      }\n      return minutes;\n    }\n\n    function dropEvent(data, event) {\n      var hour = parseInt(event.target.getAttribute('hour'));\n      var minutes = extractMinutesFromEvent(event);\n      var date = moment(angular.copy(self.day)).hours(hour + parseInt(self.dayStart.h)).minutes(minutes);\n      if (!checkAbsence(date)) {\n        self.dropCallback({ $data: data, $event: event, $hour: hour, $minutes: minutes });\n      } else {\n        planningConfiguration.absentTechnicianCallback(function () {\n          self.dropCallback({ $data: data, $event: event, $hour: hour, $minutes: minutes });\n        });\n      }\n    }\n\n    function clickEvent(hour, $event) {\n      var minutes = extractMinutesFromEvent($event);\n      var date = moment(angular.copy(self.day)).hours(hour + parseInt(self.dayStart.h)).minutes(minutes);\n      if (!checkAbsence(date)) {\n        self.clickCallback({ $hour: hour + parseInt(self.dayStart.h), $minutes: minutes });\n      } else {\n        planningConfiguration.absentTechnicianCallback(function () {\n          self.clickCallback({ $hour: hour + parseInt(self.dayStart.h), $minutes: minutes });\n        });\n      }\n    }\n\n    function init() {\n      var currentId = 0;\n      //     self.SLIDER_WIDTH   = 24 * BASE_SIZE\n      self.preEvent = {};\n      self.breaks = [];\n\n      self._events = angular.copy(self.events);\n      self.range = self.dayEnd.h - self.dayStart.h;\n      self.SECONDS_BY_DAY = 3600 * self.range;\n      self.SLIDER_WIDTH = BASE_SIZE * self.range;\n\n      // Pre-sort events by start Date\n      self._events = _.sortBy(self._events, function (e) {\n        return e.start.valueOf();\n      });\n\n      var lines = [[]];\n      var toremove = [];\n      _.each(self._events, function (event) {\n        var style = {};\n        event.depth = 1;\n        event.range = moment.range(event.start, event.end);\n        if (event.range < 900000) {\n          var end = moment(event.start).add(15, 'minutes');\n          event.range = moment.range(event.start, end);\n        }\n        style.left = (event.start.hours() - self.dayStart.h) * BASE_SIZE * self.zoom + event.start.minutes() * BASE_SIZE * self.zoom / 60 + 'px';\n        //   style.left                = event.start.hours() * 150 + event.start.minutes() * 150 / 60 + 'px'\n        style.width = self.zoom * self.SLIDER_WIDTH * event.range / self.SECONDS_BY_DAY / 1000 + 'px';\n        style['background-color'] = event['background-color'] || '#778899';\n        if (ColorService.getLuminance(style['background-color']) > 200) {\n          style.color = 'black';\n        } else {\n          style.color = 'white';\n        }\n        event.style = style;\n        PositionService.overlap(lines, event, MAX_PARALLEL, toremove);\n      });\n      self._events = _.difference(self._events, toremove);\n      _.each(self._events, function (event) {\n        event.id = angular.copy(currentId);\n        if (event.line === MAX_PARALLEL) {\n          event.style.left = (event.start.hours() - self.dayStart.h) * BASE_SIZE * self.zoom + event.start.minutes() * BASE_SIZE * self.zoom / 60 + 'px';\n          event.style.width = self.zoom * self.SLIDER_WIDTH * event.range.valueOf() / self.SECONDS_BY_DAY / 1000 + 'px';\n          event.style['background-color'] = '#000';\n          event.style['font-weight'] = 'bold';\n          event.title = event.eventList.length + ' ' + parallelText;\n          event.style.color = '#fff';\n          if (event.tooltip) event.tooltip = event.title;\n        }\n        event.style.width = self.zoom * self.SLIDER_WIDTH * event.range.valueOf() / self.SECONDS_BY_DAY / 1000 + 'px';\n        if (event.line === undefined) event.line = MAX_PARALLEL;\n        event.style.top = Math.round(parseInt(event.line) * AVAILABLE_SPACE / lines.length) + '%';\n        event.style.height = Math.round(AVAILABLE_SPACE / lines.length) + '%';\n        event.percentage = '100%';\n        if (event.continuedBefore) event.pre = 0;\n        if (event.pre > 0) {\n          event.style['border-left'] = 'none';\n          var s = moment(event.start).subtract(event.pre, 'minutes');\n          if (!moment(s).isSame(event.start, 'day')) {\n            s = moment(event.start).startOf('day');\n          }\n          var e = moment(event.start);\n          var r = moment.range(s, e);\n          var totalRange = moment.range(s, event.range.end);\n          var percentage = r.valueOf() / totalRange.valueOf() * 100;\n          event.percentage = 100 - percentage + '%';\n          var obj = {\n            percentage: percentage + '%',\n            style: {\n              left: (moment(s).hours() - self.dayStart.h) * BASE_SIZE * self.zoom + moment(s).minutes() * BASE_SIZE * self.zoom / 60 + 'px',\n              width: self.zoom * self.SLIDER_WIDTH * r.valueOf() / self.SECONDS_BY_DAY / 1000 + 'px',\n              top: event.style.top,\n              height: event.style.height,\n              totalWidth: self.zoom * self.SLIDER_WIDTH * totalRange.valueOf() / self.SECONDS_BY_DAY / 1000 + 'px',\n              'text-align': 'center',\n              color: '#fff',\n              'background': 'repeating-linear-gradient(45deg, ' + event['background-color'] + ', ' + event['background-color'] + ' 10px, white 10px, white 20px)',\n              'border-top': '1px lightgrey solid',\n              'border-bottom': '1px lightgrey solid',\n              'border-left': '1px lightgrey solid'\n            },\n            tooltip: 'Trajet estim de ' + event.pre + ' min'\n          };\n          if (percentage > 0) {\n            self.preEvent[event.id] = obj;\n          } else {\n            event.pre = 0;\n          }\n          if (event.pauses) {\n            event.style['background-image'] = PauseService.generateGradient(event, 'to bottom');\n            event.style['background-color'] = undefined;\n          }\n        }\n        currentId++;\n      });\n      if (self.pauses) {\n        createBreaks();\n      }\n      calculateContainerHeight();\n    }\n\n    function calcWidth(zoom) {\n      return parseInt(zoom) * BASE_SIZE + 'px';\n    }\n\n    function createBreaks() {\n      self.breaks = _.compact(_.map(self.pauses.breaks, function (p) {\n        var pause = {\n          name: p.name,\n          start: moment().hours(p.start.split(':')[0]).minute(p.start.split(':')[1]).second(0),\n          end: moment().hours(p.end.split(':')[0]).minute(p.end.split(':')[1]).second(0),\n          style: {}\n        };\n\n        if (pause.start.isAfter(self.dayEnd) || pause.end.isBefore(self.dayStart)) {\n          return;\n        }\n        if (pause.start.isBefore(self.dayStart)) {\n          pause.start = moment(angular.copy(self.dayStart));\n        }\n\n        if (pause.end.isAfter(self.dayEnd)) {\n          pause.end = moment(angular.copy(self.dayEnd));\n        }\n\n        pause.style.top = (moment(pause.start).hours() - self.dayStart.h) * BASE_SIZE * self.zoom + moment(pause.start).minutes() * BASE_SIZE * self.zoom / 60 + 'px';\n        pause.style.height = self.zoom * self.SLIDER_WIDTH * moment.range(pause.start, pause.end).valueOf() / self.SECONDS_BY_DAY / 1000 + 'px';\n\n        return pause;\n      }));\n    }\n\n    function calculateContainerHeight() {\n      self.containerHeight = parseInt(self.zoom) * BASE_SIZE * $filter('range')(self.range) + 'px';\n    }\n\n    function checkAbsence(date) {\n      var d = moment(angular.copy(date));\n      return _.any(self._absences, function (abs) {\n        return abs.range.contains(d);\n      });\n    }\n  }\n\n  function PlanningLineDirective() {\n    return {\n      restrict: 'E',\n      templateUrl: '/directives/planning-vertical-line/planning-vertical-line.html',\n      controller: PlanningLineController,\n      controllerAs: 'line',\n      bindToController: {\n        zoom: '=',\n        dayStart: '=',\n        dayEnd: '=',\n        events: '=',\n        pauses: '=?',\n        day: '=',\n        absences: '=?',\n        clickCallback: '&',\n        dropCallback: '&'\n      },\n      scope: true\n    };\n  }\n})(window.angular, window._, window.moment);","'use strict';\n\n;(function (angular, moment, _) {\n  'use strict';\n\n  angular.module('90Tech.planning').directive('zlPlanningWeekLine', PlanningLineDirective);\n\n  PlanningLineController.$inject = ['$scope', 'PositionService', 'planningConfiguration', 'ColorService'];\n\n  /**\n   *\n   */\n  function PlanningLineController($scope, PositionService, planningConfiguration, ColorService) {\n    var self = this;\n\n    self.$onInit = function () {\n      _.extend(self, {\n        calculateWidth: calculateWidth,\n        calculateLeft: calculateLeft\n      });\n\n      init();\n\n      $scope.$watchCollection(function () {\n        return [self.events, self.week];\n      }, init);\n    };\n\n    var parallelText = planningConfiguration.parallelText;\n    var MAX_PARALLEL = planningConfiguration.MAX_PARALLEL;\n\n    function init() {\n      self.displayedEvents = _(self.events).sortBy(function (event) {\n        return event.continuedBefore ? -1 : event.continuedAfter ? 0 : 1; // Order event list\n      }).value();\n\n      self.displayedEvents = positioning(self.displayedEvents);\n      self.oneDayEvents = positioning(self.oneDayEvents);\n    }\n\n    function positioning(eventList) {\n      var lines = [[]];\n      var toRemove = [];\n      _.each(eventList, function (event) {\n        event.style = {};\n        event.depth = 1;\n        event.range = moment.range(event.start, event.end);\n        PositionService.overlap(lines, event, MAX_PARALLEL, toRemove, true);\n      });\n      eventList = _.difference(eventList, toRemove);\n      _.each(eventList, function (event) {\n        setStyle(event, lines.length);\n      });\n      return eventList;\n    }\n\n    function setStyle(event, height) {\n      event.style.left = calculateLeft(event);\n      event.style.width = calculateWidth(event);\n      event.style['background-color'] = event['background-color'];\n      if (ColorService.getLuminance(event.style['background-color']) > 200) {\n        event.style.color = 'black';\n      } else {\n        event.style.color = 'white';\n      }\n\n      event.style.top = Math.ceil(event.line * 100 / height) + '%';\n      event.style.height = Math.round(100 / height) + '%';\n      if (event.line === undefined) event.line = MAX_PARALLEL;\n      if (event.eventList && event.eventList.length > 1) {\n        event.style['background-color'] = '#000';\n        event.style['color'] = '#FFF';\n        event.style['font-weight'] = 'bold';\n        event.title = event.eventList.length + ' ' + parallelText;\n        if (event.tooltip) event.tooltip = event.title;\n      }\n    }\n\n    function calculateWidth(event) {\n      if (event.start.day() === event.end.day()) {\n        return (event.end.diff(event.start, 'days') + 1) * (100 / 7) + '%';\n      } else {\n        var diff = Math.ceil(event.end.diff(event.start, 'hours') / 24);\n        if (event.end.hours() < event.start.hours()) {\n          diff += 1;\n        }\n        return diff * (100 / 7) + '%';\n      }\n    }\n\n    function calculateLeft(event) {\n      return (event.start.isoWeekday() - 1) * (99.9 / 7) + '%';\n    }\n  }\n\n  function PlanningLineDirective() {\n    return {\n      restrict: 'E',\n      replace: true,\n      templateUrl: '/directives/planning-week-line/planning-week-line.html',\n      controller: PlanningLineController,\n      controllerAs: 'line',\n      bindToController: {\n        events: '=',\n        week: '=',\n        oneDayEvents: '=',\n        weekEventCallback: '&'\n      },\n      scope: true\n    };\n  }\n})(window.angular, window.moment, window._);","angular.module('90Tech.planning').run(['$templateCache', function($templateCache) {$templateCache.put('/templates/planning-context-menu.html','<ul class=\"dropdown-menu context-menu\" ng-click=$event.stopPropagation(); style=\"z-index: 10\"><li ng-if=\"!event.eventList.length && !ev.eventList.length\"><a ng-click=\"planning.action({$element: event || ev})\"><i class=\"mdi mdi-chevron-down\"></i> Ouvrir dans un nouvel onglet {{event.eventList.length}}</a></li></ul>');\n$templateCache.put('/directives/planning/planning.html','<div ng-if=\"planning.mode ===\\'day\\' || planning.mode === \\'week\\'\" style=\"height: 100%;\"><zl-planning-left-column mode=planning.mode position=planning.position day-field=planning.dayField usable-days=planning.allowedDays events=planning.sortedEvents></zl-planning-left-column><div class style=height:100%><div zl-horizontal-scroll scroll-left=planning.currentTimeToPixels() style=height:100%><div ng-style=\"{width: planning.width}\" class=planning-body><zl-planning-top-row mode=planning.mode zoom=planning.zoom position=planning.position day-start=planning._dayStart day-end=planning._dayEnd></zl-planning-top-row><div class=hour-cursor ng-style=\"{left: planning.currentTimeToPixels()+\\'px\\'}\" ng-if=\"planning.isCurrent() && planning.isInDayRange()\"><div class=hour-caret></div></div><div class=planning-2pc></div><zl-planning-line ng-if=\"planning.mode === \\'day\\'\" zoom=planning.zoom absences=planning.absences[i] position=planning.position day-start=planning._dayStart day-end=planning._dayEnd ng-repeat=\"i in planning.keys(planning.sortedEvents)\" class=\"day b-b\" ng-class=\"{today: planning.isToday(i)}\" events=planning.getEvents(i) pauses=planning.entitiesPauses[i] drop-callback=\"planning.dropEvent({h: $hour, m: $minutes, d: i, entity: i, $data: $data, $event: $event})\" click-callback=\"planning.clickCallbackWrapper({h: $hour, m: $minutes, d: i, entity: i})\"></zl-planning-line><zl-planning-line ng-if=\"planning.mode === \\'week\\'\" zoom=planning.zoom ng-repeat=\"day in planning.usableDays\" day-start=planning._dayStart day-end=planning._dayEnd class=\"day b-b\" ng-class=\"{today: planning.isToday(planning.keys(planning.sortedEvents)[day])}\" events=planning.getEvents(planning.keys(planning.sortedEvents)[day]) drop-callback=\"planning.dropEvent({h: $hour, m: $minutes, d: planning.keys(planning.sortedEvents)[day], entity: planning.keys(planning.sortedEvents)[day], $data: $data, $event: $event})\" click-callback=\"planning.clickCallbackWrapper({h: $hour, m: $minutes, d: planning.keys(planning.sortedEvents)[day], entity: planning.keys(planning.sortedEvents)[day]})\"></zl-planning-line></div></div></div></div><div ng-if=\"planning.mode === \\'3day\\'\" style=\"height: 100%;\"><zl-planning-left-column mode=\"\\'day\\'\" position=planning.position day-field=planning.dayField usable-days=planning.allowedDays events=planning.sortedEvents></zl-planning-left-column><div style=\"height: 100%; display: flex; flex-flow: row nowrap;\" zl-horizontal-scroll><div style=height:100%; ng-repeat=\"day in planning.groupedEvents track by $index\"><div style=\"height:100%; display: inline-block;\"><div ng-style=\"{width: planning.width}\" class=planning-body><zl-planning-top-row mode=\"\\'day\\'\" zoom=planning.zoom position=planning.position day-start=planning._dayStart day-end=planning._dayEnd></zl-planning-top-row><p style=\"position: absolute; top: 25px; font-size: 1.5em; font-weight: bold; text-align: center;\">{{day.day}}</p><div class=hour-cursor ng-style=\"{left: planning.currentTimeToPixels()+\\'px\\'}\" ng-if=\"planning.isCurrent() && planning.isInDayRange()\"><div class=hour-caret></div></div><div class=planning-2pc></div><zl-planning-line zoom=planning.zoom position=day.date absences=day.absences[i] day-start=planning._dayStart day-end=planning._dayEnd ng-repeat=\"i in planning.keys(day.value) track by $index\" class=\"day b-b\" events=day.value[i] pauses=planning.entitiesPauses[i] drop-callback=\"planning.dropEvent({h: $hour, m: $minutes, d: i, entity: i, $data: $data, $event: $event, day: day.key})\" click-callback=\"planning.clickCallbackWrapper({h: $hour, m: $minutes, d: i, entity: i})\"></zl-planning-line></div></div></div></div></div><div ng-if=\"planning.mode ===\\'week-advanced\\'\" class=advanced-week><div class=days-list><div class=day-advanced>&nbsp;</div><div class=day-advanced ng-repeat=\"day in planning.daysList\" ng-click=planning.dayCallback({$day:day})><span class=day-text>{{day | format:\\'dddd\\' | capitalize}}<br><small>{{day | format:\\'ll\\'}}</small></span></div></div><div class=advanced-week-container ng-repeat=\"name in planning.keys(planning.sortedEvents)\"><div class=left-column-advanced><span style=margin:auto>{{name}}</span></div><div ng-repeat=\"day in planning.allowedDays\" class=day-advanced><zl-planning-vertical-line day=planning.daysList[$index] zoom=planning.zoom drop-callback=\"planning.dropEvent({h: $hour, m: $minutes, d:day, entity: name, $data: $data, $event: $event})\" day-start=planning._dayStart day-end=planning._dayEnd events=planning.getEvents(name)[day] pauses=planning.entitiesPauses[name] absences=planning.absences[name] click-callback=\"planning.clickCallbackWrapper({h: $hour, m: $minutes, d: day, entity: name})\"></zl-planning-vertical-line></div></div></div><div ng-if=\"planning.mode === \\'month\\'\" style=\"height: 100%; z-index: 1000;\"><div class=month-header><span class=month-text>{{planning.month | capitalize}}</span></div><div class=day-header><div class=day ng-repeat=\"day in []|range:7\"><span class=day-text>{{day | day}}</span></div></div><div class=month-container><zl-planning-day ng-repeat=\"day in planning.days\" day=day events=planning._events absences=planning.absences drop-callback=\"planning.dropEvent({$data: $data, $event: $event, moment: day.date})\" ng-dblclick=\"planning.clickWeekEvent(day, $event)\"></zl-planning-day><zl-planning-week-line ng-repeat=\"(week, events) in planning.multipleDaysEvents\" events=events week=week one-day-events=planning.oneDayEvents[week] style=\"height: 20%; pointer-events: none\"></zl-planning-week-line></div></div>');\n$templateCache.put('/directives/planning-left-column/planning-left-column.html','<div class=left-column ng-switch=planningLeftColumn.mode><div class=planning-head></div><div class=left-body><div class=planning-2pc></div><div class=days-body ng-switch-when=week><div class=\"dayName row8 b-b animate\" ng-repeat=\"day in planningLeftColumn.days\" ng-class=\"{today: planning.isToday(day.dayOfYear())}\" ng-click=planning.dayCallback({$day:day})><h4>{{day | format:\\'dddd\\' | capitalize}}<br><small>{{day | format:\\'ll\\'}}</small></h4></div></div><div class=days-body ng-switch-when=day><div class=\"dayName row8 b-b animate\" ng-repeat=\"col in planningLeftColumn.column\"><h4>{{col}}</h4></div></div></div><div style=height:10px></div></div>');\n$templateCache.put('/directives/planning-day-block/planning-day.html','<div class=day-block ng-class=\"{\\'empty-day\\': dayCtrl.isDefined }\" ng-click=planning.dayCallback({$day:dayCtrl.day.date})><div style=position:absolute;left:5px;top:5px; ng-if=\"dayCtrl.day.date.day() === 1\">{{dayCtrl.day.date.week()}}</div><div class=day-number>{{ dayCtrl.day.date.date() }}</div><div class=events-container><div ng-style=\"{\\'background-color\\': event.color}\" class=month-event ng-repeat=\"event in dayCtrl.day.events |limitTo:5\">{{event.title}}</div></div><div class=absents-container tooltip-append-to-body=true ng-if=dayCtrl.absents.length uib-tooltip-html=dayCtrl.absentsString>{{dayCtrl.absents.length}} absent(s)</div></div>');\n$templateCache.put('/directives/planning-line/planning-line.html','<div style=\"z-index: 1;\" zl-planning-drag-drop zl-drop=\"line.dropEvent($data, $event)\"><div class=\"b-b b-r all-day day-hour\" ng-style=\"{width: line.calcWidth(line.zoom)}\" ng-repeat=\"n in [] | range:line.range\" ng-dblclick=\"line.clickEvent(n, $event)\" hour={{n}}><span class=half-hour></span></div></div><div ng-repeat=\"event in line._events\" zl-planning-drag-drop ng-click=\"planning.eventCallback({\\'event\\':event})\" zl-drag=event ng-style=\"{ height: event.style.height, top: event.style.top, width: event.pre > 0 ? line.preEvent[event.id].style.totalWidth : event.style.width, left: event.pre > 0 ? line.preEvent[event.id].style.left : event.style.left }\" style=\"position: absolute; z-index: 1;\"><div ng-if=\"event.pre > 0\" ng-style=\"{width: line.preEvent[event.id].percentage, \\'background\\': line.preEvent[event.id].style[\\'background\\']}\" style=\"display: inline-block; position: relative; height: 100%; text-align: center; color: white; border: 1px lightgrey solid; border-right: none;\" class=pre-event tooltip-append-to-body=true uib-tooltip={{line.preEvent[event.id].tooltip}}><div class=title-container><span><i style=\"height: 100%; font-size: 1.2em;\" class=\"mdi mdi-car\"></i></span></div></div><div class=event style=\"display: inline-block; position: relative; height: 100%;\" data-context-menu=/templates/planning-context-menu.html tooltip-append-to-body=true tooltip-placement=\"{{event.tooltipTemplate? \\'auto\\': \\'top\\'}}\" ng-attr-uib-tooltip=\"{{!event.tooltipTemplate ? event.tooltip : undefined}}\" ng-attr-uib-tooltip-template=\"{{\\'\\' + event.tooltipTemplate}}\" tooltip-class=planning-event-tooltip ng-style=\"{ width: event.percentage, background: event.style[\\'background-color\\'], \\'background-image\\': event.style[\\'background-image\\'], color: event.style.color, \\'border-left\\': event.pre > 0 ? \\'none\\': \\'\\' }\"><div class=event-line-container style><div class=event-line ng-style=\"{\\'background-color\\': event.color}\" ng-if=!event.continuedBefore></div></div><div class=title-container><span>{{event.title}}</span></div></div></div><div ng-repeat=\"pause in line.breaks track by $index\" class=planning-pause-element style=\"height: 100%;\" ng-style=pause.style></div><div ng-repeat=\"absence in line._absences track by $index\" class=planning-absences uib-tooltip=Absent tooltip-append-to-body=true style=\"height: 100%;\" ng-style=absence.style></div>');\n$templateCache.put('/directives/planning-top-row/planning-top-row.html','<div class=planning-top-row><div ng-repeat=\"hour in planningTopRow.hours\" class=day-hour ng-style=\"{width: planningTopRow.calcWidth(planningTopRow.zoom), margin: planningTopRow.calcMargin(planningTopRow.zoom, $index)}\"><h4>{{hour | format:\\'HH:mm\\'}}</h4></div></div>');\n$templateCache.put('/directives/planning-vertical-line/planning-vertical-line.html','<div ng-style=\"{height: line.containerHeight}\"><div style=\"position: absolute; height: 100%; width: 100%; z-index: 1;\" zl-planning-drag-drop zl-drop=\"line.dropEvent($data, $event)\"><div class=\"b-b b-r all-day\" ng-style=\"{height: line.calcWidth(line.zoom)}\" ng-repeat=\"n in [] | range: line.range\" ng-dblclick=\"line.clickEvent(n, $event)\" hour=\"{{n + line.dayStart.h}}\"><span class=hour-text>{{n + 1 + line.dayStart.h}}</span></div></div><div ng-repeat=\"event in line._events\" zl-planning-drag-drop ng-click=\"planning.eventCallback({\\'event\\':event})\" zl-drag=event ng-style=\"{ width: event.style.height, right: event.style.top, height: event.pre > 0 ? line.preEvent[event.id].style.totalWidth : event.style.width, top: event.pre > 0 ? line.preEvent[event.id].style.left : event.style.left }\" style=\"position: absolute; z-index: 1;\"><div ng-if=\"event.pre > 0\" ng-style=\"{height: line.preEvent[event.id].percentage, \\'background\\': line.preEvent[event.id].style[\\'background\\']}\" style=\"display: inline-block; position: relative; width: 100%; text-align: center; color: white; border: 1px lightgrey solid; border-right: none;\" class=pre-event tooltip-append-to-body=true uib-tooltip={{line.preEvent[event.id].tooltip}}><div class=title-container><span><i style=\"width: 100%; font-size: 1.2em;\" class=\"mdi mdi-car\"></i></span></div></div><div class=event style=\"display: inline-block; position: relative; width: 100%;\" tooltip-append-to-body=true tooltip-placement=\"{{event.tooltipTemplate? \\'auto\\': \\'top\\'}}\" ng-attr-uib-tooltip=\"{{!event.tooltipTemplate ? event.tooltip : undefined}}\" ng-attr-uib-tooltip-template=\"{{\\'\\' + event.tooltipTemplate}}\" tooltip-class=planning-event-tooltip data-context-menu=/templates/planning-context-menu.html ng-style=\"{ height: event.percentage, \\'background-image\\': event.style[\\'background-image\\'], background: event.style[\\'background-color\\'], color: event.style.color, \\'border-left\\': event.pre > 0 ? \\'none\\': \\'\\' }\"><div class=event-line-container style><div class=event-line ng-style=\"{\\'background-color\\': event.color}\" ng-if=!event.continuedBefore></div></div><div class=title-container><span>{{event.title}}</span></div></div></div><div ng-repeat=\"pause in line.breaks track by $index\" class=planning-pause-element style=\"width: 95%; left: 5%;\" ng-style=pause.style></div><div ng-repeat=\"absence in line._absences track by $index\" class=planning-absences uib-tooltip=Absent tooltip-append-to-body=true style=\"width: 95%; left: 5%;\" ng-style=absence.style></div></div>');\n$templateCache.put('/directives/planning-week-line/planning-week-line.html','<div class=week-line ng-class=\"\\'week-\\' + line.week\" style=padding-top:20px;><div class=single-day-events style=\"height:40%; position:relative;\"><div zl-planning-drag-drop zl-drag=ev ng-repeat=\"ev in line.oneDayEvents\" ng-style=\"{\\'top\\': ev.style.top, \\'height\\': ev.style.height, \\'background-color\\': ev.style[\\'background-color\\'], \\'color\\' : ev.style.color, \\'width\\': ev.style.width, \\'left\\': ev.style.left}\" style=\"position:absolute;border: 1px solid black;pointer-events: auto; overflow: hidden;\" ng-click=\"planning.weekEventCallback({event: ev})\" tooltip-append-to-body=true tooltip-placement=\"{{ev.tooltipTemplate? \\'auto\\': \\'top\\'}}\" ng-attr-uib-tooltip=\"{{!ev.tooltipTemplate ? ev.tooltip : undefined}}\" ng-attr-uib-tooltip-template=\"{{\\'\\' + ev.tooltipTemplate}}\" tooltip-class=planning-event-tooltip class=single-day-event><div class=event-line-container><div class=event-line ng-style=\"{\\'background-color\\': ev.color}\" ng-if=!ev.continuedBefore></div></div><div class=single-day-event-title data-context-menu=/templates/planning-context-menu.html><span>{{ev.title}}</span></div></div></div><div class=multiple-days-events style=\"height:40%; position: relative;\"><div class=multiple-day-event ng-repeat=\"event in line.displayedEvents\" style=\"position: absolute; border: 1px solid black;pointer-events: auto; overflow: hidden;\" zl-planning-drag-drop zl-drag=event ng-click=\"planning.weekEventCallback({event: event})\" tooltip-append-to-body=true tooltip-placement=\"{{event.tooltipTemplate? \\'auto\\': \\'top\\'}}\" ng-attr-uib-tooltip=\"{{!event.tooltipTemplate ? event.tooltip : undefined}}\" ng-attr-uib-tooltip-template=\"{{\\'\\' + event.tooltipTemplate}}\" tooltip-class=planning-event-tooltip ng-style=\"{\\'top\\': event.style.top, \\'height\\': event.style.height, \\'background-color\\': event.style[\\'background-color\\'], \\'color\\' : event.style.color, \\'width\\': event.style.width, \\'left\\': event.style.left}\"><div class=event-line-container><div class=event-line ng-style=\"{\\'background-color\\': event.color}\" ng-if=!event.continuedBefore></div></div><div class=multiple-day-event-title data-context-menu=/templates/planning-context-menu.html><span>{{event.title}}</span></div></div></div></div>');}]);"]}