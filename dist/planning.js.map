{"version":3,"sources":["index.js","template.js","filters/filters/dayFilter.js","filters/filters/momentFilter.js","filters/filters/range.js","filters/filters/strFilter.js","services/services/absences.service.js","services/services/color.service.js","services/services/configurationProvider.js","services/services/holidays.service.js","services/services/pause.service.js","services/services/position.service.js","directives/drag-drop/directives/drag-drop/drag-drop.directive.js","directives/horizontal-scroll/directives/horizontal-scroll/horizontal-scroll.js","directives/planning/directives/planning/planning.js","directives/planning-day-block/directives/planning-day-block/planning-day.js","directives/planning-left-column/directives/planning-left-column/planning-left-column.js","directives/planning-line/directives/planning-line/planning-line.js","directives/planning-top-row/directives/planning-top-row/planning-top-row.js","directives/planning-vertical-line/directives/planning-vertical-line/planning-vertical-line.js","directives/planning-week-line/directives/planning-week-line/planning-week-line.js"],"names":["window","angular","module","run","$templateCache","put","filter","day","isNaN","parseInt","time","format","str","charAt","toUpperCase","slice","input","total","i","push","planningConfiguration","val","strings","_","moment","service","extend","this","parseAbsences","absences","interval","Array","isArray","mergeRanges","ranges","copy","map","r","index","Object","assign","any","range1","range2","range","start","end","overlaps","reduced","reduce","acc","value","arr","next","min","max","abs","absence","style","isSame","top","isBefore","isAfter","Error","ColorService","getLuminance","c","g","rgbRegex","b","test","exec","color","substring","rgb","$inject","provider","self","BASE_SIZE","MAX_PARALLEL","nothing_to_show","DAYS","parallelText","setParallelText","text","setBaseSize","size","setMaxParallel","number","setString","key","setDays","$get","absentTechnicianCallback","callback","isFerieCallback","warningCallback","solidarityDays","masterDayRange","aliaCompanySettings","showSolidarityDay","isSolidarityDay","let","bool","get","parsedDay","forEach","solidarityDay","master","masterDay","elt","date","rule","length","unix","endOf","PauseService","padZero","len","join","generateGradient","event","direction","pauseColor","hex","indexOf","toString","totalRange","totalDuration","diff","mapped","pauses","pause","pauseRange","percentage","before","clone","subtract","endPercentage","v","startPercentage","PositionService","overlap","lines","maxParallelEvents","toRemove","doublecheck","pre","depth","eventClone","each","eltRange","line","eventList","technician","cloneDeep","directive","controller","scope","controllerAs","bindToController","zlDrag","zlDrop","link","element","seen","dragImage","document","createElement","el","dragStartEvent","e","height","clientHeight","zIndex","position","left","bottom","innerHTML","children","float","backgroundColor","width","clientWidth","Math","dataTransfer","effectAllowed","body","appendChild","setDragImage","querySelectorAll","remove","setData","JSON","stringify","dragDropCtrl","classList","add","dropEvent","$apply","$data","parse","getData","$event","target","stopPropagation","dragEnterEvent","dragLeaveEvent","IntersectionObserver","entries","observer","isIntersecting","attributes","draggable","addEventListener","removeEventListener","threshold","observe","ScrollHorizontalDirective","$timeout","restrict","scrollLeft","bind","wheelDelta","addClass","offsetWidth","PlanningController","$scope","HolidaysServicePlanning","init","zoom","allowedDays","usableDays","sort","daysList","d","weekday","_dayStart","dayStart","parseTime","_dayEnd","dayEnd","h","sortedEvents","undefined","mode","_events","flatten","events","split","groupBy","startingDay","times","newDate","dayField","mapValues","eventsByTechnician","entities","keys","groupedEvents","startOf","k","result","toDate","hour","minute","m","second","stop","days","j","isEmpty","includes","obj","find","group","sortBy","firstDay","hours","minutes","seconds","endWeek","month","decallage","isoWeekday","oneDayEvents","dayOfYear","floor","multipleDaysEvents","splitByWeeks","isoWeek","startWeek","weekInMonth","isoWeeksInYear","unshift","daysInMonth","n","displayedDaysCount","getName","id","entitiesName","_id","fullname","first_event","startNextDay","endThisDay","continuedAfter","second_event","continuedBefore","concat","firstEvent","st","year","secondEvent","some","isBetween","a","dateFromString","getEvents","isToday","week","isFerie","holidays","holiday","hasAbsence","_absences","contains","isInDayRange","currentTimeToPixels","totalMinutes","isCurrent","clickCallbackWrapper","opts","entity","mom","Date","clickCallback","$moment","$entity","clickWeekEvent","showAbsencesCallBackWrapper","showAbsencesCallback","$absences","$day","config","doy","dropCallback","dateSplitted","dayEvent","move","moveAction","$element","duplicateAction","isInRange","beginAt","dateSumInterval","interventionShowInterval","showInterval","$onInit","$watchCollection","templateUrl","entitiesPauses","eventCallback","dayCallback","weekEventCallback","action","PlanningDayController","data","ids","array","absents","isDefined","within","absentsString","replace","preventDefault","dayCtrl","PlanningLeftColumnController","threeDays","activateDuplicationButtons","column","triggerDayEvent","PlanningLineController","AbsenceService","setAbsenceTooltip","state","absenceType","userName","user","confirmation","extractMinutesFromEvent","offsetX","hoverAbsence","tooltip","iterator","getElementsByClassName","leaveAbsence","getAttribute","dayOfWeek","checkAbsence","checkFerie","$hour","$minutes","clickEvent","currentId","preEvent","postEvent","breaks","SECONDS_BY_DAY","SLIDER_WIDTH","valueOf","toremove","difference","title","round","s","totalWidth","text-align","background","border-top","border-bottom","border-left","post","postPercentage","safeParse","compact","p","name","calcWidth","newValue","oldValue","class","log","string","topRowDirective","calcMargin","half","$watchGroup","$filter","$rootScope","AVAILABLE_SPACE","offsetY","leaveLine","containerHeight","$on","$broadcast","tempTop","tempHeight","calculateWidth","calculateLeft","displayedEvents","positioning","setStyle","ceil"],"mappings":"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","file":"planning.js","sourcesContent":[";(function (angular) {\n  'use strict'\n\n  angular\n    .module('90Tech.planning', ['pikaday', 'zlContextMenu'])\n})(window.angular)\n","angular.module('90Tech.planning').run(['$templateCache', function($templateCache) {$templateCache.put('/templates/planning-context-menu.html','<ul class=\"dropdown-menu context-menu\" ng-click=$event.stopPropagation(); style=\"z-index: 10\"><li ng-if=\"!event.eventList.length && !ev.eventList.length\"><a ng-click=\"planning.action({$element: event || ev})\"><i class=\"mdi mdi-chevron-down\"></i> Ouvrir dans un nouvel onglet {{event.eventList.length}}</a></li><li ng-if=\"!event.eventList.length && !ev.eventList.length\"><a ng-click=\"planning.duplicateAction({$element: event || ev})\"><i class=\"mdi mdi-chevron-down\"></i> Dupliquer l\\'intervention {{event.eventList.length}}</a></li></ul>');\n$templateCache.put('/templates/planning-line-context-menu.html','<ul class=\"dropdown-menu context-menu\" ng-click=$event.stopPropagation(); style=\"z-index: 10\"><li ng-if=\"!event.eventList.length && !ev.eventList.length\"><a ng-click=\"planning.dayEvent(line._events, false)\"><i class=\"mdi mdi-chevron-down\"></i> Dupliquer la journ\\xE9e {{event.eventList.length}}</a></li><li ng-if=\"!event.eventList.length && !ev.eventList.length\"><a ng-click=\"planning.dayEvent(line._events, true)\"><i class=\"mdi mdi-chevron-down\"></i> D\\xE9placer la journ\\xE9e {{event.eventList.length}}</a></li></ul>');\n$templateCache.put('/directives/planning/planning.html','<div ng-if=\"planning.mode ===\\'day\\' || planning.mode === \\'week\\'\" style=\"height: 100%;\"><zl-planning-left-column mode=planning.mode position=planning.position day-field=planning.dayField entities-name=planning.entitiesName , usable-days=planning.allowedDays day-event=planning.dayEvent move-action=planning.moveAction show-absences-callback=\"planning.showAbsencesCallBackWrapper({absences: absences, day: day})\" events=planning.sortedEvents absences=planning.absences is-ferie=planning.isFerie(planning.position)></zl-planning-left-column><div class style=height:100%><div zl-horizontal-scroll scroll-left=planning.currentTimeToPixels() style=height:100%><div ng-style=\"{width: planning.width}\" class=planning-body><zl-planning-top-row mode=planning.mode zoom=planning.zoom position=planning.position holidays=planning.holidays day-start=planning._dayStart day-end=planning._dayEnd></zl-planning-top-row><div class=hour-cursor ng-style=\"{left: planning.currentTimeToPixels()+\\'px\\'}\" ng-if=\"planning.isCurrent() && planning.isInDayRange()\"><div class=hour-caret></div></div><div ng-if=planning.isFerie(planning.position)></div><div class=planning-2pc ng-class=\"{ isFerie: (planning.mode === \\'day\\' && planning.isFerie(planning.position)), isSolidarityDay: (planning.mode === \\'day\\' && planning.isSolidarityDay(planning.position))}\"></div><zl-planning-line ng-if=\"planning.mode === \\'day\\'\" zoom=planning.zoom absences=planning.absences[i] position=planning.position day-start=planning._dayStart day-end=planning._dayEnd ng-repeat=\"i in planning.keys(planning.sortedEvents)\" class=\"day b-b\" ng-class=\"{today: planning.isToday(i)}\" events=planning.getEvents(i) pauses=planning.entitiesPauses[i][0] holidays=planning.holidays drop-callback=\"planning.dropEvent({h: $hour, m: $minutes, d: i, entity: i, $data: $data, $event: $event})\" click-callback=\"planning.clickCallbackWrapper({h: $hour, m: $minutes, d: i, entity: i})\"></zl-planning-line><zl-planning-line ng-if=\"planning.mode === \\'week\\'\" zoom=planning.zoom ng-repeat=\"day in planning.usableDays\" position=planning.position entities=planning.entities day-of-week=planning.daysList[day] mode=planning.mode holidays=planning.holidays day-start=planning._dayStart day-end=planning._dayEnd class=\"day b-b\" ng-class=\"{today: planning.isToday(planning.keys(planning.sortedEvents)[day])}\" events=planning.getEvents(planning.keys(planning.sortedEvents)[day]) drop-callback=\"planning.dropEvent({h: $hour, m: $minutes, d: planning.keys(planning.sortedEvents)[day], entity: planning.keys(planning.sortedEvents)[day], $data: $data, $event: $event})\" click-callback=\"planning.clickCallbackWrapper({h: $hour, m: $minutes, d: planning.keys(planning.sortedEvents)[day], entity: planning.keys(planning.sortedEvents)[day]})\"></zl-planning-line></div></div></div></div><div ng-if=\"planning.mode === \\'3day\\'\" style=\"height: 100%;\"><zl-planning-left-column mode=\"\\'day\\'\" three-days=true position=planning.position entities-name=planning.entitiesName day-field=planning.dayField usable-days=planning.allowedDays events=planning.sortedEvents></zl-planning-left-column><div style=\"height: 100%; display: flex; flex-flow: row nowrap;\" zl-horizontal-scroll><div style=height:100%; ng-repeat=\"day in planning.groupedEvents track by $index\"><div style=\"height:100%; display: inline-block;\"><div ng-style=\"{width: planning.width}\" class=planning-body><zl-planning-top-row mode=\"\\'day\\'\" zoom=planning.zoom position=planning.position day-start=planning._dayStart day-end=planning._dayEnd></zl-planning-top-row><p style=\"position: absolute; top: 27px; font-size: 1.4em; font-weight: bold; width: 100%; padding-left: 5px;\" ng-class=\"{isFerie: planning.isFerie(day.date), isSolidarityDay: planning.isSolidarityDay(day.date)}\">{{day.day}} <span class=holidays ng-if=planning.isFerie(day.date)>f\\xE9ri\\xE9</span> <span class=solidarityDay ng-if=planning.isSolidarityDay(day.date)>Journ\\xE9e de solidarit\\xE9</span></p><div class=hour-cursor ng-style=\"{left: planning.currentTimeToPixels()+\\'px\\'}\" ng-if=\"planning.isCurrent() && planning.isInDayRange()\"><div class=hour-caret></div></div><div class=planning-2pc></div><zl-planning-line zoom=planning.zoom position=day.date absences=day.absences[i] day-start=planning._dayStart day-end=planning._dayEnd ng-repeat=\"i in planning.keys(day.value) track by $index\" class=\"day b-b\" events=day.value[i] pauses=planning.entitiesPauses[i][$parent.$index] holidays=planning.holidays drop-callback=\"planning.dropEvent({h: $hour, m: $minutes, d: i, entity: i, $data: $data, $event: $event, day: day.key})\" click-callback=\"planning.clickCallbackWrapper({h: $hour, m: $minutes, d: i, entity: i})\" is-solidarity-day=planning.isSolidarityDay></zl-planning-line></div></div></div></div></div><div ng-if=\"planning.mode ===\\'week-advanced\\'\" class=advanced-week><div class=days-list><div class=day-advanced>&nbsp;</div><div class=day-advanced ng-repeat=\"day in planning.daysList\" ng-click=planning.dayCallback({$day:day}) ng-class=\"{isFerie: planning.isFerie(day), isSolidarityDay: planning.isSolidarityDay(day)}\"><span class=day-text>{{day | format:\\'dddd\\' | capitalize}}<br><small>{{day | format:\\'ll\\'}}</small> <span class=holidays ng-if=planning.isFerie(day)>f\\xE9ri\\xE9</span> <span class=solidarityDay ng-if=planning.isSolidarityDay(day)>Journ\\xE9e de solidarit\\xE9</span></span></div></div><div class=advanced-week-container ng-repeat=\"name in planning.keys(planning.sortedEvents)\"><div class=left-column-advanced><span style=margin:auto>{{planning.getName(name)}}</span></div><div ng-repeat=\"day in planning.allowedDays\" style=\"overflow: hidden;\" class=day-advanced><zl-planning-vertical-line day=planning.daysList[$index] zoom=planning.zoom drop-callback=\"planning.dropEvent({h: $hour, m: $minutes, d:day, entity: name, $data: $data, $event: $event})\" day-start=planning._dayStart day-end=planning._dayEnd is-in-range=planning.isInRange(planning.daysList[$index]) events=planning.getEvents(name)[day] pauses=planning.entitiesPauses[name][$index] absences=planning.absences[name] holidays=planning.holidays click-callback=\"planning.clickCallbackWrapper({h: $hour, m: $minutes, d: day, entity: name})\" is-solidarity-day-scoped=planning.isSolidarityDay></zl-planning-vertical-line></div></div></div><div ng-if=\"planning.mode === \\'month\\'\" style=\"height: 100%; z-index: 1000;\"><div class=month-header><span class=month-text>{{planning.month | capitalize}}</span></div><div class=day-header><div class=day ng-repeat=\"day in []|range:7\"><span class=day-text>{{day | day}}</span></div></div><div class=month-container><zl-planning-day ng-repeat=\"day in planning.days\" day=day events=planning._events absences=planning.absences drop-callback=\"planning.dropEvent({$data: $data, $event: $event, moment: day.date})\" entities=planning.entitiesName ng-dblclick=\"planning.clickWeekEvent(day, $event)\" holidays=planning.holidays></zl-planning-day><zl-planning-week-line ng-repeat=\"(week, events) in planning.multipleDaysEvents\" events=events week=week one-day-events=planning.oneDayEvents[week] style=\"height: 20%; pointer-events: none\"></zl-planning-week-line></div></div>');\n$templateCache.put('/directives/planning-day-block/planning-day.html','<div class=day-block ng-class=\"{\\'empty-day\\': dayCtrl.isDefined }\" ng-click=planning.dayCallback({$day:dayCtrl.day.date})><div style=position:absolute;left:5px;top:5px; ng-if=\"dayCtrl.day.date.day() === 1\">{{dayCtrl.day.date.week()}}</div><div class=day-number>{{ dayCtrl.day.date.date() }}</div><span ng-if=dayCtrl.isFerie class=holidays>f\\xE9ri\\xE9</span> <span class=solidarityDay ng-if=dayCtrl.isSolidarityDay(day.date)>Journ\\xE9e de solidarit\\xE9</span><div class=events-container><div ng-style=\"{\\'background-color\\': event.color}\" class=month-event ng-repeat=\"event in dayCtrl.day.events |limitTo:5\">{{event.title}}</div></div><div class=absents-container tooltip-append-to-body=true ng-if=dayCtrl.absents.length uib-tooltip-html=dayCtrl.absentsString>{{dayCtrl.absents.length}} absent(s)</div></div>');\n$templateCache.put('/directives/planning-left-column/planning-left-column.html','<div class=\"left-column planning-left-column\" ng-switch=planningLeftColumn.mode><div class=planning-head></div><div class=left-body><div class=planning-2pc><span class=holidays ng-if=\"planningLeftColumn.isFerie && !planningLeftColumn.isSolidarityDay(planningLeftColumn.position) && (planningLeftColumn.mode === \\'day\\' || planningLeftColumn.mode === \\'3days\\')\">F\\xE9ri\\xE9</span> <span class=solidarityDay style=margin-top:1px!important; ng-if=\"planningLeftColumn.isSolidarityDay(planningLeftColumn.position) && (planningLeftColumn.mode === \\'day\\' || planningLeftColumn.mode === \\'3days\\')\">Journ\\xE9e de solidarit\\xE9</span></div><div class=days-body ng-switch-when=week><div class=\"dayName row8 b-b animate\" ng-repeat=\"day in planningLeftColumn.days track by $index\" ng-class=\"{today: (planning.isToday(day.dayOfYear())), isFerie: planning.isFerie(day)}\" ng-click=planning.dayCallback({$day:day})><h4>{{day | format:\\'dddd\\' | capitalize}}<br><small>{{day | format:\\'ll\\'}}<span class=holidays ng-if=planning.isFerie(day)>f\\xE9ri\\xE9</span></small></h4><div ng-click=$event.stopPropagation() class=day-absence ng-if=planningLeftColumn._absences[$index].length><div class=absents-container ng-click=\"planning.showAbsencesCallBackWrapper(planningLeftColumn._absences, $index)\">{{ planningLeftColumn._absences[$index].length }} absent(s)</div></div></div></div><div class=days-body ng-switch-when=day><div class=\"dayName dayNameDuplication row8 b-b animate\" ng-if=planningLeftColumn.activateDuplicationButtons uib-popover-template=\"\\'planningDayPopOver.html\\'\" popover-placement=right ng-repeat=\"tech in planningLeftColumn.column\"><h4 class=techname>{{tech.fullname || \\'\\'}}</h4></div><div class=\"dayName row8 b-b animate\" ng-if=!planningLeftColumn.activateDuplicationButtons uib-popover-template=\"\\'planningDayPopOver.html\\'\" popover-placement=right ng-repeat=\"tech in planningLeftColumn.column\"><h4 class=techname>{{tech.fullname || \\'\\'}}</h4></div></div></div><script type=text/ng-template id=planningDayPopOver.html><button ng-if=\"planningLeftColumn.activateDuplicationButtons\" class=\"btn btn-primary\" style=\"width: 100%; margin-bottom: 5px;\" ng-click=\\'planningLeftColumn.triggerDayEvent(tech)\\'>Dupliquer la journ\\xE9e</button> <button ng-if=\"planningLeftColumn.activateDuplicationButtons\" class=\"btn btn-primary\" style=\"width: 100%;\" ng-click=\\'planningLeftColumn.triggerDayEvent(tech, true)\\'>D\\xE9placer la journ\\xE9e</button></script><div style=height:10px></div></div>');\n$templateCache.put('/directives/planning-line/planning-line.html','<div ng-style=\"{height: line.containerHeight}\"><div style=\"position: absolute; height: 100%; width: 100%; z-index: 1\" zl-planning-drag-drop zl-drop=\"line.dropEvent($data, $event, line)\"><div class=\"b-b b-r all-day day-hour\" ng-dblclick=\"line.clickEvent(n, $event, line)\" ng-mouseleave=line.leaveAbsence() uib-tooltip={{line.tooltip}} tooltip-append-to-body=true tooltip-placement=top ng-style=\"{width: line.calcWidth(line.zoom)}\" ng-repeat=\"n in [] | range:line.range\" hour={{n}}><span class=half-hour></span></div></div><div ng-repeat=\"absence in line._absences track by $index\" ng-mouseenter=line.hoverAbsence(absence) id={{absence._id}} class=\"{{absence.class}} absence {{absence._id}}\" tooltip-append-to-body=true tooltip-placement=top uib-tooltip={{absence.tooltip}} data-html=true style=\"height: 100%\" ng-style=absence.style></div><div ng-repeat=\"event in line._events\" zl-planning-drag-drop ng-click=\"planning.eventCallback({\\'event\\':event})\" zl-drag=event ng-style=\"{ height: event.style.height, top: event.style.top, width: event.style.totalWidth, left: event.pre > 0 ? line.preEvent[event.id].style.left : event.style.left }\" style=\"position: absolute; z-index: 3; display: flex; flex-flow: row nowrap\"><div ng-if=\"event.pre > 0\" ng-style=\"{width: line.preEvent[event.id].style.width, \\'background\\': line.preEvent[event.id].style[\\'background\\']}\" style=\"display: inline-block; position: relative; height: 100%; text-align: center; color: white; border: 1px lightgrey solid; border-right: none;\" class=pre-event tooltip-append-to-body=true uib-tooltip={{line.preEvent[event.id].tooltip}}><div class=title-container><span><i style=\"height: 100%; font-size: 1.2em;\" class=\"mdi mdi-car\"></i></span></div></div><div class=event style=\"display: inline-block; position: relative; height: 100%;\" data-context-menu=/templates/planning-context-menu.html tooltip-append-to-body=true tooltip-placement=\"{{event.tooltipTemplate? \\'auto\\': \\'top\\'}}\" ng-attr-uib-tooltip=\"{{!event.tooltipTemplate ? event.tooltip : undefined}}\" ng-attr-uib-tooltip-template=\"{{\\'\\' + event.tooltipTemplate}}\" tooltip-class=planning-event-tooltip ng-style=\"{ width: event.style.width, background: event.style[\\'background-color\\'], \\'background-image\\': event.style[\\'background-image\\'], color: event.style.color, \\'border-left\\': event.pre > 0 ? \\'none\\': \\'\\' }\"><div class=event-line-container style><div class=event-line ng-style=\"{\\'background-color\\': event.color}\" ng-if=!event.continuedBefore></div></div><div class=title-container><span>{{event.title}}</span></div></div><div ng-if=\"event.post > 0\" ng-style=\"{width: line.postEvent[event.id].style.width, \\'background\\': line.postEvent[event.id].style[\\'background\\']}\" style=\"display: inline-block; position: relative; height: 100%; text-align: center; color: white; border: 1px lightgrey solid; border-right: none;\" class=pre-event tooltip-append-to-body=true uib-tooltip={{line.postEvent[event.id].tooltip}}><div class=title-container><span><i style=\"height: 100%; font-size: 1.2em;\" class=\"mdi mdi-car\"></i></span></div></div></div><div ng-repeat=\"pause in line.breaks track by $index\" class=planning-pause-element style=\"height: 100%;\" ng-style=pause.style></div></div>');\n$templateCache.put('/directives/planning-top-row/planning-top-row.html','<div class=planning-top-row><div ng-repeat=\"hour in planningTopRow.hours\" class=day-hour ng-style=\"{width: planningTopRow.calcWidth(planningTopRow.zoom), margin: planningTopRow.calcMargin(planningTopRow.zoom, $index)}\"><h4>{{hour | format:\\'HH:mm\\'}}</h4></div></div>');\n$templateCache.put('/directives/planning-vertical-line/planning-vertical-line.html','<div ng-style=\"{height: line.containerHeight}\" data-context-menu=/templates/planning-line-context-menu.html><div ng-if=!line._absences style=\"position: absolute; height: 100%; width: 100%; z-index: 1\" ng-mouseleave=line.leaveLine()><div ng-repeat=\"n in [] | range: line.range\" style=\"display: flex; z-index: 1\"><div style=\"display: flex; align-items: flex-end;\"><span class=hour-text>{{n + 1 + line.dayStart.h}}</span></div><div style=\"width: 100%;\" class=\"b-b b-r all-day\" ng-style=\"{height: line.calcWidth(line.zoom)}\" ng-dblclick=\"line.clickEvent(n, $event, line.day)\" hour=\"{{n + line.dayStart.h}}\" zl-planning-drag-drop zl-drop=\"line.dropEvent($data, $event, line.day)\"></div></div></div><div ng-if=line._absences tooltip-append-to-body=true tooltip-placement=top tooltip-classes=absence-tooltip uib-tooltip={{line._absences[0].tooltip}} ng-class=\"{\\'no-notification\\': !line.isInRange}\" style=\"position: absolute; height: 100%; width: 100%; z-index: 1\" ng-mouseleave=line.leaveLine()><div ng-repeat=\"n in [] | range: line.range\" style=\"display: flex; z-index: 1\"><div style=\"display: flex; align-items: flex-end;\"><span class=hour-text>{{n + 1 + line.dayStart.h}}</span></div><div style=\"width: 100%;\" class=\"b-b b-r all-day\" ng-style=\"{height: line.calcWidth(line.zoom)}\" ng-dblclick=\"line.clickEvent(n, $event, line.day)\" hour=\"{{n + line.dayStart.h}}\" zl-planning-drag-drop zl-drop=\"line.dropEvent($data, $event, line.day)\"></div></div></div><div ng-repeat=\"event in line._events\" zl-planning-drag-drop ng-click=\"planning.eventCallback({\\'event\\':event})\" zl-drag=event ng-style=\"{ width: event.style.height, right: event.style.top, height: event.pre > 0 ? line.preEvent[event.id].style.totalWidth : event.style.width, top: event.pre > 0 ? line.preEvent[event.id].style.left : event.style.left }\" style=\"position: absolute; z-index: 2;\"><div ng-if=\"event.pre > 0\" ng-style=\"{height: line.preEvent[event.id].style.width, \\'background\\': line.preEvent[event.id].style[\\'background\\']}\" style=\"display: flex; position: relative; width: 100%; text-align: center; color: white; border: 1px lightgrey solid; border-right: none;\" class=pre-event tooltip-append-to-body=true uib-tooltip={{line.preEvent[event.id].tooltip}}><div class=title-container><span><i style=\"width: 100%; font-size: 1.2em;\" class=\"mdi mdi-car\"></i></span></div></div><div class=event style=\"display: flex; position: relative; width: 100%;\" tooltip-append-to-body=true tooltip-placement=\"{{event.tooltipTemplate? \\'auto\\': \\'top\\'}}\" ng-attr-uib-tooltip=\"{{!event.tooltipTemplate ? event.tooltip : undefined}}\" ng-attr-uib-tooltip-template=\"{{\\'\\' + event.tooltipTemplate}}\" tooltip-class=planning-event-tooltip data-context-menu=/templates/planning-context-menu.html ng-style=\"{ height: event.style.width, overflow: \\'hidden\\', \\'background-image\\': event.style[\\'background-image\\'], background: event.style[\\'background-color\\'], color: event.style.color, \\'border-left\\': event.pre > 0 ? \\'none\\': \\'\\' }\"><div class=event-line-container style><div class=event-line ng-style=\"{\\'background-color\\': event.color}\"></div></div><div class=title-container><span>{{event.title}}</span></div></div><div ng-if=\"event.post > 0\" ng-style=\"{height: line.postEvent[event.id].style.width, \\'background\\': line.postEvent[event.id].style[\\'background\\']}\" style=\"display: inline-block; position: relative; width: 100%; text-align: center; color: white; border: 1px lightgrey solid; border-right: none;\" class=pre-event tooltip-append-to-body=true uib-tooltip={{line.postEvent[event.id].tooltip}}><div class=title-container><span><i style=\"width: 100%; font-size: 1.2em;\" class=\"mdi mdi-car\"></i></span></div></div></div><div ng-repeat=\"pause in line.breaks track by $index\" class=planning-pause-element style=\"width: 95%; left: 5%;\" ng-style=pause.style></div><div ng-repeat=\"absence in line._absences track by $index\" id={{absence._id}} class=\"{{absence.class}} absence {{absence._id}}\" style=\"width: 95%; left: 5%;\" ng-style=absence.style></div></div>');\n$templateCache.put('/directives/planning-week-line/planning-week-line.html','<div class=week-line ng-class=\"\\'week-\\' + line.week\" style=padding-top:20px;><div class=single-day-events style=\"height:40%; position:relative;\"><div zl-planning-drag-drop zl-drag=ev ng-repeat=\"ev in line.oneDayEvents\" ng-style=\"{\\'top\\': ev.style.top, \\'height\\': ev.style.height, \\'background-color\\': ev.style[\\'background-color\\'], \\'color\\' : ev.style.color, \\'width\\': ev.style.width, \\'left\\': ev.style.left}\" style=\"position:absolute;border: 1px solid black;pointer-events: auto; overflow: hidden;\" ng-click=\"planning.weekEventCallback({event: ev})\" tooltip-append-to-body=true tooltip-placement=\"{{ev.tooltipTemplate? \\'auto\\': \\'top\\'}}\" ng-attr-uib-tooltip=\"{{!ev.tooltipTemplate ? ev.tooltip : undefined}}\" ng-attr-uib-tooltip-template=\"{{\\'\\' + ev.tooltipTemplate}}\" tooltip-class=planning-event-tooltip class=single-day-event><div class=event-line-container><div class=event-line ng-style=\"{\\'background-color\\': ev.color}\" ng-if=!ev.continuedBefore></div></div><div class=single-day-event-title data-context-menu=/templates/planning-context-menu.html><span>{{ev.title}}</span></div></div></div><div class=multiple-days-events style=\"height:40%; position: relative;\"><div class=multiple-day-event ng-repeat=\"event in line.displayedEvents\" style=\"position: absolute; border: 1px solid black;pointer-events: auto; overflow: hidden;\" zl-planning-drag-drop zl-drag=event ng-click=\"planning.weekEventCallback({event: event})\" tooltip-append-to-body=true tooltip-placement=\"{{event.tooltipTemplate? \\'auto\\': \\'top\\'}}\" ng-attr-uib-tooltip=\"{{!event.tooltipTemplate ? event.tooltip : undefined}}\" ng-attr-uib-tooltip-template=\"{{\\'\\' + event.tooltipTemplate}}\" tooltip-class=planning-event-tooltip ng-style=\"{\\'top\\': event.style.top, \\'height\\': event.style.height, \\'background-color\\': event.style[\\'background-color\\'], \\'color\\' : event.style.color, \\'width\\': event.style.width, \\'left\\': event.style.left}\"><div class=event-line-container><div class=event-line ng-style=\"{\\'background-color\\': event.color}\" ng-if=!event.continuedBefore></div></div><div class=multiple-day-event-title data-context-menu=/templates/planning-context-menu.html><span>{{event.title}}</span></div></div></div></div>');}]);",";(function (angular) {\n  'use strict'\n  angular\n    .module('90Tech.planning')\n    .filter('day', [function () {\n      return function (day) {\n        if (day === undefined || day === null || isNaN(day) || parseInt(day) > 6) return ''\n        return ['Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi', 'Dimanche'][day]\n      }\n    }])\n})(window.angular)\n",";(function (angular) {\n  'use strict'\n\n  angular\n    .module('90Tech.planning')\n    .filter('format', function () {\n      return function (time, format) {\n        return time.format(format)\n      }\n    })\n    .filter('capitalize', function () {\n      return function (str) {\n        if (!str) return ''\n        return str.charAt(0).toUpperCase() + str.slice(1)\n      }\n    })\n})(window.angular)\n","/**\n * WebApp Agenda\n * http://docs.pluginit.fr/agenda\n *\n * Copyright 2014 PluginIT\n * Non permissive commercial License.\n */\n\n;(function (angular) {\n  'use strict'\n\n  angular\n    .module('90Tech.planning')\n    .filter('range', RangeFilter)\n\n  /**\n   * Class Range for emulate a \"for\" loop\n   * @class RangeFilter\n   * @constructor\n   */\n  function RangeFilter () {\n    /**\n     * Return decimal values arrays at wished size\n     * @param input\n     * @param total\n     * @returns {*}\n     */\n    var operation = function (input, total) {\n      // We parse just in case\n      total = parseInt(total)\n\n      // We're adding at empty array the current value for the loop\n      for (var i = 0; i < total; i++) {\n        input.push(i)\n      }\n\n      // We return the array finally\n      return input\n    }\n\n    /**\n     * Return callback to execute RangeFilter\n     */\n    return operation\n  }\n})(window.angular)\n",";(function (angular) {\n  'use strict'\n  angular\n    .module('90Tech.planning')\n    .filter('strPlanning', ['planningConfiguration', function (planningConfiguration) {\n      return function (val) {\n        return planningConfiguration.strings[val]\n      }\n    }])\n})(window.angular)\n",";(function (angular, _, moment) {\n  'use strict'\n  angular.module('90Tech.planning')\n    .service('AbsenceService', AbsenceService)\n\n  function AbsenceService () {\n    var self = this\n    _.extend(self, {\n      // Public Attributes\n      // Public Methods\n      parseAbsences: parseAbsences\n    })\n\n    function parseAbsences (absences, interval) {\n      if (!Array.isArray(interval)) {\n        throw new Error('Invalid interval')\n      }\n      var parsed = absences.filter(function (abs) {\n        return moment.range(abs.start, abs.end).overlaps(moment.range(interval[0], interval[1]))\n      }).map(function (absence) {\n        absence.style = {}\n        if (moment(absence.start).isSame(moment(angular.copy(interval[0])))) {\n          absence.style.top = 0 + 'px'\n          absence.start = interval[0]\n        }\n        if (moment(absence.start).isBefore(moment(angular.copy(interval[0])))) {\n          absence.start = interval[0]\n          absence.style.top = 0 + 'px'\n        }\n        if (moment(absence.end).isAfter(moment(angular.copy(interval[1])))) {\n          absence.end = interval[1]\n        }\n        return absence\n      })\n\n      return mergeRanges(parsed)\n    }\n\n    function mergeRanges (ranges) {\n      var copy = ranges.map(function (r, index) {\n        r.index = index\n        return Object.assign({}, r, {index: index})\n      })\n      // Check if any ranges overlaps\n      // If none overlap, return array\n      if (!_.any(copy, function (range1) {\n        return _.any(copy, function (range2) {\n          if (range1.index === range2.index) {\n            return false\n          }\n          return moment.range(range1.start, range1.end).overlaps(moment.range(range2.start, range2.end))\n        })\n      })) {\n        return ranges\n      }\n      var reduced = ranges.reduce(function (acc, value, index, arr) {\n        var next = arr[index + 1]\n        if (!next || !value) {\n          return acc\n        }\n\n        if (moment.range(value.start, value.end).overlaps(moment.range(next.start, next.end))) {\n          acc.push({\n            start: moment.min(\n              moment(angular.copy(value.start)),\n              moment(angular.copy(next.start))\n            ),\n            end: moment.max(\n              moment(angular.copy(value.end)),\n              moment(angular.copy(next.end))\n            )\n          })\n        }\n        return acc\n      }, [])\n\n      return mergeRanges(reduced)\n    }\n  }\n\n})(window.angular, window._, window.moment)\n",";(function (angular, _, moment) {\n  'use strict'\n\n  angular\n    .module('90Tech.planning')\n    .service('ColorService', ColorService)\n\n  ColorService.$inject = []\n\n  function ColorService () {\n    var self = this\n\n    _.extend(self, {\n      getLuminance: getLuminance\n    })\n\n\n    /**\n     * return the luminance of a color : > 200 is black\n     * @param c Color\n     * @returns {number}\n     */\n    function getLuminance (c) {\n      c = c || '#ffffff'\n      var r, g, b\n      var rgbRegex = /rgb\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3})\\)/\n      if (rgbRegex.test(c)){\n          var exec = rgbRegex.exec(c)\n           r = parseInt(exec[1])\n           g = parseInt(exec[2])\n           b = parseInt(exec[3])\n      } else {\n        var color = c.substring(1) // strip #\n        var rgb = parseInt(color, 16) // convert rrggbb to decimal\n        r = (rgb >> 16) & 0xff // extract red\n        g = (rgb >> 8) & 0xff // extract green\n        b = (rgb >> 0) & 0xff // extract blue\n      }\n\n      var luma = 0.2126 * r + 0.7152 * g + 0.0722 * b // per ITU-R BT.709\n      // luma > 200 : black\n      return luma\n    }\n\n  }\n}(window.angular, window._, window.moment))\n",";(function (angular) {\n  'use strict'\n  angular.module('90Tech.planning')\n    .provider('planningConfiguration', function () {\n      var self = this\n\n      self.BASE_SIZE = 10\n      self.MAX_PARALLEL = 3\n      self.strings = {\n        nothing_to_show: 'Rien  afficher'\n      }\n\n      self.DAYS = [0, 1, 2, 3, 4, 5, 6]\n\n      self.parallelText = 'parallel items'\n\n      this.setParallelText = function (text) {\n        self.parallelText = '' + text\n      }\n\n      this.setBaseSize = function (size) {\n        self.BASE_SIZE = size\n      }\n      this.setMaxParallel = function (number) {\n        self.MAX_PARALLEL = number\n      }\n\n      this.setString = function (key, value) {\n        self.strings[key] = value\n      }\n\n      this.setDays = function (value) {\n        self.DAYS = value\n      }\n\n      this.$get = [function () {\n        return {\n          strings: self.strings,\n          BASE_SIZE: self.BASE_SIZE,\n          MAX_PARALLEL: self.MAX_PARALLEL,\n          parallelText: self.parallelText,\n          DAYS: self.DAYS,\n          absentTechnicianCallback: function (callback) {\n            callback()\n          },\n          isFerieCallback: function (callback) {\n            callback()\n          },\n          warningCallback: function (callback) {\n            callback()\n          }\n        }\n      }]\n    })\n}(window.angular))\n",";(function (angular, _, moment) {\n  'use strict'\n  angular.module('90Tech.planning')\n    .service('HolidaysServicePlanning', HolidaysServicePlanning)\n\n  function HolidaysServicePlanning () {\n    var self = this\n    _.extend(self, {\n      // Public Attributes\n      solidarityDays: [],\n      masterDayRange: [],\n      aliaCompanySettings: {\n        showSolidarityDay: false\n      },\n      // Public Methods\n      isSolidarityDay\n    })\n\n    function isSolidarityDay (day) {\n      let bool = false\n      if(day && _.get(self.aliaCompanySettings, 'showSolidarityDay', false)){\n        const parsedDay = moment(day)\n        self.solidarityDays.forEach((solidarityDay) => {\n          if(solidarityDay.master) self.masterDay = solidarityDay\n          if(parsedDay.get('year') >= _.get(self.masterDay, 'year')){\n            const filter = self.masterDayRange.filter(elt => moment(elt.date).get('year') === moment(parsedDay).get('year') && elt.rule === self.masterDay.rule)\n            if(filter.length){\n              solidarityDay = filter[0]\n            }\n          }\n          if (\n            moment(solidarityDay.start).unix() <= moment(parsedDay).endOf('day').unix() &&\n            moment(solidarityDay.end).unix() >= moment(parsedDay).endOf('day').unix()\n          ) {\n            bool = true\n          }\n        })\n      }\n      return bool\n    }\n  }\n\n})(window.angular, window._, window.moment)\n",";(function (angular, _, moment) {\n  'use strict'\n  angular.module('90Tech.planning')\n    .service('PauseService', PauseService)\n\n  PauseService.$inject = ['ColorService']\n\n  function PauseService (ColorService) {\n    var self = this\n\n    _.extend(self, {\n      // Public Attributes\n      // Public Methods\n      generateGradient: generateGradient\n    })\n\n    function generateGradient (event, direction) {\n      var color = event.style['background-color']\n      var pauseColor = invertColor(color)\n      var start = event.start\n      var end = event.end\n      var totalRange = moment.range(start, end)\n      var totalDuration = totalRange.diff('milliseconds')\n\n      function parsePause (pauses) {\n        return _.map(pauses, function (pause) {\n          var start = event.start.isAfter(pause.start) ? event.start : pause.start\n          var end = event.end.isBefore(pause.end) ? event.end : pause.end\n          var pauseRange = moment.range(start, end)\n          var pauseDuration = pauseRange.diff('milliseconds')\n          var percentage = pauseDuration / totalDuration * 100\n          var before = totalRange.clone()\n          before.subtract(pauseRange)\n          if (!before.length) {\n            return {range: pauseRange, endPercentage: 100, startPercentage: 0}\n          }\n          var v = (before[0].diff('milliseconds') || totalDuration) / totalDuration * 100\n          return {range: pauseRange, endPercentage: percentage + v, startPercentage: v}\n        })\n      }\n\n      var mapped = parsePause(event.pauses)\n\n      var reduced = _.reduce(mapped, function (acc, range) {\n        return acc + ', ' + color + ' ' + range.startPercentage + '%, ' + pauseColor + ' ' + range.startPercentage + '%, ' + pauseColor + ' ' + range.endPercentage + '%, ' + color + ' ' + range.endPercentage + '%'\n      }, 'linear-gradient(' + direction + ', ' + color)\n\n      reduced += ', ' + color + ' 100%)'\n      return reduced\n    }\n\n    function invertColor (hex) {\n      if (hex.indexOf('#') === 0) {\n        hex = hex.slice(1)\n      }\n      // convert 3-digit hex to 6-digits.\n      if (hex.length === 3) {\n        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2]\n      }\n      if (hex.length !== 6) {\n        throw new Error('Invalid HEX color.')\n      }\n      // invert color components\n      var r = (255 - parseInt(hex.slice(0, 2), 16)).toString(16),\n        g = (255 - parseInt(hex.slice(2, 4), 16)).toString(16),\n        b = (255 - parseInt(hex.slice(4, 6), 16)).toString(16)\n      // pad each with zeros and return\n      return '#' + padZero(r) + padZero(g) + padZero(b)\n    }\n\n    function padZero (str, len) {\n      len = len || 2\n      var zeros = new Array(len).join('0')\n      return (zeros + str).slice(-len)\n    }\n  }\n\n})(window.angular, window._, window.moment)\n",";(function (angular, _, moment) {\n  'use strict'\n\n  angular\n    .module('90Tech.planning')\n    .service('PositionService', PositionService)\n\n  PositionService.$inject = []\n\n  function PositionService () {\n    var self = this\n\n    _.extend(self, {\n      // Public Methods\n      overlap: overlap\n    })\n\n    /**\n     * Check if event overlap any events in line, merge if parallel items is over maxParallelEvents, and push event in toRemove\n     * @param lines Arrays, containing events example : [[event, event][event,event][event]]\n     * @param event Event\n     * @param maxParallelEvents Int, maximum parallelEvents\n     * @param toRemove Array containing event which have been integrated/merged with another event\n     * @param doublecheck Boolean If true, check if day isn't same between two events (useful for monthly view where hours doesn't overlap on same day)\n     */\n    function overlap (lines, event, maxParallelEvents, toRemove, doublecheck) {\n      var range = event.pre > 0\n        ? moment.range(moment(event.start).subtract(event.pre, 'minutes'), moment(event.end))\n        : event.range\n      for (var i = 0; i < lines.length; i++) {\n        if (event.depth > maxParallelEvents) {\n          var overlap = false\n          _.each(lines[maxParallelEvents], function (elt) {\n\n            var eltRange = elt.pre > 0\n              ? moment.range(moment(elt.start).subtract(elt.pre, 'minutes'), moment(elt.end))\n              : elt.range\n\n            overlap = range.overlaps(eltRange)\n            if (!overlap && doublecheck) {\n              overlap = (event.start.day() === elt.start.day() || event.start.day() === elt.end.day() || event.end.day() === elt.start.day() || event.end.day() === elt.end.day())\n            }\n            if (overlap) {\n              elt.start = moment.min(event.start, elt.start) // set start to minimum of 2 overlapping event\n              elt.end = moment.max(event.end, elt.end)  // set end to maximum of 2 overlapping event\n              elt.range = moment.range(elt.start, elt.end) // Update range\n              elt.line = maxParallelEvents\n              elt.eventList.push(event)\n              if (elt.technician !== event.technician) { // Technician isn't the same, hide it\n                elt.technician = ''\n                event.technician = ''\n              }\n            }\n          })\n          if (overlap) {\n            toRemove.push(event)\n            break\n          }\n          event.depth = maxParallelEvents\n          event.line = maxParallelEvents\n          if (!event.eventList) {\n            var eventClone = _.cloneDeep(event)\n            event.eventList = [eventClone]\n          }\n          lines[maxParallelEvents].push(event)\n          break\n        }\n        if (!lines[i].length) {\n          lines[i].push(event)\n          event.line = i\n          break\n        }\n        if (_.filter(lines[i], function (elt) { // if any event in lines[i] overlap\n          var eltRange = elt.pre > 0\n            ? moment.range(moment(elt.start).subtract(elt.pre, 'minutes'), moment(elt.end))\n            : elt.range\n          overlap = range.overlaps(eltRange)\n          if (!overlap && doublecheck) {\n            overlap = (event.start.day() === elt.start.day() || event.start.day() === elt.end.day() || event.end.day() === elt.start.day() || event.end.day() === elt.end.day())\n          }\n          if (overlap) {\n            elt.depth += 1\n            return true\n          } }).length) {\n          event.depth += 1\n          if (!lines[i + 1]) { // if next line is doesn't exist, add one\n            lines[i + 1] = []\n          }\n        } else {\n          lines[i].push(event)\n          event.line = i\n          break\n        }\n      }\n    }\n  }\n}(window.angular, window._, window.moment))\n",";(function (angular, _) {\n  'use strict'\n\n  angular\n    .module('90Tech.planning')\n    .directive('zlPlanningDragDrop', function () {\n      return {\n        controller: function () {},\n        scope: {},\n        controllerAs: 'dragDropCtrl',\n        bindToController: {\n          zlDrag: '=',\n          zlDrop: '&'\n        },\n        link: function (scope, element) {\n          const options = {\n            threshold: 0.5\n          }\n          let seen = false\n          var dragImage = document.createElement('div')\n          var el = element[0]\n          const callback = (entries, observer) => {\n            if (entries[0].isIntersecting && !seen) {\n              seen = true\n              if (el.attributes['zl-drag']) {\n                el.draggable = true\n\n                el.addEventListener(\n                  'dragstart',\n                  dragStartEvent,\n                  false\n                )\n              }\n              if (el.attributes['zl-drop']) {\n                el.addEventListener(\n                  'drop',\n                  dropEvent,\n                  false\n                )\n\n                el.addEventListener(\n                  'dragenter',\n                  dragEnterEvent,\n                  false\n                )\n\n                el.addEventListener(\n                  'dragleave',\n                  dragLeaveEvent,\n                  false\n                )\n              }\n            } else if (!entries[0].isIntersecting && seen) {\n              el.removeEventListener(\n                'dragstart',\n                dragStartEvent,\n                false\n              )\n              el.removeEventListener(\n                'drop',\n                dropEvent,\n                false\n              )\n              el.removeEventListener(\n                'dragenter',\n                dragEnterEvent,\n                false\n              )\n              el.removeEventListener(\n                'dragleave',\n                dragLeaveEvent,\n                false\n              )\n              seen = false\n            }\n          }\n          const observer = new IntersectionObserver(callback, options)\n          observer.observe(element[0])\n\n          function dragStartEvent (e) {\n            dragImage.style.height = el.clientHeight + 'px'\n            dragImage.style.zIndex = '1000'\n            dragImage.style.position = 'relative'\n            dragImage.style.left = '-10000px'\n            dragImage.style.bottom = '-10000px;'\n            dragImage.innerHTML = el.innerHTML\n            if (el.children.length > 1) {\n              dragImage.children[0].style.float = 'left'\n              dragImage.style.backgroundColor = el.children[1].style.backgroundColor\n              dragImage.style.width = el.clientWidth + 'px'\n            } else {\n              dragImage.style.width = Math.min(el.clientWidth, 200) + 'px'\n              dragImage.style.backgroundColor = el.children[0].style.backgroundColor\n            }\n            e.dataTransfer.effectAllowed = 'move'\n\n            document.body.appendChild(dragImage)\n\n            // remove translucent drag if present\n            if (e.dataTransfer.setDragImage) {\n              e.dataTransfer.setDragImage(dragImage, 0, 0)\n            }\n            // Remove tooltips on drag\n            _.each(document.querySelectorAll('.planning-event-tooltip'), function (elt) {\n              elt.remove()\n            })\n            e.dataTransfer.setData('Text', JSON.stringify(scope.dragDropCtrl.zlDrag))\n            this.classList.add('drag')\n            return false\n          }\n          function dropEvent (e) {\n            scope.$apply(function () {\n              scope.dragDropCtrl.zlDrop({ $data: JSON.parse(e.dataTransfer.getData('Text')), $event: e })\n            })\n            e.target.classList.remove('over')\n            this.classList.remove('over')\n            e.stopPropagation()\n            return false\n          }\n          function dragEnterEvent (e) {\n            e.target.classList.add('over')\n            return false\n          }\n          function dragLeaveEvent (e) {\n            e.target.classList.remove('over')\n            return false\n          }\n        }\n      }\n    })\n})(window.angular, _)\n","/**\n * @author Toolito <toolito@90tech.fr>\n * @copyright 2015 Zenlabs SAS. All rights reserved.\n *\n * TODO Export in separate module ?\n */\n;(function (angular) {\n  'use strict'\n\n  angular\n    .module('90Tech.planning')\n    .directive('zlHorizontalScroll', ScrollHorizontalDirective)\n\n  ScrollHorizontalDirective.$inject = ['$timeout']\n\n  function ScrollHorizontalDirective ($timeout) {\n    return {\n      restrict: 'A',\n      scope: {\n        scrollLeft: '='\n      },\n      link: function link (scope, element,  attributes) { // eslint-disable-line\n        element.bind('mousewheel', function (e) {\n          element[0].scrollLeft -= e.wheelDelta / 3\n        })\n        element.addClass('slider')\n\n        if (scope.scrollLeft) {\n        }\n\n        $timeout(function () {\n          // Needs a delay since the offsetWidth we obtain first is off by ~300px\n          element[0].scrollLeft = scope.scrollLeft - element[0].offsetWidth / 2\n        }, 100)\n      }\n    }\n  }\n})(window.angular)\n",";(function (angular, moment, _) {\n  'use strict'\n\n  angular\n    .module('90Tech.planning')\n    .directive('zlPlanning', PlanningDirective)\n\n  PlanningController.$inject = ['$scope', 'planningConfiguration', 'HolidaysServicePlanning']\n\n  function PlanningController ($scope, planningConfiguration, HolidaysServicePlanning) {\n    var BASE_SIZE = planningConfiguration.BASE_SIZE\n\n    var self = this\n\n    self.$onInit = function () {\n      _.extend(self, {\n        //  sortedEvents       : sortedEvents,\n        isToday: isToday,\n        currentTimeToPixels: currentTimeToPixels,\n        isCurrent: isCurrent,\n        clickCallbackWrapper: clickCallbackWrapper,\n        showAbsencesCallBackWrapper: showAbsencesCallBackWrapper,\n        isInDayRange: isInDayRange,\n        keys: keys,\n        getEvents: getEvents,\n        clickWeekEvent: clickWeekEvent,\n        dropEvent: dropEvent,\n        isFerie: isFerie,\n        isSolidarityDay,\n        hasAbsence: hasAbsence,\n        getName: getName,\n        dayEvent,\n        isInRange\n      })\n\n      init()\n    }\n\n    function init () {\n      if(self.solidarityDays.length) HolidaysServicePlanning.solidarityDays = self.solidarityDays\n      if(self.masterDayRange.length) HolidaysServicePlanning.masterDayRange = self.masterDayRange\n      HolidaysServicePlanning.aliaCompanySettings = self.aliaCompanySettings\n      self.zoom = parseInt(self.zoom)\n      self.allowedDays = self.usableDays.sort() || planningConfiguration.DAYS\n      self.daysList = self.allowedDays.map(function (i) {\n        var d = moment(self.position)\n        d.weekday(i)\n        return d\n      })\n\n      if (!self.zoom || self.zoom < 1) {\n        self.zoom = 1\n      }\n\n      self._dayStart = self.dayStart ? parseTime(self.dayStart) : parseTime(0)\n      self._dayEnd = self.dayEnd ? parseTime(self.dayEnd) : parseTime(24)\n      self.width = (self.zoom * (parseInt(self._dayEnd.h) - parseInt(self._dayStart.h) + 1) * BASE_SIZE) + 'px'\n      self.sortedEvents = undefined\n      switch (self.mode) {\n        case 'week':\n          self._events = (_.flatten(_.map(self.events, split)))\n          self._events = filter(self._events)\n\n          self.sortedEvents = _.groupBy(self._events, function (e) {\n            return e.start.format('DD/MM/YYYY')\n          })\n          addMissingDays(self.sortedEvents)\n          break\n        case 'day':\n        case 'week-advanced':\n          self._events = (_.flatten(_.map(self.events, split)))\n          self._events = filter(self._events)\n          self.sortedEvents = _.groupBy(self._events, function (e) {\n            return e[self.dayField]\n          })\n          /* If we are in advanced week mode, we have a double grouping: first by technician, then by day of week */\n          if (self.mode === 'week-advanced') {\n            self.sortedEvents = _.mapValues(self.sortedEvents, function (eventsByTechnician) {\n              return _.groupBy(eventsByTechnician, function (e) {\n                return e.start.weekday()\n              })\n            })\n          }\n          addMissingEntities(self.sortedEvents)\n          break\n        case '3day':\n          self._events = (_.flatten(_.map(self.events, split)))\n          self._events = filter(self._events)\n          self.sortedEvents = _.reduce(self.entities, function (acc, v) {\n            acc[v] = []\n            return acc\n          }, {})\n\n          var keys = _.keys(self.sortedEvents)\n          self.groupedEvents = _.map(_.groupBy(self._events, function (e) {\n            return moment(e.start).startOf('day').unix()\n          }), function (v, k) {\n            var result = {\n              key: k,\n              date: moment.unix(k).startOf('day').toDate(),\n              day: moment.unix(k).startOf('day').format('dddd DD MMMM'),\n              value: _.groupBy(v, function (e) {\n                return e.technician\n              }),\n              absences: angular.copy(self.absences)\n            }\n            _.each(self.entities, function (e) {\n              if (!result.value[e]) {\n                result.value[e] = []\n              }\n            })\n            return result\n          })\n\n          var start = moment(self.position).hour(self._dayStart.h).minute(self._dayStart.m).second(0)\n          var stop = moment(self.position).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59)\n          var days = [{start: angular.copy(start), end: angular.copy(stop)}]\n\n          var j = 0\n          while (j < 2) {\n            stop.add(1, 'day')\n            var d = stop.day() - 1\n            if (d < 0) {\n              d = 6\n            }\n            if (_.isEmpty(self.allowedDays) || _.includes(self.allowedDays, d)) {\n              days.push({start: angular.copy(stop).hour(self._dayStart.h).minute(self._dayStart.m).second(0), end: angular.copy(stop).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59)})\n              j++\n            }\n          }\n\n          _.each(days, function (d) {\n            var date = \"\" + moment(d.start).startOf('day').unix()\n\n            var found = _.find(self.groupedEvents, function (group) {\n              return group.key === date\n            })\n\n            if (!found) {\n              var obj = {\n                key: date,\n                date: moment(angular.copy(d.start)).startOf('day').toDate(),\n                day: moment(angular.copy(d.start)).startOf('day').format('dddd DD MMMM'),\n                value: {},\n                absences: angular.copy(self.absences)\n              }\n              _.each(_.keys(self.sortedEvents), function (k) {\n                obj.value[k] = []\n              })\n              self.groupedEvents.push(obj)\n            }\n          })\n          self.groupedEvents = _.sortBy(self.groupedEvents, function (e) {\n            return e.key\n          })\n          break\n        case 'month':\n          var firstDay = moment(self.position).date(1).hours(0).minutes(0).seconds(0)\n          self.month = moment(self.position).date(1).hours(0).minutes(0).seconds(0).format('MMMM')\n          self.decallage = firstDay.isoWeekday() - 1 //\n\n          if (self.decallage < 0) {\n            self.decallage = 0\n          }\n          self.oneDayEvents = _(self.events)\n            .filter(function (event) {\n              return event.start.dayOfYear() === event.end.dayOfYear() && event.start.month() === moment(self.position).month()\n            })\n            .groupBy(\n              function (event) { return Math.floor((event.start.date() + self.decallage) / 7.01) }) // 7.01 -> Fix issue when start day = 7 (sunday)\n            .value()\n          self.multipleDaysEvents = _(self.events)\n            .filter(function (event) {\n              return event.start.dayOfYear() !== event.end.dayOfYear()\n            })\n            .map(splitByWeeks)\n            .flatten()\n            .groupBy(function (event) {\n              return Math.floor((event.start.date() + self.decallage) / 7.01) // 7.01 -> Fix issue when start day = 7 (sunday)\n            })\n            .value()\n\n\n          var endWeek = moment(self.position).endOf('month').isoWeek()\n          var startWeek = moment(self.position).startOf('month').isoWeek()\n          // When switching years, last week of month can be 1\n          if (endWeek === 1) {\n            endWeek = moment(self.position).isoWeeksInYear() + 1\n          }\n          if (endWeek < startWeek) {\n            endWeek = startWeek + endWeek\n          }\n          var weekInMonth = endWeek - startWeek + 1\n          for (var i = 0; i < weekInMonth; i++) {\n            if (self.multipleDaysEvents[i] === undefined) {\n              self.multipleDaysEvents[i] = []\n            }\n          }\n          self.days = []\n          // Add day from previous month\n          if (firstDay.isoWeekday() - 1 > 0) {\n            for (i = 0; i < firstDay.isoWeekday() - 1; i++) {\n              self.days.unshift({})\n            }\n          }\n          _.times(firstDay.daysInMonth(), function (n) {\n            var day = moment(firstDay).add(n, 'days')\n            self.days.push({ date: day, events: [] })\n          })\n\n          var displayedDaysCount = (self.days.length > 35 ? 42 : 35)\n          while (self.days.length < displayedDaysCount) {\n            self.days.push({})\n          }\n          break\n      }\n    }\n\n    function getName(id) {\n      return self.entitiesName.find((el) => el._id === id).fullname\n    }\n\n    function split (event) {\n      // Event starts and ends the same day\n      event = angular.copy(event)\n\n      var start = moment(event.start).hour(self._dayStart.h).minute(self._dayStart.m).second(0)\n      var stop = moment(event.end).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59)\n      if (event.start.dayOfYear() === event.end.dayOfYear()) {\n        // reset the boundaries if they exceed the one fixed.\n        // And trim events that are entirely out of the boundaries\n        if (event.start.isBefore(start)) {\n          if (event.end.isBefore(start)) {\n            return []\n          }\n          event.start = start\n        }\n        if (event.end.isAfter(stop)) {\n          if (event.start.isAfter(stop)) {\n            return []\n          }\n          event.end = stop\n        }\n        return [event]\n      }\n      // Event is on several days.\n      // Build a first event that ends at the end of the first day\n      var first_event = angular.copy(event)\n      first_event.end = moment(event.start).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59)\n      if (event.start.isBefore(start)) {\n        first_event.start = start\n      }\n\n      var startNextDay = moment(event.start).add(1, 'day').hour(self._dayStart.h).minute(self._dayStart.m)\n      var endThisDay = moment(event.start).hour(self._dayEnd.h).minute(self._dayEnd.m)\n      if (event.end.isBefore(startNextDay)) {\n        if (first_event.start.isAfter(endThisDay)) {\n          return []\n        }\n        // Event finishes before start hour next day. No need to create another one\n        return [first_event]\n      }\n      first_event.continuedAfter = true\n\n      // Build a second event that starts at the beginning of the following days.\n      // This event may end several days later. Recursion will handle it\n      var second_event = angular.copy(event)\n      second_event.start = moment(event.start).add(1, 'day').hour(self._dayStart.h).minute(self._dayStart.m)\n      second_event.continuedBefore = true\n\n      if (event.start.isAfter(endThisDay)) {\n        // If the first event starts after curfew, don't add it\n        return split(second_event)\n      }\n\n      return [first_event].concat(split(second_event))\n    }\n\n    function splitByWeeks (event) {\n      if (event.start.isAfter(event.end)) {\n        var st = event.start\n        event.start = event.end\n        event.end = st\n      }\n\n      if (event.start.year() < self.position.year() ||event.start.month() < self.position.month()) {\n        // Event starts before our current month\n        if (event.end.year() < self.position.year() || event.end.month() < self.position.month()) {\n          // Event also ends before. Return nothing\n          return []\n        }\n        // Set the beginning at the start of the month\n        event.start = moment(self.position).startOf('month')\n      }\n      if (event.end.month() > self.position.month() || event.end.year() !== self.position.year()) {\n        // Event ends after current month\n        if (event.start.month() > self.position.month()) {\n          return []\n        }\n        event.end = moment(self.position).endOf('month')\n      }\n      // console.info(_.cloneDeep(event))\n      if (event.start.isoWeek() === event.end.isoWeek()) {\n        // If our event is on one week, we're all set\n        return [event]\n      }\n\n      // Split\n      var firstEvent = angular.copy(event)\n      var secondEvent = angular.copy(event)\n      // make it end on the same week\n      firstEvent.continuedAfter = true\n      secondEvent.continuedBefore = true\n      firstEvent.end = moment(firstEvent.start).endOf('week')\n      secondEvent.start.add(1, 'week').startOf('week')\n      // Recursion will handle potential split needed by second event\n      return [firstEvent].concat(splitByWeeks(secondEvent))\n    }\n\n    function filter (events) { // remove event not in range (month, week, day)\n      return _.filter(events, function (e) {\n        var start, stop\n        switch (self.mode) {\n          case 'week':\n          case 'week-advanced':\n            start = moment(self.position).weekday(0).hour(self._dayStart.h).minute(self._dayStart.m).second(0)\n            stop = moment(self.position).weekday(6).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59)\n            break\n          case 'day':\n            start = moment(self.position).startOf('day').hour(self._dayStart.h).minute(self._dayStart.m)\n            stop = moment(self.position).endOf('day').hour(self._dayEnd.h).minute(self._dayEnd.m)\n            break\n          case '3day':\n            start = moment(self.position).hour(self._dayStart.h).minute(self._dayStart.m).second(0)\n            stop = moment(self.position).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59)\n            var days = [{start: angular.copy(start), end: angular.copy(stop)}]\n\n            var i = 0\n            while (i < 2) {\n              stop.add(1, 'day')\n              var d = stop.day() - 1\n              if (d < 0) {\n                d = 6\n              }\n              if (_.isEmpty(self.allowedDays) || _.includes(self.allowedDays, d)) {\n                days.push({start: angular.copy(stop).hour(self._dayStart.h).minute(self._dayStart.m).second(0), end: angular.copy(stop).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59)})\n                i++\n              }\n            }\n            return _.some(days, function (d) {\n              return e.start.isBetween(d.start, d.end) || e.end.isBetween(d.start, d.end)\n            })\n          case 'month':\n            start = moment(self.position).date(1).hour(self._dayStart.h).minute(self._dayStart.m).second(0)\n            stop = moment(self.position).weekday(moment(self.position).daysInMonth()).hour(self._dayEnd.h).minute(self._dayEnd.m).second(59)\n            break\n        }\n        return e.start.isBetween(start, stop) || e.end.isBetween(start, stop)\n      })\n    }\n\n    function addMissingDays (sortedEvents) {\n      sortedEvents = sortedEvents || {}\n      var startingDay = moment(self.position).weekday(0)\n      _.times(7, function (i) {\n        var newDate = moment(angular.copy(startingDay)).add(i, 'days').format('DD/MM/YYYY')\n        if (!sortedEvents[newDate]) {\n          sortedEvents[newDate] = []\n        }\n      })\n    }\n\n    function addMissingEntities (sortedEvents) {\n      sortedEvents = sortedEvents || {}\n      _.each(self.entities, function (e) {\n        if (!sortedEvents[e]) {\n          sortedEvents[e] = []\n        }\n      })\n    }\n\n    function parseTime (h) {\n      if (h >= 24) {\n        return { h: 23, m: 59 }\n      }\n      return { h: h, m: 0 }\n    }\n\n    function keys (sortedEvents) {\n      switch (self.mode) {\n        case 'week':\n          return Object.keys(sortedEvents).sort(function(a, b) {\n            var dateA = dateFromString(a)\n            var dateB = dateFromString(b)\n            return dateA - dateB\n          })\n        case 'week-advanced':\n        case 'day':\n        case '3day':\n          if (self.entitiesName) {\n            return self.entitiesName.map(e => e._id)\n          }\n          return []\n      }\n    }\n\n    function getEvents (key) {\n      return self.sortedEvents[key]\n    }\n\n    $scope.$watchCollection(function () {\n      return [self.events, self.entities, self.position, self.mode, self.dayStart, self.dayEnd, self.zoom, self.usableDays]\n    }, init)\n\n    function isToday (n) {\n      return self.position.week() === moment().week() && n === moment().dayOfYear()\n    }\n\n    function isFerie (day) {\n      if(self.holidays) {\n        return self.holidays.find(holiday => moment(holiday.date).format('L') === moment(day).format('L'));\n      }\n    }\n\n    function isSolidarityDay (day) {\n      return HolidaysServicePlanning.isSolidarityDay(day)\n    }\n\n    function hasAbsence (date) {\n      var d = moment(angular.copy(date))\n      return _.any(self._absences, function (abs) {\n        return abs.range.contains(d)\n      })\n    }\n\n    function isInDayRange () {\n      return moment().hour() > parseInt(self._dayStart.h) && moment().hour() < parseInt(self._dayEnd.h)\n    }\n\n    function currentTimeToPixels () {\n      var totalMinutes = (moment().hour() - parseInt(self._dayStart ? self._dayStart.h : 0)) * 60 + moment().minutes()\n      return Math.floor(self.zoom * (BASE_SIZE * totalMinutes) / 60)\n    }\n\n    function isCurrent () {\n      return self.position.isSame(moment(), self.mode)\n    }\n\n    function clickCallbackWrapper (opts) {\n      var mom\n      var entity\n      switch (self.mode) {\n        case 'week':\n          var split = opts.d.split('/')\n          /**\n           * split[2] === year\n           * split[1] === month, we need to subtract 1 because momentJS months starts at 0\n           * split[0] === dayOfMonth\n           */\n          mom = moment(new Date(split[2], split[1] - 1, split[0], opts.h, opts.m))\n          break\n        case '3day':\n        case 'day':\n          mom = moment(self.position).hour(opts.h).minute(opts.m)\n          entity = opts.entity\n          break\n        case 'week-advanced':\n          entity = opts.entity\n          mom = moment(self.position).hour(opts.h).minute(opts.m).second(0).weekday(opts.d)\n          break\n      }\n      self.clickCallback({ $moment: mom, $entity: entity })\n    }\n\n    function clickWeekEvent (day, $event) {\n      if (day.date) {\n        self.clickCallback({ $moment: day.date })\n      }\n    }\n\n    function showAbsencesCallBackWrapper (absences, day) {\n      self.showAbsencesCallback({$absences: absences, $day: day})\n    }\n\n    function dropEvent (config) {\n      var mom = config.moment\n      if (!mom) {\n        switch (self.mode) {\n          case 'week':\n            var doy = moment(dateFromString(config.d)).dayOfYear()\n            mom = moment(self.position).hour(config.h).minute(config.m).second(0).dayOfYear(doy)\n            break\n          case 'week-advanced':\n            mom = moment(self.position).hour(config.h).minute(config.m).second(0).weekday(config.d)\n            break\n          case 'day':\n            mom = moment(self.position).hour(config.h).minute(config.m)\n            break\n          case '3day':\n            mom = moment.unix(config.day).hour(config.h).minute(config.m)\n        }\n      }\n      var entity = (_.includes(['week-advanced', 'day', '3day'], self.mode)) ? config.entity : undefined\n      if ((self.mode === 'month') && isFerie(mom)) {\n        if (!self.isSolidarityDay(mom)) {\n          planningConfiguration.isFerieCallback(function () {\n            self.dropCallback({ $moment: mom, $data: config.$data, $event: config.$event, $entity: entity })\n          })\n        } else {\n          self.dropCallback({ $moment: mom, $data: config.$data, $event: config.$event, $entity: entity })\n        }\n      } else {\n        self.dropCallback({ $moment: mom, $data: config.$data, $event: config.$event, $entity: entity })\n      }\n    }\n\n    function calculateAdvancedWeekContainerHeight () {\n      return (parseInt(self.zoom) * Math.max(planningConfiguration.BASE_SIZE - 8, 1)) + 'px'\n    }\n\n    function dateFromString (date) {\n      var dateSplitted = date.split('/')\n      return new Date(dateSplitted[2], dateSplitted[1] - 1, dateSplitted[0])\n    }\n\n    function dayEvent (line, move) {\n      if (move) {\n        return self.moveAction({ $element: angular.copy(line) })\n      } else {\n        return self.duplicateAction({ $element: angular.copy(line) })\n      }\n    }\n\n    function isInRange(beginAt) {\n      if(!self.interventionShowInterval?.showInterval || typeof self.interventionShowInterval.interval !== 'number') return true\n      const dateSumInterval = moment().add('days', self.interventionShowInterval.interval)\n      return (moment(beginAt).startOf('day').unix() < dateSumInterval.unix())\n    }\n\n  }\n\n  function PlanningDirective () {\n    return {\n      restrict: 'E',\n      templateUrl: '/directives/planning/planning.html',\n      controller: PlanningController,\n      controllerAs: 'planning',\n      bindToController: {\n        zoom: '=',\n        events: '=',\n        entities: '=',\n        entitiesName: '=',\n        entitiesPauses: '=?',\n        absences: '=?',\n        position: '=',\n        mode: '=',\n        dayStart: '=',\n        dayEnd: '=',\n        dayField: '=',\n        eventCallback: '&',\n        dayCallback: '&',\n        clickCallback: '&',\n        weekEventCallback: '&',\n        dropCallback: '&',\n        usableDays: '=?',\n        action: '&?',\n        duplicateAction: '&?',\n        moveAction: '&?',\n        holidays: '=',\n        solidarityDays: '=',\n        showAbsencesCallback: '&',\n        aliaCompanySettings: '=',\n        interventionShowInterval: '=',\n        masterDayRange: '='\n      },\n      scope: {}\n    }\n  }\n})(window.angular, window.moment, window._)\n",";(function (angular, _, moment) {\n  'use strict'\n\n  angular\n    .module('90Tech.planning')\n    .directive('zlPlanningDay', PlanningDayDirective)\n\n  PlanningDayController.$inject = [\n    // Angular\n    '$scope',\n    // Libs\n    // Managers\n    // Services\n    'HolidaysServicePlanning'\n    // Const\n    // Resolved\n  ]\n  function PlanningDayController (\n    // Angular\n    $scope,\n    // Libs\n    // Managers\n    // Services\n    HolidaysServicePlanning\n    // Const\n    // Resolved\n  ) {\n    var self = this\n\n    self.$onInit = function () {\n      _.extend(self, {\n        dropEvent: dropEvent,\n        getName,\n        isSolidarityDay,\n        absents: []\n      })\n\n      self.isDefined = (self.day.events === undefined)\n      init()\n      $scope.$watchCollection([self.day, self.absences], function () {\n        if (self.day && self.day.date && self.absences && Object.keys(self.absences).length) {\n          self.absents = Object.keys(self.absences).reduce(function (acc, key) {\n            var array = self.absences[key]\n            var hasOverlap = _.any(array, function (absence) {\n              var range = moment.range(absence.start, absence.end)\n              if (moment(absence.start).diff(absence.end, 'minutes') === 0) {\n                return false\n              }\n              if (moment(absence.start).hours() === 12 && moment(absence.start).isSame(self.day.date, 'day') ) {\n                return !!moment(absence.start).isBetween(self.day.date, moment(self.day.date).endOf('day'))\n              }\n              if (self.day.date.within(range) ) {\n                return true\n              }\n            })\n            if (hasOverlap) {\n              acc.push(key)\n            }\n            return acc\n          }, [])\n          self.absentsString = '<div>' + self.getName(self.absents).join('<br>') + '</div>'\n        } else {\n          self.absentsString = ''\n          self.absents = []\n        }\n      })\n    }\n\n\n    function init () {\n      if(self.holidays && self.day.date) {\n        self.isFerie = self.holidays.find(holiday => moment(holiday.date).format('L') === moment(self.day.date).format('L'));\n      }\n    }\n\n\n    function dropEvent (data, event) {\n      self.dropCallback({ $data: data, $event: event})\n    }\n    function isSolidarityDay (day) {\n      return HolidaysServicePlanning.isSolidarityDay(day)\n    }\n\n    function getName(ids) {\n      const array = []\n      ids.forEach((id) => {\n        array.push(self.entities.find((el) => el._id === id).fullname)\n      })\n      return array\n    }\n  }\n\n  /**\n   *\n   */\n  function PlanningDayDirective () {\n    return {\n      restrict: 'E',\n      replace: true,\n      templateUrl: '/directives/planning-day-block/planning-day.html',\n      controller: PlanningDayController,\n      controllerAs: 'dayCtrl',\n      bindToController: {\n        day: '=',\n        events: '=',\n        clickCallback: '&',\n        entities: '=?',\n        dropCallback: '&',\n        absences: '=?',\n        holidays: \"=\"\n      },\n      scope: true,\n      link: function (scope, element) {\n        var el = element[0]\n        window.addEventListener('dragover', function (e) {\n          e.preventDefault();\n        }, false);\n        window.addEventListener('drop', function (e) {\n          e.preventDefault();\n        }, false);\n        el.addEventListener(\n          'drop',\n          function (e) {\n            e.preventDefault()\n            e.stopPropagation()\n            if (e.stopPropagation) e.stopPropagation()\n            this.classList.remove('over')\n            scope.$apply(function () {\n              scope.dayCtrl.dropEvent(JSON.parse(e.dataTransfer.getData('Text')), e)\n            })\n            return false\n          },\n          false\n        )\n\n        el.addEventListener(\n          'dragenter',\n          function (e) {\n            this.classList.add('over')\n            return false\n          },\n          false\n        )\n\n        el.addEventListener(\n          'dragleave',\n          function (e) {\n            this.classList.remove('over')\n            return false\n          },\n          false\n        )\n      }\n    }\n  }\n})(window.angular, window._, window.moment)\n",";(function (angular, moment, _) {\n  'use strict'\n\n  angular\n    .module('90Tech.planning')\n    .directive('zlPlanningLeftColumn', PlanningDirective)\n\n  PlanningLeftColumnController.$inject = ['$scope', 'HolidaysServicePlanning']\n\n  function PlanningLeftColumnController ($scope, HolidaysServicePlanning) {\n    var self = this\n\n    self.$onInit = function () {\n      _.extend(self, {\n        triggerDayEvent,\n        isSolidarityDay\n      })\n      $scope.$watchCollection(function () {\n        return [self.events, self.position, self.mode, self.dayStart, self.dayEnd, self.usableDays, self.entitiesName]\n      }, init)\n    }\n\n    function init () {\n      if (!self.threeDays) self.activateDuplicationButtons = true\n      self.days = []\n      self.allowedDays = self.usableDays\n      self._absences = []\n      if (self.mode === 'week') {\n        _.forEach(self.allowedDays, function (d) {\n          var day = moment(self.position)\n          day.weekday(d)\n          self.days.push(day)\n        })\n        self.days = _.sortBy(self.days, function (d) {\n          return moment(d).toDate()\n        })\n        if(self.absences) {\n          let index = 0\n          self.days.forEach(day => {\n            self._absences[index]=[]\n            for (const [key, value] of Object.entries(self.absences)) {\n              value.forEach(absence => {\n                if(day.isBetween(moment(absence.start), moment(absence.end)) || (moment(day).isSame(moment(absence.start),'day') && moment(day).isSame(moment(absence.end),'day'))){\n                  self._absences[index].push(angular.copy(absence))\n                }\n              })\n            }\n            index++\n          });\n        }\n      } else if (self.mode === 'day' && self.dayField) {\n        self.column = self.entitiesName\n      }\n    }\n\n    function triggerDayEvent (line, move) {\n      if (move) {\n        return self.dayEvent(angular.copy(self.events[line._id]), true)\n      } else {\n        return self.dayEvent(angular.copy(self.events[line._id]))\n      }\n    }\n\n    function isSolidarityDay(day){\n      return HolidaysServicePlanning.isSolidarityDay(day)\n    }\n\n  }\n\n  function PlanningDirective () {\n    return {\n      restrict: 'E',\n      templateUrl: '/directives/planning-left-column/planning-left-column.html',\n      controller: PlanningLeftColumnController,\n      controllerAs: 'planningLeftColumn',\n      bindToController: {\n        events: '=',\n        entitiesName: '=',\n        position: '=',\n        mode: '=',\n        dayField: '=',\n        usableDays: '=',\n        isFerie: '=?',\n        absences: '=',\n        dayEvent: '=',\n        threeDays: '<'\n      },\n      scope: true\n    }\n  }\n})(window.angular, window.moment, window._)\n",";(function (angular, _, moment) {\n  'use strict'\n\n  angular\n    .module('90Tech.planning')\n    .directive('zlPlanningLine', PlanningLineDirective)\n\n  PlanningLineController.$inject = ['$scope', 'planningConfiguration', 'PositionService', 'ColorService', 'PauseService', 'AbsenceService', 'HolidaysServicePlanning']\n\n  /**\n   *\n   */\n  function\n  PlanningLineController ($scope, planningConfiguration, PositionService, ColorService, PauseService, AbsenceService, HolidaysServicePlanning) {\n\n    var BASE_SIZE = planningConfiguration.BASE_SIZE\n    var parallelText = planningConfiguration.parallelText\n    var MAX_PARALLEL = planningConfiguration.MAX_PARALLEL\n\n    var self = this\n\n    self.$onInit = function () {\n      _.extend(self, {\n        clickEvent: clickEvent,\n        calcWidth: calcWidth,\n        dropEvent: dropEvent,\n        hoverAbsence: hoverAbsence,\n        leaveAbsence: leaveAbsence\n      })\n      init()\n      $scope.$watchCollection(function () {\n        return [self.events, self.dayStart, self.dayEnd]\n      }, init)\n\n      $scope.$watchCollection(function () {\n        return [self.absences]\n      }, function (newValue, oldValue) {\n        if (Array.isArray(self.absences) && self.absences.length) {\n          var start = moment(angular.copy(self.position)).startOf('day')\n          var end = moment(angular.copy(self.position)).endOf('day')\n            self._absences = AbsenceService.parseAbsences(self.absences , [start, end]).map(function (abs) {\n                abs.style = {\n                left: (moment(abs.start).hours() - self.dayStart.h) * BASE_SIZE * self.zoom + moment(abs.start).minutes() * BASE_SIZE * self.zoom / 60 + 'px',\n                width: self.zoom * self.SLIDER_WIDTH * (moment.range(abs.start, abs.end).valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px'\n              }\n              abs.range = moment.range(abs.start, abs.end)\n              abs.class = 'planning-absence-' + abs.confirmation.state\n              abs.tooltip = setAbsenceTooltip(abs)\n              return abs\n            })\n\n        } else if (self.absences) {\n          var start = moment(angular.copy(self.dayOfWeek)).startOf('day')\n          var end = moment(angular.copy(self.dayOfWeek)).endOf('day')\n          self._absences = []\n          for (const [key, value] of Object.entries(self.absences)) {\n            value.forEach(absence => {\n              if(self.dayOfWeek.isBetween(moment(absence.start), moment(absence.end)) || (moment(self.dayOfWeek).isSame(moment(absence.start),'day') && moment(self.dayOfWeek).isSame(moment(absence.end),'day'))){\n                self._absences.push(angular.copy(absence))\n              }\n            })\n          }\n          self._absences.forEach(absence => {\n            let index = self._absences.indexOf(absence)\n            if (\n              (moment(absence.start).isBefore(moment(self.dayOfWeek).startOf('day')) && (moment(absence.end).isAfter(moment(self.dayOfWeek).endOf('day')))) ||\n              (moment(absence.end).isSame(moment(self.dayOfWeek).endOf('day')) && moment(absence.start).isBefore(moment(self.dayOfWeek).startOf('hour'))) ||\n              ((moment(absence.start).isSame(moment(self.dayOfWeek).startOf('day')) && (moment(absence.end).isAfter(moment(self.dayOfWeek).endOf('day')))))){\n              absence.start = moment(self.dayOfWeek).startOf('day')\n              absence.end = moment(self.dayOfWeek).endOf('day')\n            }\n\n            absence.style = {\n              left: (moment(absence.start).hours() - self.dayStart.h) * BASE_SIZE * self.zoom + moment(absence.start).minutes() * BASE_SIZE * self.zoom / 60 + 'px',\n              width: self.zoom * self.SLIDER_WIDTH * (moment.range(absence.start, absence.end).valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px',\n              height: (100 / self._absences.length) + '%',\n              position: 'absolute',\n              top: (100 / self._absences.length) * index + '%'\n              }\n              absence.range = moment.range(absence.start, absence.end)\n              absence.class = 'planning-absence-' + absence.confirmation.state\n              absence.tooltip = setAbsenceTooltip(absence)\n              absence.index = index\n          })\n        } else {\n          self._absences = []\n        }\n      })\n    }\n\n    self.log = function (a) {\n    }\n\n    self.replace = function (string) {\n      if (!string) return\n      return string.replace(/([a-zA-Z\\ ])\\w+/, '')\n    }\n\n    self.preEvent = {}\n    self.postEvent = {}\n\n    function setAbsenceTooltip(abs) {\n        let state = ''\n        const absenceType = abs.absenceType\n        const userName = self.mode === 'week' ? abs.user.fullname + ' - ' : ''\n        switch (abs.confirmation.state) {\n            case 'sending':\n                state = userName + 'Absence envoye'\n                break\n            case 'pending':\n                state = userName + 'Absence en cours de traitement'\n                break\n            case 'partial-accepted':\n                state = userName + 'Absence en cours de traitement'\n                break;\n            case 'accepted':\n                state = userName + 'Absence accepte'\n                break\n        }\n        if(absenceType) {\n            return state + '\\nRaison: '+ absenceType\n        } else {\n            return state\n        }\n    }\n    function extractMinutesFromEvent($event){\n      var minutes\n      if (_.contains($event.target.classList, 'half-hour')) {\n        // If the user has clicked right on the half-hour line, offsetX is 0\n        minutes = 30\n      } else {\n        minutes = Math.floor($event.offsetX / (BASE_SIZE * self.zoom) * 60)\n      }\n      return minutes\n    }\n\n    function hoverAbsence(absence) {\n      self.tooltip = setAbsenceTooltip(absence)\n      for (const iterator of document.getElementsByClassName(absence._id)) {\n        iterator.classList.add('absence-hover')\n      }\n    }\n\n    function leaveAbsence() {\n      for (const iterator of document.getElementsByClassName('absence')) {\n        iterator.classList.remove('absence-hover')\n      }\n    }\n\n    function dropEvent (data, event, line) {\n      var hour = parseInt(event.target.getAttribute('hour'))\n      var minutes = extractMinutesFromEvent(event)\n      var date = moment(angular.copy(self.position)).hours(hour + parseInt(self.dayStart.h)).minutes(minutes)\n      var day = line.dayOfWeek ? line.dayOfWeek : line.position\n      if (checkAbsence(date) && checkFerie(day)) {\n        planningConfiguration.warningCallback(function () {\n          self.dropCallback({ $data: data, $event: event, $hour: hour + parseInt(self.dayStart.h), $minutes: minutes})\n        })\n      } else if (checkAbsence(date) && !checkFerie(day)) {\n        planningConfiguration.absentTechnicianCallback(function () {\n          self.dropCallback({ $data: data, $event: event, $hour: hour + parseInt(self.dayStart.h), $minutes: minutes})\n        })\n      } else if (!checkAbsence(date) && checkFerie(day)) {\n        if(!HolidaysServicePlanning.isSolidarityDay(day)){\n        planningConfiguration.isFerieCallback(function () {\n          self.dropCallback({ $data: data, $event: event, $hour: hour + parseInt(self.dayStart.h), $minutes: minutes})\n        })} else {\n          self.dropCallback({ $data: data, $event: event, $hour: hour + parseInt(self.dayStart.h), $minutes: minutes})\n        }\n      } else {\n        self.dropCallback({ $data: data, $event: event, $hour: hour + parseInt(self.dayStart.h), $minutes: minutes})\n      }\n    }\n\n    function clickEvent (hour, $event, line) {\n      let day = !!line.dayOfWeek ? line.dayOfWeek : line.position\n      var minutes = extractMinutesFromEvent($event)\n      var date = moment(angular.copy(self.position)).hours(hour + parseInt(self.dayStart.h)).minutes(minutes)\n      if (checkAbsence(date) && checkFerie(day)) {\n        planningConfiguration.warningCallback(function () {\n          self.clickCallback({$hour: hour + parseInt(self.dayStart.h), $minutes: minutes})\n        })\n      } else if (checkAbsence(date) && !checkFerie(day)) {\n        planningConfiguration.absentTechnicianCallback(function () {\n          self.clickCallback({$hour: hour + parseInt(self.dayStart.h), $minutes: minutes})\n        })\n      } else if (!checkAbsence(date) && checkFerie(day)) {\n        if(!HolidaysServicePlanning.isSolidarityDay(day)){\n        planningConfiguration.isFerieCallback(function () {\n          self.clickCallback({$hour: hour + parseInt(self.dayStart.h), $minutes: minutes})\n        })} else {\n          self.clickCallback({$hour: hour + parseInt(self.dayStart.h), $minutes: minutes})\n        }\n      } else {\n        self.clickCallback({$hour: hour + parseInt(self.dayStart.h), $minutes: minutes})\n      }\n    }\n\n    function init () {\n      var currentId = 0\n      //     self.SLIDER_WIDTH   = 24 * BASE_SIZE\n      self.preEvent = {}\n      self.postEvent = {}\n      self.breaks = []\n\n      self._events = angular.copy(self.events)\n\n      self.range = self.dayEnd.h - self.dayStart.h\n      self.SECONDS_BY_DAY = 3600 * self.range\n      self.SLIDER_WIDTH = BASE_SIZE * self.range\n\n      // Pre-sort events by start Date\n      self._events = _.sortBy(self._events, function (e) {\n        return e.start.valueOf()\n      })\n\n      var lines = [[]]\n      var toremove = []\n      _.each(self._events, function (event) {\n        var style = {}\n        event.depth = 1\n        event.range = moment.range(event.start, event.end)\n        if (event.range < 900000) {\n          var end = moment(event.start).add(15, 'minutes')\n          event.range = moment.range(event.start, end)\n        }\n        style.left = (event.start.hours() - self.dayStart.h) * BASE_SIZE * self.zoom + event.start.minutes() * BASE_SIZE * self.zoom / 60 + 'px'\n        //   style.left                = event.start.hours() * 150 + event.start.minutes() * 150 / 60 + 'px'\n        style.width = self.zoom * self.SLIDER_WIDTH * (event.range) / self.SECONDS_BY_DAY / 1000 + 'px'\n        style['background-color'] = event['background-color'] || '#778899'\n        if (ColorService.getLuminance(style['background-color'])> 200){\n          style.color = 'black'\n        } else {\n          style.color = 'white'\n        }\n        event.style = style\n        PositionService.overlap(lines, event, MAX_PARALLEL, toremove)\n      })\n      self._events = _.difference(self._events, toremove)\n      _.each(self._events, function (event) {\n        event.id = angular.copy(currentId)\n        if (event.line === MAX_PARALLEL) {\n          event.style.left = (event.start.hours() - self.dayStart.h) * BASE_SIZE * self.zoom + event.start.minutes() * BASE_SIZE * self.zoom / 60 + 'px'\n          event.style.width = self.zoom * self.SLIDER_WIDTH * (event.range.valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px'\n          event.style['background-color'] = '#000'\n          event.style['font-weight'] = 'bold'\n          event.style.color = '#fff'\n          event.title = (event.eventList.length) + ' ' + parallelText\n          if (event.tooltip) event.tooltip = event.title\n        }\n        event.style.width = self.zoom * self.SLIDER_WIDTH * (event.range.valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px'\n        if (event.line === undefined) event.line = MAX_PARALLEL\n        event.style.top = Math.round((parseInt(event.line)) * 70 / lines.length) + '%'\n        event.style.height = Math.round(70 / lines.length) + '%'\n        event.percentage = '100%'\n        if (event.pre > 0) {\n          event.style['border-left'] = 'none'\n          var s = moment(event.start).subtract(event.pre, 'minutes')\n          if (!moment(s).isSame(event.start, 'day')) {\n            s = moment(event.start).startOf('day')\n          }\n          var e = moment(event.start)\n          var r = moment.range(s, e)\n          var totalRange = moment.range(s, event.range.end)\n          var percentage = r.valueOf() / totalRange.valueOf() * 100\n          event.percentage = (100 - percentage) + '%'\n          var obj = {\n            percentage: (percentage) + '%',\n            style: {\n              left: (((moment(s).hours() - self.dayStart.h) * BASE_SIZE * self.zoom + (moment(s).minutes()) * BASE_SIZE * self.zoom / 60) + 2) +  'px',\n              width: self.zoom * self.SLIDER_WIDTH * (r.valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px',\n              top: event.style.top,\n              height: event.style.height,\n              totalWidth: self.zoom * self.SLIDER_WIDTH * (totalRange.valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px',\n              'text-align': 'center',\n              color: '#fff',\n              'background' : 'repeating-linear-gradient(45deg, ' +  event['background-color']  + ', ' +  event['background-color']  + ' 10px, white 10px, white 20px)',\n              'border-top': '1px lightgrey solid',\n              'border-bottom': '1px lightgrey solid',\n              'border-left': '1px lightgrey solid'\n            },\n            tooltip: 'Trajet estim de ' + event.pre + ' min'\n          }\n          if (percentage > 0) {\n            self.preEvent[event.id] = obj\n          } else {\n            event.pre = 0\n          }\n\n        }\n        generatePostEvent(event)\n        if (event.pauses) {\n          event.style['background-image'] = PauseService.generateGradient(event, 'to right')\n          event.style['background-color'] = undefined\n        }\n        const pre = self.preEvent[event.id]\n        const post = self.postEvent[event.id]\n        event.style.totalWidth = (safeParse(event.style.width) + safeParse(_.get(pre, 'style.width')) + safeParse(_.get(post, 'style.width')) + 1) + 'px'\n        currentId++\n      })\n      if (self.pauses) {\n        createBreaks()\n      }\n\n    }\n\n    function calcWidth (zoom) {\n      return (parseInt(zoom) * BASE_SIZE) + 'px'\n    }\n\n    function createBreaks () {\n      self.breaks = _.compact(_.map(self.pauses.breaks, function (p) {\n        var pause = {\n          name: p.name,\n          start: moment().hours(p.start.split(':')[0]).minute(p.start.split(':')[1]).second(0),\n          end: moment().hours(p.end.split(':')[0]).minute(p.end.split(':')[1]).second(0),\n          style: {}\n        }\n\n        if (pause.start.isAfter(self.dayEnd) || pause.end.isBefore(self.dayStart)) {\n          return\n        }\n        if (pause.start.isBefore(self.dayStart)) {\n          pause.start = moment(angular.copy(self.dayStart))\n        }\n\n        if (pause.end.isAfter(self.dayEnd)) {\n          pause.end = moment(angular.copy(self.dayEnd))\n        }\n        pause.style.left = (pause.start.hours() - self.dayStart.h) * BASE_SIZE * self.zoom + pause.start.minutes() * BASE_SIZE * self.zoom / 60 + 'px'\n        pause.style.width = self.zoom * self.SLIDER_WIDTH * (moment.range(pause.start, pause.end).valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px'\n\n        return pause\n      }))\n    }\n\n    function checkAbsence (date) {\n      if(self.mode === 'week') {\n        return false\n      }\n      var d = moment(angular.copy(date))\n      return _.any(self._absences, function (abs) {\n        return abs.range.contains(d)\n      })\n    }\n\n    function checkFerie (date) {\n      return self.holidays.find(holiday => moment(holiday.date).format('L') === moment(date).format('L'));\n    }\n\n    function generatePostEvent (event) {\n      if (!event.post) {\n        return null\n      }\n      event.style['border-right'] = 'none'\n      let end = moment(event.end).add(event.post, 'minutes')\n      if (!moment(end).isSame(event.end, 'day')) {\n        end = moment(event.end).endOf('day')\n      }\n      const start = moment(event.end)\n      const range = moment.range(start, end)\n      const totalRange = moment.range(event.range.start, event.range.end)\n      const percentage = range.valueOf() / totalRange.valueOf() * 100\n      event.postPercentage = (100 - percentage) + '%'\n      var obj = {\n        percentage: (percentage) + '%',\n        style: {\n          left: (((moment(start).hours() - self.dayStart.h) * BASE_SIZE * self.zoom + (moment(start).minutes()) * BASE_SIZE * self.zoom / 60) + 2) +  'px',\n          width: self.zoom * self.SLIDER_WIDTH * (range.valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px',\n          top: event.style.top,\n          height: event.style.height,\n          totalWidth: self.zoom * self.SLIDER_WIDTH * (totalRange.valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px',\n          'text-align': 'center',\n          color: '#fff',\n          'background' : 'repeating-linear-gradient(135deg, ' +  event['background-color']  + ', ' +  event['background-color']  + ' 10px, white 10px, white 20px)',\n          'border-top': '1px lightgrey solid',\n          'border-bottom': '1px lightgrey solid',\n          'border-left': '1px lightgrey solid'\n        },\n        tooltip: 'Trajet retour de ' + event.post + ' min'\n      }\n      if (percentage > 0) {\n        self.postEvent[event.id] = obj\n      } else {\n        event.post = 0\n      }\n    }\n\n    function safeParse (width = '0px') {\n      return parseInt(width.replace('px', ''))\n    }\n  }\n\n  function PlanningLineDirective () {\n    return {\n      restrict: 'E',\n      templateUrl: '/directives/planning-line/planning-line.html',\n      controller: PlanningLineController,\n      controllerAs: 'line',\n      bindToController: {\n        zoom: '=',\n        dayStart: '=',\n        dayEnd: '=',\n        events: '=',\n        clickCallback: '&',\n        dropCallback: '&',\n        pauses: '=?',\n        absences: '=?',\n        position: '=?',\n        mode: '=?',\n        entities:'=?',\n        dayOfWeek:'=',\n        holidays: '='\n      },\n      scope: true\n    }\n  }\n})(window.angular, window._, window.moment)\n",";(function (angular, moment, _) {\n  'use strict'\n\n  angular\n    .module('90Tech.planning')\n    .directive('zlPlanningTopRow', topRowDirective)\n\n  topRowDirective.$inject = ['planningConfiguration']\n\n  function topRowDirective (planningConfiguration) {\n    var BASE_SIZE = planningConfiguration.BASE_SIZE\n\n    return {\n      restrict: 'E',\n      templateUrl: '/directives/planning-top-row/planning-top-row.html',\n      controller: ['$scope', PlanningTopRowController],\n      controllerAs: 'planningTopRow',\n      bindToController: {\n        zoom: '=',\n        dayStart: '=',\n        dayEnd: '=',\n        events: '=',\n        entities: '=',\n        position: '=',\n        mode: '=',\n        callback: '&',\n        holidays: '='\n      },\n      scope: {}\n    }\n\n    function PlanningTopRowController ($scope) {\n      var self = this\n\n      self.$onInit = function () {\n        $scope.$watchGroup([function () { return self.dayStart }, function () { return self.dayEnd }], init)\n\n        _.extend(self, {\n          calcWidth: calcWidth,\n          calcMargin: calcMargin\n        })\n\n        init()\n      }\n\n      function init () {\n        var range = self.dayEnd.h - self.dayStart.h + 1\n        self.hours = []\n        _.times(range, function (i) {\n          var d = moment(self.position)\n          d.hour(i + parseInt(self.dayStart.h))\n          d.minute(0)\n          self.hours.push(d)\n        })\n      }\n\n\n\n      function calcWidth (zoom) {\n        return (parseInt(zoom) * BASE_SIZE) + 'px'\n      }\n\n      function calcMargin (zoom, index) {\n        var half = (parseInt(zoom) * (BASE_SIZE / 2))\n        if (!index) half = half - (3 * parseInt(zoom))\n        return '0 ' + half + 'px 0 -' + half + 'px'\n      }\n\n    }\n  }\n})(window.angular, window.moment, window._)\n",";(function (angular, _, moment) {\n  'use strict'\n\n  angular\n    .module('90Tech.planning')\n    .directive('zlPlanningVerticalLine', PlanningLineDirective)\n\n  PlanningLineController.$inject = ['$filter', '$scope', '$rootScope', 'planningConfiguration', 'PositionService', 'ColorService', 'PauseService', 'AbsenceService', 'HolidaysServicePlanning']\n\n  /**\n   *\n   */\n  function\n  PlanningLineController ($filter, $scope, $rootScope, planningConfiguration, PositionService, ColorService, PauseService, AbsenceService, HolidaysServicePlanning) {\n\n\n    /** BASE_SIZE is the span of an hour. It gets multiplied by zoom (default 10) to get the size in pixel\n     * in vertical mode, we need to reduce it since we have much less space\n     */\n    var BASE_SIZE = Math.max(planningConfiguration.BASE_SIZE - 8, 1)\n    var parallelText = planningConfiguration.parallelText\n    var MAX_PARALLEL = planningConfiguration.MAX_PARALLEL\n    var AVAILABLE_SPACE = 90 // Total horizontal space taken by the events\n\n    var self = this\n\n    self.$onInit = function () {\n      self.range = self.dayEnd.h - self.dayStart.h\n      self.SECONDS_BY_DAY = 3600 * self.range\n      self.SLIDER_WIDTH = BASE_SIZE * self.range\n      $scope.$watchCollection(function () {\n        return [self.events, self.dayStart, self.dayEnd]\n      }, init)\n\n      $scope.$watchCollection(function () {\n        return self.absences\n      }, function (oldValue, newValue) {\n        if (Array.isArray(self.absences) && self.absences.length) {\n          var start = moment(angular.copy(self.day)).startOf('day')\n          var end = moment(angular.copy(self.day)).endOf('day')\n          self._absences = AbsenceService.parseAbsences(angular.copy(self.absences), [start, end]).map(function (abs) {\n            let tempTop = (moment(abs.start).hours() - self.dayStart.h) * BASE_SIZE * self.zoom + moment(abs.start).minutes() * BASE_SIZE * self.zoom / 60\n            let tempHeight = self.zoom * self.SLIDER_WIDTH * (moment.range(abs.start, abs.end).valueOf()) / self.SECONDS_BY_DAY / 1000\n            if (abs.style.top === 0 + 'px') {\n              abs.style.height = (tempTop + tempHeight) + 'px'\n            } else {\n              abs.style.height = tempHeight + 'px'\n              abs.style.top = tempTop + 'px'\n            }\n\n            abs.range = moment.range(abs.start, abs.end)\n            abs.class = 'planning-absence-' + abs.confirmation.state\n            abs.tooltip = setAbsenceTooltip(abs)\n            return abs\n          })\n        } else {\n          self._absences = []\n        }\n      })\n\n\n      _.extend(self, {\n        clickEvent: clickEvent,\n        calcWidth: calcWidth,\n        dropEvent: dropEvent,\n        hoverAbsence: hoverAbsence,\n        leaveLine: leaveLine\n      })\n\n      init()\n    }\n\n    self.log = function (a) {\n    }\n\n    self.replace = function (string) {\n      if (!string) return\n      return string.replace(/([a-zA-Z\\ ])\\w+/, '')\n    }\n\n    self.preEvent = {}\n    self.postEvent = {}\n\n    function setAbsenceTooltip(abs) {\n      let state = ''\n      const absenceType = abs.absenceType\n      switch (abs.confirmation.state) {\n          case 'sending':\n              state = 'Absence envoye'\n              break\n          case 'pending':\n              state = 'Absence en cours de traitement'\n              break\n          case 'partial-accepted':\n              state = 'Absence en cours de traitement'\n              break;\n          case 'accepted':\n              state = 'Absence accepte'\n              break\n      }\n      if(absenceType) {\n          return state + '\\nRaison:'+ absenceType\n      } else {\n          return state\n      }\n    }\n\n    function extractMinutesFromEvent($event){\n      var minutes\n      if (_.contains($event.target.classList, 'half-hour')) {\n        // If the user has clicked right on the half-hour line, offsetX is 0\n        minutes = 30\n      } else {\n        minutes = Math.floor($event.offsetY / (BASE_SIZE * self.zoom) * 6)*10\n      }\n      return minutes\n    }\n\n    function dropEvent (data, event, line) {\n      var hour = parseInt(event.target.getAttribute('hour'))\n      var minutes = extractMinutesFromEvent(event)\n      var date = moment(angular.copy(self.day)).hours(hour + parseInt(self.dayStart.h)).minutes(minutes)\n      var day = line\n      if (checkAbsence(date) && checkFerie(day)) {\n        planningConfiguration.warningCallback(function () {\n          self.dropCallback({ $data: data, $event: event, $hour: hour, $minutes: minutes})\n        })\n      } else if (checkAbsence(date) && !checkFerie(day)) {\n        planningConfiguration.absentTechnicianCallback(function () {\n          self.dropCallback({ $data: data, $event: event, $hour: hour, $minutes: minutes})\n        })\n      } else if (!checkAbsence(date) && checkFerie(day)) {\n        if(!HolidaysServicePlanning.isSolidarityDay(day)){\n          planningConfiguration.isFerieCallback(function () {\n            self.dropCallback({ $data: data, $event: event, $hour: hour, $minutes: minutes})\n          })\n        } else {\n          self.dropCallback({ $data: data, $event: event, $hour: hour, $minutes: minutes})\n        }\n      } else {\n        self.dropCallback({ $data: data, $event: event, $hour: hour, $minutes: minutes})\n      }\n\n    }\n\n    function hoverAbsence() {\n      for (const iterator of document.getElementsByClassName('absence')) {\n        iterator.classList.add('absence-week-advanced-hover')\n      }\n    }\n\n    function leaveLine() {\n      for (const iterator of document.getElementsByClassName('absence')) {\n        iterator.classList.remove('absence-week-advanced-hover')\n      }\n    }\n\n    function clickEvent (hour, $event, line) {\n      var minutes = extractMinutesFromEvent($event)\n      var date = moment(angular.copy(self.day)).hours(hour + parseInt(self.dayStart.h)).minutes(minutes)\n      if (checkAbsence(date) && checkFerie(line)) {\n        planningConfiguration.warningCallback(function () {\n          self.clickCallback({$hour: hour + parseInt(self.dayStart.h), $minutes: minutes})\n        })\n      } else if (checkAbsence(date) && !checkFerie(line)) {\n        planningConfiguration.absentTechnicianCallback(function () {\n          self.clickCallback({$hour: hour + parseInt(self.dayStart.h), $minutes: minutes})\n        })\n      } else if (!checkAbsence(date) && checkFerie(line)) {\n        if(!HolidaysServicePlanning.isSolidarityDay(line)){\n          planningConfiguration.isFerieCallback(function () {\n            self.clickCallback({$hour: hour + parseInt(self.dayStart.h), $minutes: minutes})\n          })\n        } else {\n          self.clickCallback({$hour: hour + parseInt(self.dayStart.h), $minutes: minutes})\n        }\n      } else {\n        self.clickCallback({$hour: hour + parseInt(self.dayStart.h), $minutes: minutes})\n      }\n\n    }\n\n    function init () {\n      var currentId = 0\n      //     self.SLIDER_WIDTH   = 24 * BASE_SIZE\n      self.preEvent = {}\n      self.breaks = []\n\n      self._events = angular.copy(self.events)\n      self.range = self.dayEnd.h - self.dayStart.h\n      self.SECONDS_BY_DAY = 3600 * self.range\n      self.SLIDER_WIDTH = BASE_SIZE * self.range\n\n      // Pre-sort events by start Date\n      self._events = _.sortBy(self._events, function (e) {\n        return e.start.valueOf()\n      })\n\n      var lines = [[]]\n      var toremove = []\n      _.each(self._events, function (event) {\n        var style = {}\n        event.depth = 1\n        event.range = moment.range(event.start, event.end)\n        if (event.range < 900000) {\n          var end = moment(event.start).add(15, 'minutes')\n          event.range = moment.range(event.start, end)\n        }\n        style.left = (event.start.hours() - self.dayStart.h) * BASE_SIZE * self.zoom + event.start.minutes() * BASE_SIZE * self.zoom / 60 + 'px'\n        //   style.left                = event.start.hours() * 150 + event.start.minutes() * 150 / 60 + 'px'\n        style.width = self.zoom * self.SLIDER_WIDTH * (event.range) / self.SECONDS_BY_DAY / 1000 + 'px'\n        style['background-color'] = event['background-color'] || '#778899'\n        if (ColorService.getLuminance(style['background-color'])> 200){\n          style.color = 'black'\n        } else {\n          style.color = 'white'\n        }\n        event.style = style\n        PositionService.overlap(lines, event, MAX_PARALLEL, toremove)\n      })\n      self._events = _.difference(self._events, toremove)\n      _.each(self._events, function (event) {\n        event.id = angular.copy(currentId)\n        if (event.line === MAX_PARALLEL) {\n          event.style.left = (event.start.hours() - self.dayStart.h) * BASE_SIZE * self.zoom + event.start.minutes() * BASE_SIZE * self.zoom / 60 + 'px'\n          event.style.width = self.zoom * self.SLIDER_WIDTH * (event.range.valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px'\n          event.style['background-color'] = '#000'\n          event.style['font-weight'] = 'bold'\n          event.title = (event.eventList.length) + ' ' + parallelText\n          event.style.color = '#fff'\n          if (event.tooltip) event.tooltip = event.title\n        }\n        event.style.width = self.zoom * self.SLIDER_WIDTH * (event.range.valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px'\n        if (event.line === undefined) event.line = MAX_PARALLEL\n        event.style.top = Math.round((parseInt(event.line)) * AVAILABLE_SPACE / lines.length) + '%'\n        event.style.height = Math.round(AVAILABLE_SPACE / lines.length) + '%'\n        event.percentage = '100%'\n        if (event.continuedBefore) event.pre = 0\n        if (event.pre > 0) {\n          event.style['border-left'] = 'none'\n          var s = moment(event.start).subtract(event.pre, 'minutes')\n          if (!moment(s).isSame(event.start, 'day')) {\n            s = moment(event.start).startOf('day')\n          }\n          var e = moment(event.start)\n          var r = moment.range(s, e)\n          var totalRange = moment.range(s, event.range.end)\n          var percentage = r.valueOf() / totalRange.valueOf() * 100\n          event.percentage = (100 - percentage) + '%'\n          var obj = {\n            percentage: (percentage) + '%',\n            style: {\n              left: (((moment(s).hours() - self.dayStart.h) * BASE_SIZE * self.zoom + (moment(s).minutes()) * BASE_SIZE * self.zoom / 60)) +  'px',\n              width: self.zoom * self.SLIDER_WIDTH * (r.valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px',\n              top: event.style.top,\n              height: event.style.height,\n              totalWidth: self.zoom * self.SLIDER_WIDTH * (totalRange.valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px',\n              'text-align': 'center',\n              color: '#fff',\n              'background' : 'repeating-linear-gradient(45deg, ' +  event['background-color']  + ', ' +  event['background-color']  + ' 10px, white 10px, white 20px)',\n              'border-top': '1px lightgrey solid',\n              'border-bottom': '1px lightgrey solid',\n              'border-left': '1px lightgrey solid'\n            },\n            tooltip: 'Trajet estim de ' + event.pre + ' min'\n          }\n          if (percentage > 0) {\n            self.preEvent[event.id] = obj\n          } else {\n            event.pre = 0\n          }\n        }\n        generatePostEvent(event)\n        if (event.pauses) {\n          event.style['background-image'] = PauseService.generateGradient(event, 'to bottom')\n          event.style['background-color'] = undefined\n        }\n        const pre = self.preEvent[event.id]\n        const post = self.postEvent[event.id]\n        event.style.totalWidth = (safeParse(event.style.width) + safeParse(_.get(pre, 'style.width')) + safeParse(_.get(post, 'style.width')) + 1) + 'px'\n        currentId++\n      })\n      if (self.pauses) {\n        createBreaks()\n      }\n      calculateContainerHeight()\n\n      $scope.$on('$destroy', () => {\n        $rootScope.$broadcast('context-menu/close')\n      })\n    }\n\n    function safeParse (width = '0px') {\n      return parseInt(width.replace('px', ''))\n    }\n\n    function generatePostEvent (event) {\n      if (!event.post) {\n        return null\n      }\n      let end = moment(event.end).add(event.post, 'minutes')\n      if (!moment(end).isSame(event.end, 'day')) {\n        end = moment(event.end).endOf('day')\n      }\n      const start = moment(event.end)\n      const range = moment.range(start, end)\n      const totalRange = moment.range(event.range.start, event.range.end)\n      const percentage = range.valueOf() / totalRange.valueOf() * 100\n      event.postPercentage = (100 - percentage) + '%'\n      var obj = {\n        percentage: (percentage) + '%',\n        style: {\n          left: (((moment(start).hours() - self.dayStart.h) * BASE_SIZE * self.zoom + (moment(start).minutes()) * BASE_SIZE * self.zoom / 60) + 2) +  'px',\n          width: self.zoom * self.SLIDER_WIDTH * (range.valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px',\n          top: event.style.top,\n          height: event.style.height,\n          totalWidth: self.zoom * self.SLIDER_WIDTH * (totalRange.valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px',\n          'text-align': 'center',\n          color: '#fff',\n          'background' : 'repeating-linear-gradient(135deg, ' +  event['background-color']  + ', ' +  event['background-color']  + ' 10px, white 10px, white 20px)',\n          'border-top': '1px lightgrey solid',\n          'border-bottom': '1px lightgrey solid',\n          'border-left': '1px lightgrey solid'\n        },\n        tooltip: 'Trajet retour de ' + event.post + ' min'\n      }\n      if (percentage > 0) {\n        self.postEvent[event.id] = obj\n      } else {\n        event.post = 0\n      }\n    }\n\n    function calcWidth (zoom) {\n      return (parseInt(zoom) * BASE_SIZE) + 'px'\n    }\n\n    function createBreaks () {\n      self.breaks = _.compact(_.map(self.pauses.breaks, function (p) {\n        var pause = {\n          name: p.name,\n          start: moment().hours(p.start.split(':')[0]).minute(p.start.split(':')[1]).second(0),\n          end: moment().hours(p.end.split(':')[0]).minute(p.end.split(':')[1]).second(0),\n          style: {}\n        }\n\n        if (pause.start.isAfter(self.dayEnd) || pause.end.isBefore(self.dayStart)) {\n          return\n        }\n        if (pause.start.isBefore(self.dayStart)) {\n          pause.start = moment(angular.copy(self.dayStart))\n        }\n\n        if (pause.end.isAfter(self.dayEnd)) {\n          pause.end = moment(angular.copy(self.dayEnd))\n        }\n\n        pause.style.top = (((moment(pause.start).hours() - self.dayStart.h) * BASE_SIZE * self.zoom + (moment(pause.start).minutes()) * BASE_SIZE * self.zoom / 60)) +  'px'\n        pause.style.height = self.zoom * self.SLIDER_WIDTH * (moment.range(pause.start, pause.end).valueOf()) / self.SECONDS_BY_DAY / 1000 + 'px'\n\n        return pause\n      }))\n    }\n\n    function calculateContainerHeight () {\n      self.containerHeight = (parseInt(self.zoom) * BASE_SIZE) * $filter('range')(self.range) + 'px'\n    }\n\n    function checkAbsence (date) {\n      var d = moment(angular.copy(date))\n      return _.any(self._absences, function (abs) {\n        return abs.range.contains(d)\n      })\n    }\n\n    function checkFerie (date) {\n      return self.holidays.find(holiday => moment(holiday.date).format('L') === moment(date).format('L'));\n    }\n\n  }\n\n  function PlanningLineDirective () {\n    return {\n      restrict: 'E',\n      templateUrl: '/directives/planning-vertical-line/planning-vertical-line.html',\n      controller: PlanningLineController,\n      controllerAs: 'line',\n      bindToController: {\n        zoom: '=',\n        dayStart: '=',\n        dayEnd: '=',\n        events: '=',\n        isInRange: '=',\n        pauses: '=?',\n        day: '=',\n        absences: '=?',\n        holidays: '=?',\n        clickCallback: '&',\n        dropCallback: '&'\n      },\n      scope: true\n    }\n  }\n})(window.angular, window._, window.moment)\n",";(function (angular, moment, _) {\n  'use strict'\n\n  angular\n    .module('90Tech.planning')\n    .directive('zlPlanningWeekLine', PlanningLineDirective)\n\n  PlanningLineController.$inject = ['$scope', 'PositionService', 'planningConfiguration', 'ColorService']\n\n  /**\n   *\n   */\n  function PlanningLineController ($scope, PositionService, planningConfiguration, ColorService) {\n    var self = this\n\n    self.$onInit = function () {\n      _.extend(self, {\n        calculateWidth: calculateWidth,\n        calculateLeft: calculateLeft\n      })\n\n      init()\n\n      $scope.$watchCollection(function () {\n        return [self.events, self.week]\n      }, init)\n\n    }\n\n    var parallelText = planningConfiguration.parallelText\n    var MAX_PARALLEL = planningConfiguration.MAX_PARALLEL\n\n    function init () {\n      self.displayedEvents = _(self.events).sortBy(function (event) {\n        return event.continuedBefore ? -1 : (event.continuedAfter ? 0 : 1) // Order event list\n      }).value()\n\n      self.displayedEvents = positioning(self.displayedEvents)\n      self.oneDayEvents = positioning(self.oneDayEvents)\n    }\n\n\n\n    function positioning (eventList) {\n      var lines = [[]]\n      var toRemove = []\n      _.each(eventList, function (event) {\n        event.style = {}\n        event.depth = 1\n        event.range = moment.range(event.start, event.end)\n        PositionService.overlap(lines, event, MAX_PARALLEL, toRemove, true)\n      })\n      eventList = _.difference(eventList, toRemove)\n      _.each(eventList, function (event) {\n        setStyle(event, lines.length)\n      })\n      return eventList\n    }\n\n    function setStyle (event, height) {\n      event.style.left = calculateLeft(event)\n      event.style.width = calculateWidth(event)\n      event.style['background-color'] = event['background-color']\n      if (ColorService.getLuminance(event.style['background-color'])> 200){\n        event.style.color = 'black'\n      } else{\n        event.style.color = 'white'\n      }\n\n      event.style.top = Math.ceil((event.line) * 100 / height) + '%'\n      event.style.height = Math.round(100 / height) + '%'\n      if (event.line === undefined) event.line = MAX_PARALLEL\n      if (event.eventList && event.eventList.length > 1) {\n        event.style['background-color'] = '#000'\n        event.style['color'] = '#FFF'\n        event.style['font-weight'] = 'bold'\n        event.title = (event.eventList.length) + ' ' + parallelText\n        if (event.tooltip) event.tooltip = event.title\n      }\n    }\n\n\n    function calculateWidth (event) {\n      if (event.start.day() === event.end.day()) {\n        return (event.end.diff(event.start, 'days') + 1) * (100 / 7) + '%'\n      } else {\n        var diff = Math.ceil(event.end.diff(event.start, 'hours') / 24)\n        if (event.end.hours() < event.start.hours()) {\n          diff += 1\n        }\n        return (diff * (100 / 7)) + '%'\n      }\n    }\n\n    function calculateLeft (event) {\n      return ((event.start.isoWeekday() - 1)) * (99.9 / 7) + '%'\n    }\n\n\n  }\n\n  function PlanningLineDirective () {\n    return {\n      restrict: 'E',\n      replace: true,\n      templateUrl: '/directives/planning-week-line/planning-week-line.html',\n      controller: PlanningLineController,\n      controllerAs: 'line',\n      bindToController: {\n        events: '=',\n        week: '=',\n        oneDayEvents: '=',\n        weekEventCallback: '&'\n      },\n      scope: true\n    }\n  }\n})(window.angular, window.moment, window._)\n"]}